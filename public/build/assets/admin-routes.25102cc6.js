import{u as Ye,j as g,c as P,a as i,C as ou,T as u,O as Oi,m as S,b as dn,d as q,R as Z,r as v,e as Xe,f as Ho,S as rs,I as C,g as R,h as U,$ as mr,A as or,i as qo,k as Uo,K as Wo,l as Dn,n as oe,D as ue,o as ve,p as pe,q as ae,F as Ee,s as lu,B as E,t as W,v as Q,w as un,x as Ai,y as _r,z as Rr,P as jo,E as ss,G as te,H as G,J as ne,L as Oe,M as bt,N as Ii,Q as Di,U as ze,V as He,W as w,X as le,Y as Jo,Z as $t,_ as ei,a0 as Ve,a1 as pt,a2 as zi,a3 as Ko,a4 as Br,a5 as hn,a6 as cu,a7 as Go,a8 as Sa,a9 as Bn,aa as Qo,ab as Xt,ac as de,ad as Pi,ae as Ri,af as re,ag as fn,ah as _,ai as st,aj as du,ak as Yo,al as Xo,am as uu,an as gr,ao as Zo,ap as se,aq as el,ar as Ze,as as hu,at as fu,au as pu,av as Fi,aw as mu,ax as gu,ay as tl,az as br,aA as is,aB as pn,aC as Li,aD as bu,aE as qe,aF as Fe,aG as nl,aH as _i,aI as Bi,aJ as Vt,aK as ka,aL as as,aM as yr,aN as vr,aO as $i,aP as Zt,aQ as rl,aR as yu,aS as vu,aT as xu,aU as sl,aV as Su,aW as ku,aX as wu,aY as Cu,aZ as Nu,a_ as mn,a$ as Mu,b0 as Tu,b1 as Eu,b2 as Ou,b3 as Vi,b4 as Au,b5 as Iu,b6 as Du,b7 as zu,b8 as Pu,b9 as Ru,ba as Fu,bb as Lu,bc as _u,bd as Bu,be as $u,bf as il,bg as Vu,bh as he,bi as Hu}from"./main.2bd0a4cf.js";import{D as qu,a as Uu,b as Wu,c as ju,F as Se,d as Me,e as $n,u as Vn,A as al,K as Hi,f as ls,g as qi,I as Ju,N as Ku,h as Gu,C as Qu,S as Yu,B as Xu,i as Zu,T as eh,j as Qe,k as th,l as nh,m as ti,n as K,o as rh,p as sh,q as ni,r as cs,s as ih,t as ah,v as oh,w as Kt,x as ds,U as Ui,L as Wi,M as ol,y as lh,z as ch,E as dh,G as uh,H as hh,J as fh,O as ph,P as mh,Q as gh,R as bh}from"./UnfoldMore.ea196e44.js";import{E as Ct,B as yh,a as wa}from"./Edit.da0e054a.js";import{u as ll,a as vh}from"./use-resume-subscription.20c77bdf.js";function xh({className:n,isCompactMode:e}){const{version:t}=Ye();return g("div",{className:P(n,"text-sm pt-26 px-12 pb-16 text-muted font-medium bg-alt flex flex-col gap-20 border-r overflow-y-auto relative"),children:[i(ou,{matchDescendants:r=>r==="/admin",menu:"admin-sidebar",orientation:"vertical",onlyShowIcons:e,itemClassName:({isActive:r})=>P("block w-full rounded py-12 px-16 border-l-4",r?"bg-primary/hover border-l-primary":"border-l-transparent hover:bg-hover"),gap:"gap-8"}),!e&&i("div",{className:"mt-auto gap-14 px-16 text-xs",children:i(u,{message:"Version: :number",values:{number:t}})})]})}function Sh(){return g(qu,{name:"admin",leftSidenavCanBeCompact:!0,children:[i(Uu,{size:"sm",color:"primary",menuPosition:"admin-navbar"}),i(Wu,{position:"left",size:"sm",children:i(xh,{})}),i(ju,{children:i("div",{className:"bg dark:bg-alt",children:i(Oi,{})})})]})}const kh=[{key:"email_verified_at",label:S("Email"),description:S("Email verification status"),defaultOperator:Se.ne,control:{type:Me.Select,defaultValue:"01",options:[{key:"01",label:S("is confirmed"),value:{value:null,operator:Se.ne}},{key:"02",label:S("is not confirmed"),value:{value:null,operator:Se.eq}}]}},$n({description:S("Date user registered or was created")}),Vn({description:S("Date user was last updated")}),{key:"subscriptions",label:S("Subscription"),description:S("Whether user is subscribed or not"),defaultOperator:Se.eq,control:{type:Me.Select,defaultValue:"01",options:[{key:"01",label:S("is subscribed"),value:{value:"*",operator:Se.has}},{key:"02",label:S("is not subscribed"),value:{value:"*",operator:Se.doesntHave}}]}}];function Hn({image:n,label:e,description:t,labelClassName:r,avatarSize:s="md"}){return g("div",{className:"flex items-center gap-12",children:[n&&i(al,{size:s,className:"flex-shrink-0",src:n}),g("div",{className:"overflow-hidden min-w-0",children:[i("div",{className:P(r,"overflow-hidden overflow-ellipsis"),children:e}),t&&i("div",{className:"text-muted text-xs overflow-hidden overflow-ellipsis",children:t})]})]})}const ce=(n,e)=>{const t=n.split("/");return e&&t.push(e),t};function wh(n,e,t){return dn(ce(n,e),()=>Ch(n,e),{...t,keepPreviousData:!0})}function Ch(n,e){return q.get(n,{params:e}).then(t=>t.data)}const cl=Z.createContext(null);function ji(){return v.exports.useContext(cl)}function Nh(n){return"next_cursor"in n?n.next_cursor!=null:"last_page"in n?n.current_page<n.last_page:n.data.length>0&&n.data.length>=n.per_page}const Mh=15,Th=[{key:10},{key:15},{key:20},{key:50},{key:100}];function Eh({query:n,onPerPageChange:e,onPageChange:t,className:r}){var c;const s=Xe(),a=Ho(),o=(c=n.data)==null?void 0:c.pagination;if(!o)return null;const l=i(rs,{minWidth:"min-w-auto",selectionMode:"single",disabled:n.isLoading,labelPosition:"side",size:"xs",label:i(u,{message:"Items per page"}),selectedValue:o.per_page||Mh,onSelectionChange:d=>{e==null||e(d)},children:Th.map(d=>i(C,{value:d.key,children:d.key},d.key))});return g("div",{className:P("flex items-center justify-end gap-20 px-20 h-54 select-none",r),children:[!s&&l,o.from&&o.to&&"total"in o&&i("div",{className:"text-sm",children:i(u,{message:":from - :to of :total",values:{from:o.from,to:o.to,total:a.format(o.total)}})}),g("div",{className:"text-muted",children:[i(R,{disabled:n.isFetching||o.current_page<2,onClick:()=>{t==null||t((o==null?void 0:o.current_page)-1)},children:i(Hi,{})}),i(R,{disabled:n.isFetching||!Nh(o),onClick:()=>{t==null||t((o==null?void 0:o.current_page)+1)},children:i(ls,{})})]})]})}const Oh=U(i("path",{d:"M7 6h10l-5.01 6.3L7 6zm-2.75-.39C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAltOutlined"),Ht=Z.forwardRef(({variant:n="default",mode:e="single",children:t,className:r,isLazy:s,...a},o)=>{const[l,c]=mr(a.expandedValues,a.defaultExpandedValues||[],a.onExpandedChange);return i("div",{className:P(n==="outline"&&"space-y-10",r),ref:o,role:"presentation",children:i(or,{children:i(qo,{children:Z.Children.map(t,(d,h)=>v.exports.isValidElement(d)?v.exports.cloneElement(d,{key:d.key||h,value:d.props.value||h,mode:e,variant:n,expandedValues:l,setExpandedValues:c,isLazy:s}):null)})})})});function Ge({children:n,label:e,disabled:t,bodyClassName:r,labelClassName:s,buttonPadding:a="py-10 pl-14 pr-10",startIcon:o,description:l,endAppend:c,chevronPosition:d="right",...h}){const{expandedValues:f,setExpandedValues:p,variant:m,value:b,mode:y,isLazy:x}=h,k=v.exports.useRef(null),M=!t&&f.includes(b),T=v.exports.useRef(!1);M&&(T.current=!0);const B=Uo(),A=v.exports.useId(),H=`${A}-button`,j=`${A}-panel`,D=We=>{switch(We.key){case"ArrowDown":B.focusNext();break;case"ArrowUp":B.focusPrevious();break;case"Home":B.focusFirst();break;case"End":B.focusLast();break}},Y={open:{height:"auto",visibility:"visible",transitionEnd:{overflow:"auto"}},closed:{height:0,overflow:"hidden",transitionEnd:{visibility:"hidden"}}},me=()=>{const We=f.indexOf(b);if(We>-1){const it=[...f];it.splice(We,1),p(it)}else p(y==="single"?[b]:[...f,b])},Ce=i("div",{className:P(m==="minimal"&&""),children:i(Wo,{"aria-hidden":"true",size:"md",className:P(t?"text-disabled":"text-muted",M&&"rotate-180 transition-transform")})});return g("div",{className:P(m==="default"&&"border-b",m==="outline"&&"border rounded",t&&"text-disabled"),children:[g("h3",{className:P("flex items-center text-sm justify-between w-full",t&&"pointer-events-none",M&&m!=="minimal"?"border-b":"border-b border-b-transparent",m==="outline"?M?"rounded-t":"rounded":void 0),children:[g("button",{disabled:t,"aria-expanded":M,id:H,"aria-controls":j,type:"button",ref:k,onKeyDown:D,onClick:()=>{t||me()},className:P("flex items-center text-left gap-10 flex-auto outline-none hover:bg-hover focus-visible:bg-primary/focus",a),children:[d==="left"&&Ce,o&&v.exports.cloneElement(o,{size:"md",className:P(o.props.className,t?"text-disabled":"text-muted")}),g("div",{className:"flex-auto overflow-hidden overflow-ellipsis",children:[i("div",{className:s,"data-testid":"accordion-label",children:e}),l&&i("div",{className:"text-muted text-xs",children:l})]}),d==="right"&&Ce]}),c&&i("div",{className:"flex-shrink-0 text-sm text-muted px-4",children:c})]}),i(Dn.div,{"aria-labelledby":A,role:"region",variants:Y,transition:{type:"tween",duration:.2},initial:!1,animate:M?"open":"closed",children:i("div",{className:P("p-16",r),children:!x||T?n:null})})]})}function Ah({filter:n}){return null}function Ih({filters:n}){const{decodedFilters:e}=qi(n),{formId:t}=oe(),[r,s]=v.exports.useState(()=>e.map(l=>l.key));return g(ue,{className:"min-w-[300px]",maxWidth:"max-w-400",size:"auto",children:[i(ve,{padding:"px-14 py-10",leftAdornment:i(E,{size:"xs",variant:"outline",className:"mr-auto",onClick:()=>{s([])},children:i(u,{message:"Clear"})}),rightAdornment:i(E,{size:"xs",variant:"flat",color:"primary",className:"ml-auto",type:"submit",form:t,children:i(u,{message:"Apply"})}),children:i(u,{message:"Filter"})}),i(pe,{padding:"p-0",children:i(Dh,{filters:n,expandedFilters:r,setExpandedFilters:s})})]})}function Dh({filters:n,expandedFilters:e,setExpandedFilters:t}){const{decodedFilters:r,replaceAll:s}=qi(n),a={};n.forEach(d=>{const h=r.find(f=>f.key===d.key);a[d.key]=(h==null?void 0:h.value)!==void 0?h:{value:d.control.defaultValue,operator:d.defaultOperator}});const o=ae({defaultValues:a}),{formId:l,close:c}=oe();return i(Ee,{form:o,id:l,onSubmit:d=>{const h=Object.entries(d).filter(([f,p])=>e.includes(f)&&p!==void 0).map(([f,p])=>({key:f,...p}));s(h),c()},children:i(Ht,{mode:"multiple",expandedValues:e,onExpandedChange:t,children:n.map(d=>g(Ge,{startIcon:i(lu,{checked:e.includes(d.key)}),value:d.key,label:i(u,{...d.label}),bodyClassName:"max-h-288 overflow-y-auto compact-scrollbar",children:[d.description&&i("div",{className:P("text-muted text-xs",d.control.type!==Me.BooleanToggle&&"mb-14"),children:i(u,{...d.description})}),i(zh,{filter:d})]},d.key))})})}function zh({filter:n}){switch(n.control.type){case Me.Select:return i(Yu,{filter:n});case Me.ChipField:return i(Qu,{filter:n});case Me.DateRangePicker:return i(Gu,{filter:n});case Me.SelectModel:return i(Ku,{filter:n});case Me.Input:return i(Ju,{filter:n});case Me.BooleanToggle:return i(Ah,{filter:n});case"custom":const e=n.control.panel;return i(e,{filter:n});default:return null}}function Ph({filters:n,icon:e=i(Oh,{}),color:t="primary",variant:r="outline",size:s="sm",disabled:a}){const o=Xe();return g(W,{type:"popover",children:[o?i(R,{color:t,size:"sm",variant:r,disabled:a,radius:"rounded",children:e}):i(E,{variant:r,color:t,startIcon:e,disabled:a,size:s,children:i(u,{message:"Filter"})}),i(Ih,{filters:n})]})}function Rh({actions:n,filters:e,filtersLoading:t,searchPlaceholder:r=S("Type to search..."),searchValue:s="",onSearchChange:a}){const{trans:o}=Q();return g(dl,{children:[i(un,{inputTestId:"datatable-search",className:"flex-auto max-w-440 mr-auto",inputWrapperClassName:"mr-24 md:mr-0",placeholder:o(r),startAdornment:i(Ai,{}),value:s,onChange:l=>{a(l.target.value)}}),e&&i(Ph,{filters:e,disabled:t}),n]})}function dl({children:n,...e}){return i("div",{className:"mb-24 flex items-center gap-8 md:gap-12 text-muted relative h-42",...e,children:n})}function Fh({actions:n,selectedItemsCount:e}){return g(dl,{"data-testid":"datatable-selected-header",children:[i("div",{className:"mr-auto",children:i(u,{message:"[one 1 item|other :count items] selected",values:{count:e}})}),n]})}function Lh(){return g(Dn.div,{className:"flex items-center gap-6 h-30",..._r,children:[i(Rr,{variant:"rect",size:"h-full w-144",radius:"rounded-md"}),i(Rr,{variant:"rect",size:"h-full w-112",radius:"rounded-md"}),i(Rr,{variant:"rect",size:"h-full w-172",radius:"rounded-md"})]},"filter-list-skeleton")}function ul({filters:n,filtersLoading:e,columns:t,searchPlaceholder:r,queryParams:s,endpoint:a,actions:o,selectedActions:l,emptyStateMessage:c,tableDomProps:d,onRowAction:h,enableSelection:f=!0,selectionStyle:p="checkbox",children:m,cellHeight:b,collapseTableOnMobile:y=!0}){var me;const x=Xe(),{trans:k}=Q(),{encodedFilters:M}=qi(n),[T,B]=v.exports.useState({perPage:15}),[A,H]=v.exports.useState([]),j=wh(a,{...T,...s,[Xu]:M},{onSuccess:()=>{H([])}}),D=!!(T.query||T.filters||M),Y=(me=j.data)==null?void 0:me.pagination;return g(cl.Provider,{value:{selectedRows:A,setSelectedRows:H,endpoint:a,params:T,setParams:B,query:j},children:[m,i(or,{initial:!1,mode:"wait",children:A.length?i(Fh,{selectedItemsCount:A.length,actions:l},"selected"):i(Rh,{searchPlaceholder:r,searchValue:T.query,onSearchChange:Ce=>B({...T,query:Ce}),actions:o,filters:n,filtersLoading:e},"default")}),n&&i("div",{className:"mb-14",children:i(or,{initial:!1,mode:"wait",children:e&&M?i(Lh,{}):i(Dn.div,{..._r,children:i(Zu,{filters:n})},"filter-list")})}),g("div",{className:P("relative rounded",(!x||!y)&&"border"),children:[j.isFetching&&i(jo,{isIndeterminate:!0,className:"absolute top-0 left-0 w-full z-10","aria-label":k({message:"Loading"}),size:"xs"}),i("div",{className:"relative overflow-x-auto md:overflow-hidden",children:i(eh,{...d,columns:t,data:(Y==null?void 0:Y.data)||[],sortDescriptor:T,onSortChange:Ce=>{B({...T,...Ce})},selectedRows:A,enableSelection:f,selectionStyle:p,onSelectionChange:H,onAction:h,collapseOnMobile:y,cellHeight:b})}),(j.isFetched||j.isPreviousData)&&!(Y!=null&&Y.data.length)?i("div",{className:"pt-50",children:v.exports.cloneElement(c,{isFiltering:D})}):void 0,i(Eh,{query:j,onPageChange:Ce=>B({...T,page:Ce}),onPerPageChange:Ce=>B({...T,perPage:Ce})})]})]})}function qt({title:n,headerContent:e,headerItemsAlign:t="items-end",...r}){const s=v.exports.useId();return g("div",{className:"p-12 md:p-24",children:[n&&g("div",{className:P("mb-16",e&&`flex ${t} gap-4`),children:[i(ss,{children:n}),i("h1",{className:"text-3xl font-light capitalize",id:s,children:n}),e]}),i(ul,{...r,tableDomProps:{"aria-labelledby":n?s:void 0}})]})}function _h(){const{endpoint:n,selectedRows:e,setSelectedRows:t}=ji();return te(()=>Bh(n,e),{onSuccess:async()=>{await G.invalidateQueries(ce(n)),ne(S("Deleted [one 1 record|other :count records]",{values:{count:e.length}})),t([])},onError:r=>Oe(r,S("Could not delete records"))})}function Bh(n,e){return q.delete(`${n}/${e.join(",")}`).then(t=>t.data)}function gn(){return g(W,{type:"modal",children:[i(E,{variant:"flat",color:"danger",className:"ml-auto",children:i(u,{message:"Delete"})}),i($h,{})]})}function $h(){const n=_h(),{selectedRows:e}=ji(),{close:t}=oe();return i(bt,{isLoading:n.isLoading,title:i(u,{message:"Delete [one 1 item|other :count items]?",values:{count:e.length}}),body:i(u,{message:"This will permanently remove the items and cannot be undone."}),confirm:i(u,{message:"Delete"}),isDanger:!0,onConfirm:()=>{n.mutate(void 0,{onSuccess:()=>t()})}})}function mt({isFiltering:n,title:e,filteringTitle:t,image:r,className:s}){const a=Xe();return i(Ii,{className:s,size:a?"sm":"md",image:i(Di,{src:r}),title:n&&t?t:e,description:n&&t?i(u,{message:"Try another search query or different filters"}):void 0})}const lr=""+new URL("team.de984127.svg",import.meta.url).href,bn=Z.forwardRef(({children:n,to:e,elementType:t,onClick:r},s)=>Xe()?i(R,{ref:s,variant:"flat",color:"primary",radius:"rounded",className:"flex-shrink-0",size:"sm",to:e,elementType:t,onClick:r,children:i(Qe,{})}):i(E,{ref:s,startIcon:i(Qe,{}),variant:"flat",color:"primary",size:"sm",to:e,elementType:t,onClick:r,children:n}));function Vh(n){return te(e=>Hh(n,e),{onError:e=>Oe(e)})}function Hh(n,e){return q.post(n,e).then(t=>t.data)}function qh(){const{close:n}=oe();return g(ue,{children:[i(ve,{children:i(u,{message:"Csv export"})}),i(pe,{children:i(u,{message:"Your request is being processed. We'll email you when the report is ready to download. In certain cases, it might take a little longer, depending on the number of items beings exported and the volume of activity."})}),i(ze,{children:i(E,{variant:"flat",color:"primary",onClick:n,children:i(u,{message:"Got it"})})})]})}function hl({endpoint:n,payload:e}){const[t,r]=v.exports.useState(!1),s=Vh(n);return g(v.exports.Fragment,{children:[i(R,{variant:"outline",color:"primary",radius:"rounded",size:"sm",className:"flex-shrink-0",disabled:s.isLoading,onClick:()=>{s.mutate(e,{onSuccess:a=>{a.downloadPath?th(a.downloadPath):r(!0)}})},children:i(nh,{})}),i(W,{type:"modal",isOpen:t,onOpenChange:r,children:i(qh,{})})]})}function Uh(n,e){return te(t=>Wh(e,t),{onSuccess:()=>{ne(S("User suspended")),G.invalidateQueries(["users"])},onError:t=>He(t,n)})}function Wh(n,e){return q.post(`users/${n}/ban`,e).then(t=>t.data)}function jh({user:n}){const{trans:e}=Q(),{close:t,formId:r}=oe(),s=ae({defaultValues:{permanent:!0}}),a=s.watch("permanent"),o=Uh(s,n.id);return g(ue,{children:[i(ve,{children:i(u,{message:"Suspend \u201C:name\u201C",values:{name:n.display_name}})}),i(pe,{children:g(Ee,{id:r,form:s,onSubmit:l=>o.mutate(l,{onSuccess:()=>t()}),children:[i(ti,{name:"ban_until",label:i(u,{message:"Suspend until"}),disabled:a}),i(K,{name:"permanent",className:"mt-12",children:i(u,{message:"Permanent"})}),i(w,{className:"mt-24",name:"comment",inputElementType:"textarea",maxLength:250,label:i(u,{message:"Reason"}),placeholder:e(S("Optional"))})]})}),g(ze,{children:[i(E,{onClick:()=>t(),children:i(u,{message:"Cancel"})}),i(E,{form:r,variant:"flat",color:"primary",type:"submit",disabled:o.isLoading,children:i(u,{message:"Suspend"})})]})]})}const fl=U(i("path",{d:"m20 17.17-3.37-3.38c.64.22 1.23.48 1.77.76.97.51 1.58 1.52 1.6 2.62zm1.19 4.02-1.41 1.41-2.61-2.6H4v-2.78c0-1.12.61-2.15 1.61-2.66 1.29-.66 2.87-1.22 4.67-1.45L1.39 4.22 2.8 2.81l18.39 18.38zM15.17 18l-3-3H12c-2.37 0-4.29.73-5.48 1.34-.32.16-.52.5-.52.88V18h9.17zM12 6c1.1 0 2 .9 2 2 0 .86-.54 1.59-1.3 1.87l1.48 1.48C15.28 10.64 16 9.4 16 8c0-2.21-1.79-4-4-4-1.4 0-2.64.72-3.35 1.82l1.48 1.48C10.41 6.54 11.14 6 12 6z"}),"PersonOffOutlined");function Jh(n){return te(()=>Kh(n),{onSuccess:()=>{ne(S("User unsuspended")),G.invalidateQueries(["users"])},onError:e=>Oe(e)})}function Kh(n){return q.delete(`users/${n}/unban`).then(e=>e.data)}const Ca=[{key:"name",allowsSorting:!0,sortingKey:"email",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>i(u,{message:"User"}),body:n=>i(Hn,{image:n.avatar,label:n.display_name,description:n.email})},{key:"subscribed",header:()=>i(u,{message:"Subscribed"}),width:"w-96",body:n=>{var e;return(e=n.subscriptions)!=null&&e.length?i(Jo,{className:"icon-md text-positive"}):i($t,{className:"icon-md text-danger"})}},{key:"roles",header:()=>i(u,{message:"Roles"}),body:n=>i(rh,{radius:"rounded",size:"xs",children:n.roles.map(e=>i(ei,{selectable:!0,children:i(le,{className:P("capitalize"),target:"_blank",to:`/admin/roles/${e.id}/edit`,children:i(u,{message:e.name})})},e.id))})},{key:"firstName",allowsSorting:!0,header:()=>i(u,{message:"First name"}),body:n=>n.first_name},{key:"lastName",allowsSorting:!0,header:()=>i(u,{message:"Last name"}),body:n=>n.last_name},{key:"createdAt",allowsSorting:!0,width:"w-96",header:()=>i(u,{message:"Created at"}),body:n=>i("time",{children:i(Ve,{date:n.created_at})})},{key:"actions",header:()=>i(u,{message:"Actions"}),width:"w-84 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:n=>g("div",{className:"text-muted",children:[i(le,{to:`${n.id}/edit`,children:i(pt,{label:i(u,{message:"Edit user"}),children:i(R,{size:"md",children:i(Ct,{})})})}),n.banned_at?i(Yh,{user:n}):g(W,{type:"modal",children:[i(pt,{label:i(u,{message:"Suspend user"}),children:i(R,{size:"md",children:i(fl,{})})}),i(jh,{user:n})]})]})}];function Gh(){const{billing:n}=Ye(),e=n.enable?Ca:Ca.filter(t=>t.key!=="subscribed");return i(v.exports.Fragment,{children:i(qt,{endpoint:"users",title:i(u,{message:"Users"}),filters:kh,columns:e,actions:i(Qh,{}),queryParams:{with:"subscriptions,bans"},selectedActions:i(gn,{}),emptyStateMessage:i(mt,{image:lr,title:i(u,{message:"No users have been created yet"}),filteringTitle:i(u,{message:"No matching users"})})})})}function Qh(){return g(v.exports.Fragment,{children:[i(hl,{endpoint:"users/csv/export"}),i(bn,{elementType:le,to:"new",children:i(u,{message:"Add new user"})})]})}function Yh({user:n}){const e=Jh(n.id);return g(W,{type:"modal",onClose:t=>{t&&e.mutate()},children:[i(pt,{label:i(u,{message:"Remove suspension"}),children:i(R,{size:"md",color:"danger",children:i(fl,{})})}),i(bt,{isDanger:!0,title:i(u,{message:"Suspend \u201C:name\u201C",values:{name:n.display_name}}),body:i(u,{message:"Are you sure you want to remove suspension from this user?"}),confirm:i(u,{message:"Unsuspend"})})]})}const Xh=n=>(e,t,r)=>{const s=r.subscribe;return r.subscribe=(o,l,c)=>{let d=o;if(l){const h=(c==null?void 0:c.equalityFn)||Object.is;let f=o(r.getState());d=p=>{const m=o(p);if(!h(f,m)){const b=f;l(f=m,b)}},c!=null&&c.fireImmediately&&l(f,f)}return s(d)},n(e,t,r)},Zh=Xh;function ef(n,e){return n.reduce((t,r,s)=>{const a=Math.floor(s/e);return t[a]||(t[a]=[]),t[a].push(r),t},[])}const tf={preview:{defaultRoute:"/",navigationRoutes:[]},sections:{general:{label:S("General"),position:1,buildBreadcrumb:()=>[{label:S("General"),location:"general"}]},themes:{label:S("Themes"),position:2,buildBreadcrumb:(n,e)=>{var a;const t=n.split("/").filter(o=>!!o),[,,,r]=t,s=[{label:S("Themes"),location:"themes"}];return r!=null&&s.push({label:(a=e.appearance.themes.all[+r])==null?void 0:a.name,location:`themes/${r}`}),s}},menus:{label:S("Menus"),position:3,buildBreadcrumb:(n,e)=>{const t=n.split("/").filter(o=>!!o),[,,...r]=t,s=[{label:S("Menus"),location:"menus"}],a=ef(r,2);return a.forEach(([o,l],c)=>{var d,h;if(o==="menus"&&l!=null)s.push({label:(d=e.settings.menus[+l])==null?void 0:d.name,location:`menus/${l}`});else if(o==="items"&&l!=null){const[,f]=a[c-1];s.push({label:(h=e.settings.menus[+f].items[+l])==null?void 0:h.label,location:`menus/${f}/${l}`})}}),s},config:{availableRoutes:["/login","/register","/contact","/billing/pricing","/account-settings","/admin","/admin/appearance","/admin/settings","/admin/plans","/admin/subscriptions","/admin/users","/admin/roles","/admin/pages","/admin/tags","/admin/files","/admin/localizations","/admin/ads","/admin/settings/authentication","/admin/settings/branding","/admin/settings/cache","/admin/settings/providers","/api-routes"],positions:["admin-navbar","admin-sidebar","custom-page-navbar","auth-page-footer","auth-dropdown","account-settings-page","billing-page","checkout-page-navbar","checkout-page-footer","pricing-table-page","contact-us-page","notifications-page","footer","footer-secondary"]}},"custom-code":{label:S("Custom Code"),position:4,buildBreadcrumb:()=>[{label:S("Custom code"),location:"custom-code"}]},"seo-settings":{label:S("SEO Settings"),position:5,buildBreadcrumb:()=>[{label:S("SEO"),location:"seo"}]}}};function nf(n){const{size:e="md",inline:t,label:r,showValueLabel:s=!!r,className:a,width:o="w-full",slider:l,children:c,trackColor:d="primary",fillColor:h="primary"}=n,{domProps:f,trackRef:p,getThumbPercent:m,getThumbValueLabel:b,labelId:y,groupId:x,thumbIds:k,isDisabled:M,numberFormatter:T,minValue:B,maxValue:A,step:H,values:j,getValueLabel:D}=l;let Y="",me=Math.max([...T.format(B)].length,[...T.format(A)].length,[...T.format(H)].length);D?Y=D(j[0]):j.length===1?Y=b(0):j.length===2&&(Y=`${b(0)} \u2013 ${b(1)}`,me=3+2*Math.max(me,[...T.format(B)].length,[...T.format(A)].length));const Ce=zi({size:e,disabled:M,labelDisplay:"flex"}),We=P("touch-none",a,o,{"flex items-center":t});return g("div",{className:We,role:"group",id:x,children:[(r||s)&&g("div",{className:P(Ce.label,"select-none"),children:[r&&i("label",{onClick:()=>{var it;(it=document.getElementById(k[0]))==null||it.focus()},id:y,htmlFor:x,children:r}),s&&i("output",{htmlFor:k[0],className:"ml-auto text-right","aria-live":"off",style:me?{width:`${me}ch`,minWidth:`${me}ch`}:void 0,children:Y})]}),g("div",{ref:p,className:"h-30 relative",...f,role:"presentation",children:[i("div",{className:`absolute inset-0 m-auto h-4 rounded ${rf(d,M)}`}),i("div",{className:`absolute inset-0 my-auto h-4 rounded ${sf(h,M)}`,style:{width:`${m(0)*100}%`}}),c]})]})}function rf(n,e){switch(e&&(n="disabled"),n){case"disabled":return"bg-slider-disabled/60";case"primary":return"bg-primary-light";case"neutral":return"bg-divider";default:return n}}function sf(n,e){switch(e&&(n="disabled"),n){case"disabled":return"bg-slider-disabled";case"primary":return"bg-primary";default:return n}}function af({minValue:n=0,maxValue:e=100,isDisabled:t=!1,step:r=1,formatOptions:s,onChangeEnd:a,onPointerDown:o,label:l,getValueLabel:c,showThumbOnHoverOnly:d,thumbSize:h,onPointerMove:f,...p}){var xa;const[m,b]=v.exports.useState(!1),y=Ho(s),{addGlobalListener:x,removeGlobalListener:k}=Ko(),M=v.exports.useRef(null),[T,B]=mr(p.value?p.value:void 0,(xa=p.defaultValue)!=null?xa:[n],p.onChange),A=v.exports.useRef(null);A.current=T;const[H,j]=v.exports.useState(new Array(T.length).fill(!1)),D=v.exports.useRef(null);D.current=H;function Y(F){return y.format(F)}const me=F=>{var ie;return((ie=D.current)==null?void 0:ie[F])||!1},Ce=F=>Y(T[F]),We=F=>F===0?n:T[F-1],it=F=>F===T.length-1?e:T[F+1],Nt=(F,ie)=>{if(t||!Ns(F)||!A.current)return;const at=We(F),Mt=it(F);ie=cu(ie,at,Mt,r),A.current=Na(A.current,F,ie),B(A.current)},yt=(F,ie)=>{var Mt;if(t||!Ns(F))return;const at=(Mt=D.current)==null?void 0:Mt[F];D.current=Na(D.current||[],F,ie),j(D.current),a&&at&&!D.current.some(Boolean)&&a(A.current||[])},[Mr,jn]=v.exports.useState(void 0),Tr=F=>{const ie=Math.min(1,(F-n)/(e-n));return isNaN(ie)?0:ie},Er=F=>Tr(A.current[F]),Be=(F,ie)=>{Nt(F,ga(ie))},Xd=F=>Math.round((F-n)/r)*r+n,ga=F=>{const ie=F*(e-n)+n;return Br(Xd(ie),n,e)},ba=v.exports.useRef(new Array(T.length).fill(!0)),Ns=F=>ba.current[F],Zd=(F,ie)=>{ba.current[F]=ie},je=v.exports.useRef(null),ya=v.exports.useRef(void 0),eu=F=>{if(!(F.pointerType==="mouse"&&(F.button!==0||F.altKey||F.ctrlKey||F.metaKey))&&(o==null||o(),M.current&&!t&&T.every((ie,at)=>!H[at]))){const ie=M.current.offsetWidth,at=M.current.getBoundingClientRect().left,Ts=(F.clientX-at)/ie,Or=ga(Ts);let vt;const Jt=T.findIndex(Es=>Or-Es<0);if(Jt===0)vt=Jt;else if(Jt===-1)vt=T.length-1;else{const Es=T[Jt-1],au=T[Jt];Math.abs(Es-Or)<Math.abs(au-Or)?vt=Jt-1:vt=Jt}vt>=0&&Ns(vt)?(F.preventDefault(),je.current=vt,jn(vt),ya.current=F.pointerId,yt(je.current,!0),Nt(vt,Or),x(window,"pointerup",va,!1)):je.current=null}},Jn=v.exports.useRef(null),{domProps:tu}=sh({onPointerDown:eu,onMoveStart(){Jn.current=null},onMove(F,ie){var Mt;const at=((Mt=M.current)==null?void 0:Mt.offsetWidth)||0;if(Jn.current==null&&(Jn.current=Er(je.current||0)*at),Jn.current+=ie,je.current!=null&&M.current){const Ts=Br(Jn.current/at,0,1);Be(je.current,Ts)}},onMoveEnd(){je.current!=null&&(yt(je.current,!1),je.current=null)}}),nu=hn(tu,{onPointerEnter:()=>{b(!0)},onPointerLeave:()=>{b(!1)},onPointerMove:F=>{f==null||f(F)}}),va=F=>{F.pointerId===ya.current&&(je.current!=null&&(yt(je.current,!1),je.current=null),k(window,"pointerup",va,!1))},Ms=v.exports.useId(),ru=l?`${Ms}-label`:void 0,su=`${Ms}-group`,iu=[...Array(T.length)].map((F,ie)=>`${Ms}-thumb-${ie}`);return{domProps:nu,trackRef:M,isDisabled:t,step:r,values:T,minValue:n,maxValue:e,focusedThumb:Mr,labelId:ru,groupId:su,thumbIds:iu,numberFormatter:y,getThumbPercent:Er,getThumbMinValue:We,getThumbMaxValue:it,getThumbValueLabel:Ce,isThumbDragging:me,setThumbValue:Nt,updateDraggedThumbs:yt,setThumbEditable:Zd,setFocusedThumb:jn,getValueLabel:c,isPointerOver:m,showThumbOnHoverOnly:d,thumbSize:h}}function Na(n,e,t){return n[e]===t?n:[...n.slice(0,e),t,...n.slice(e+1)]}function of({index:n,slider:e,isDisabled:t,ariaLabel:r,inputRef:s,onBlur:a,fillColor:o="primary"}){const l=Go(s),{addGlobalListener:c,removeGlobalListener:d}=Ko(),{step:h,values:f,focusedThumb:p,labelId:m,thumbIds:b,isDisabled:y,getThumbPercent:x,getThumbMinValue:k,getThumbMaxValue:M,getThumbValueLabel:T,setThumbValue:B,updateDraggedThumbs:A,isThumbDragging:H,setThumbEditable:j,setFocusedThumb:D,isPointerOver:Y,showThumbOnHoverOnly:me,thumbSize:Ce="w-18 h-18"}=e,We=H(n),it=f[n];j(n,!t);const Nt=t||y,yt=v.exports.useCallback(()=>{l.current&&l.current.focus({preventScroll:!0})},[l]),Mr=p===n;v.exports.useEffect(()=>{Mr&&yt()},[Mr,yt]);const jn=v.exports.useRef(void 0),Tr=Be=>{Be.pointerId===jn.current&&(yt(),A(n,!1),d(window,"pointerup",Tr,!1))},Er=P("outline-none rounded-full top-1/2 -translate-y-1/2 -translate-x-1/2 absolute inset-0 transition-button duration-200",Ce,!Nt&&"shadow-md",lf({fillColor:o,isDisabled:Nt,isDragging:We}),me&&We||Y?"visible":"invisible");return i("div",{role:"presentation",className:Er,style:{left:`${Math.max(x(n)*100,0)}%`},onPointerDown:Be=>{Be.button!==0||Be.altKey||Be.ctrlKey||Be.metaKey||(yt(),jn.current=Be.pointerId,A(n,!0),c(window,"pointerup",Tr,!1))},children:i("input",{id:b[n],onKeyDown:Sa(()=>{A(n,!0)}),onKeyUp:Sa(()=>{A(n,!1)}),ref:l,tabIndex:Nt?void 0:0,min:k(n),max:M(n),step:h,value:it,disabled:Nt,"aria-label":r,"aria-labelledby":m,"aria-orientation":"horizontal","aria-valuetext":T(n),onFocus:()=>{D(n)},onBlur:Be=>{D(void 0),A(n,!1),a==null||a(Be)},onChange:Be=>{B(n,parseFloat(Be.target.value))},type:"range",className:"sr-only"})})}function lf({isDisabled:n,isDragging:e,fillColor:t}){return n?"bg-slider-disabled cursor-default":t&&t!=="primary"?t:P("hover:bg-primary-dark",e?"bg-primary-dark":"bg-primary")}function cf({inputRef:n,onBlur:e,...t}){const{onChange:r,onChangeEnd:s,value:a,defaultValue:o,...l}=t,c={...l,value:a!=null?[a]:void 0,defaultValue:o!=null?[o]:void 0,onChange:h=>{r==null||r(h[0])},onChangeEnd:h=>{s==null||s(h[0])}},d=af(c);return i(nf,{...c,slider:d,children:i(of,{fillColor:t.fillColor,index:0,slider:d,inputRef:n,onBlur:e})})}function df({name:n,...e}){const{field:{onChange:t,onBlur:r,value:s="",ref:a}}=Bn({name:n});return i(cf,{inputRef:a,...hn({onChange:t,onBlur:r,value:s||""},e)})}const ht=v.exports.forwardRef(({startIcon:n,children:e,className:t,...r},s)=>g(Qo,{ref:s,className:P("flex items-center gap-10 w-full rounded border text-sm h-54 px-14 mb-10 bg relative hover:bg-hover",t),variant:null,...r,children:[n,i("div",{children:e}),i(ls,{className:"icon-sm text-muted ml-auto"})]})),pl=U(i("path",{stroke:"#E0E0E0",d:"M24,44c-7.168,0-13-5.816-13-12.971C11,24,24,4,24,4s13,20,13,27.029C37,38.184,31.168,44,24,44z"}));function qn(){return(qn=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function us(n,e){if(n==null)return{};var t,r,s={},a=Object.keys(n);for(r=0;r<a.length;r++)e.indexOf(t=a[r])>=0||(s[t]=n[t]);return s}function cr(n){var e=v.exports.useRef(n),t=v.exports.useRef(function(r){e.current&&e.current(r)});return e.current=n,t.current}var dr=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n<e?e:n},er=function(n){return"touches"in n},ri=function(n){return n&&n.ownerDocument.defaultView||self},Ma=function(n,e,t){var r=n.getBoundingClientRect(),s=er(e)?function(a,o){for(var l=0;l<a.length;l++)if(a[l].identifier===o)return a[l];return a[0]}(e.touches,t):e;return{left:dr((s.pageX-(r.left+ri(n).pageXOffset))/r.width),top:dr((s.pageY-(r.top+ri(n).pageYOffset))/r.height)}},Ta=function(n){!er(n)&&n.preventDefault()},ml=Z.memo(function(n){var e=n.onMove,t=n.onKey,r=us(n,["onMove","onKey"]),s=v.exports.useRef(null),a=cr(e),o=cr(t),l=v.exports.useRef(null),c=v.exports.useRef(!1),d=v.exports.useMemo(function(){var m=function(x){Ta(x),(er(x)?x.touches.length>0:x.buttons>0)&&s.current?a(Ma(s.current,x,l.current)):y(!1)},b=function(){return y(!1)};function y(x){var k=c.current,M=ri(s.current),T=x?M.addEventListener:M.removeEventListener;T(k?"touchmove":"mousemove",m),T(k?"touchend":"mouseup",b)}return[function(x){var k=x.nativeEvent,M=s.current;if(M&&(Ta(k),!function(B,A){return A&&!er(B)}(k,c.current)&&M)){if(er(k)){c.current=!0;var T=k.changedTouches||[];T.length&&(l.current=T[0].identifier)}M.focus(),a(Ma(M,k,l.current)),y(!0)}},function(x){var k=x.which||x.keyCode;k<37||k>40||(x.preventDefault(),o({left:k===39?.05:k===37?-.05:0,top:k===40?.05:k===38?-.05:0}))},y]},[o,a]),h=d[0],f=d[1],p=d[2];return v.exports.useEffect(function(){return p},[p]),i("div",{...qn({},r,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:s,onKeyDown:f,tabIndex:0,role:"slider"})})}),Ji=function(n){return n.filter(Boolean).join(" ")},gl=function(n){var e=n.color,t=n.left,r=n.top,s=r===void 0?.5:r,a=Ji(["react-colorful__pointer",n.className]);return i("div",{className:a,style:{top:100*s+"%",left:100*t+"%"},children:i("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}})})},we=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t},uf=function(n){return gf(si(n))},si=function(n){return n[0]==="#"&&(n=n.substring(1)),n.length<6?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?we(parseInt(n[3]+n[3],16)/255,2):1}:{r:parseInt(n.substring(0,2),16),g:parseInt(n.substring(2,4),16),b:parseInt(n.substring(4,6),16),a:n.length===8?we(parseInt(n.substring(6,8),16)/255,2):1}},hf=function(n){return mf(pf(n))},ff=function(n){var e=n.s,t=n.v,r=n.a,s=(200-e)*t/100;return{h:we(n.h),s:we(s>0&&s<200?e*t/100/(s<=100?s:200-s)*100:0),l:we(s/2),a:we(r,2)}},ii=function(n){var e=ff(n);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},pf=function(n){var e=n.h,t=n.s,r=n.v,s=n.a;e=e/360*6,t/=100,r/=100;var a=Math.floor(e),o=r*(1-t),l=r*(1-(e-a)*t),c=r*(1-(1-e+a)*t),d=a%6;return{r:we(255*[r,l,o,o,c,r][d]),g:we(255*[c,r,r,l,o,o][d]),b:we(255*[o,o,c,r,r,l][d]),a:we(s,2)}},Ar=function(n){var e=n.toString(16);return e.length<2?"0"+e:e},mf=function(n){var e=n.r,t=n.g,r=n.b,s=n.a,a=s<1?Ar(we(255*s)):"";return"#"+Ar(e)+Ar(t)+Ar(r)+a},gf=function(n){var e=n.r,t=n.g,r=n.b,s=n.a,a=Math.max(e,t,r),o=a-Math.min(e,t,r),l=o?a===e?(t-r)/o:a===t?2+(r-e)/o:4+(e-t)/o:0;return{h:we(60*(l<0?l+6:l)),s:we(a?o/a*100:0),v:we(a/255*100),a:s}},bf=Z.memo(function(n){var e=n.hue,t=n.onChange,r=Ji(["react-colorful__hue",n.className]);return Z.createElement("div",{className:r},Z.createElement(ml,{onMove:function(s){t({h:360*s.left})},onKey:function(s){t({h:dr(e+360*s.left,0,360)})},"aria-label":"Hue","aria-valuenow":we(e),"aria-valuemax":"360","aria-valuemin":"0"},Z.createElement(gl,{className:"react-colorful__hue-pointer",left:e/360,color:ii({h:e,s:100,v:100,a:1})})))}),yf=Z.memo(function(n){var e=n.hsva,t=n.onChange,r={backgroundColor:ii({h:e.h,s:100,v:100,a:1})};return Z.createElement("div",{className:"react-colorful__saturation",style:r},Z.createElement(ml,{onMove:function(s){t({s:100*s.left,v:100-100*s.top})},onKey:function(s){t({s:dr(e.s+100*s.left,0,100),v:dr(e.v-100*s.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+we(e.s)+"%, Brightness "+we(e.v)+"%"},Z.createElement(gl,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:ii(e)})))}),bl=function(n,e){if(n===e)return!0;for(var t in n)if(n[t]!==e[t])return!1;return!0},vf=function(n,e){return n.toLowerCase()===e.toLowerCase()||bl(si(n),si(e))};function xf(n,e,t){var r=cr(t),s=v.exports.useState(function(){return n.toHsva(e)}),a=s[0],o=s[1],l=v.exports.useRef({color:e,hsva:a});v.exports.useEffect(function(){if(!n.equal(e,l.current.color)){var d=n.toHsva(e);l.current={hsva:d,color:e},o(d)}},[e,n]),v.exports.useEffect(function(){var d;bl(a,l.current.hsva)||n.equal(d=n.fromHsva(a),l.current.color)||(l.current={hsva:a,color:d},r(d))},[a,n,r]);var c=v.exports.useCallback(function(d){o(function(h){return Object.assign({},h,d)})},[]);return[a,c]}var Sf=typeof window<"u"?v.exports.useLayoutEffect:v.exports.useEffect,kf=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Ea=new Map,wf=function(n){Sf(function(){var e=n.current?n.current.ownerDocument:document;if(e!==void 0&&!Ea.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Ea.set(e,t);var r=kf();r&&t.setAttribute("nonce",r),e.head.appendChild(t)}},[])},Cf=function(n){var e=n.className,t=n.colorModel,r=n.color,s=r===void 0?t.defaultColor:r,a=n.onChange,o=us(n,["className","colorModel","color","onChange"]),l=v.exports.useRef(null);wf(l);var c=xf(t,s,a),d=c[0],h=c[1],f=Ji(["react-colorful",e]);return g("div",{...qn({},o,{ref:l,className:f}),children:[i(yf,{hsva:d,onChange:h}),i(bf,{hue:d.h,onChange:h,className:"react-colorful__last-control"})]})},Nf={defaultColor:"000",toHsva:uf,fromHsva:function(n){return hf({h:n.h,s:n.s,v:n.v,a:1})},equal:vf},Mf=function(n){return i(Cf,{...qn({},n,{colorModel:Nf})})},Tf=/^#?([0-9A-F]{3,8})$/i,Ef=function(n){var e=n.color,t=e===void 0?"":e,r=n.onChange,s=n.onBlur,a=n.escape,o=n.validate,l=n.format,c=n.process,d=us(n,["color","onChange","onBlur","escape","validate","format","process"]),h=v.exports.useState(function(){return a(t)}),f=h[0],p=h[1],m=cr(r),b=cr(s),y=v.exports.useCallback(function(k){var M=a(k.target.value);p(M),o(M)&&m(c?c(M):M)},[a,c,o,m]),x=v.exports.useCallback(function(k){o(k.target.value)||p(a(t)),b(k)},[t,a,o,b]);return v.exports.useEffect(function(){p(a(t))},[t,a]),i("input",{...qn({},d,{value:l?l(f):f,spellCheck:"false",onChange:y,onBlur:x})})},Oa=function(n){return"#"+n},Of=function(n){var e=n.prefixed,t=n.alpha,r=us(n,["prefixed","alpha"]),s=v.exports.useCallback(function(o){return o.replace(/([^0-9A-F]+)/gi,"").substring(0,t?8:6)},[t]),a=v.exports.useCallback(function(o){return function(l,c){var d=Tf.exec(l),h=d?d[1].length:0;return h===3||h===6||!!c&&h===4||!!c&&h===8}(o,t)},[t]);return Z.createElement(Ef,qn({},r,{escape:s,format:e?Oa:void 0,process:Oa,validate:a}))};class Af{getStringForLocale(e,t){let r=this.strings[t];r||(r=If(t,this.strings,this.defaultLocale),this.strings[t]=r);let s=r[e];if(!s)throw new Error(`Could not find intl message ${e} in ${t} locale`);return s}constructor(e,t="en-US"){this.strings={...e},this.defaultLocale=t}}function If(n,e,t="en-US"){if(e[n])return e[n];let r=Df(n);if(e[r])return e[r];for(let s in e)if(s.startsWith(r+"-"))return e[s];return e[t]}function Df(n){return Intl.Locale?new Intl.Locale(n).language:n.split("-")[0]}function zf(n){return n&&n.__esModule?n.default:n}var yl={},vl={};vl={alpha:"\u0623\u0644\u0641\u0627",blue:"\u0623\u0632\u0631\u0642",brightness:"\u0627\u0644\u0633\u0637\u0648\u0639",green:"\u0623\u062E\u0636\u0631",hue:"\u062F\u0631\u062C\u0629 \u0627\u0644\u0644\u0648\u0646",lightness:"\u0627\u0644\u0625\u0636\u0627\u0621\u0629",red:"\u0623\u062D\u0645\u0631",saturation:"\u0627\u0644\u062A\u0634\u0628\u0639"};var xl={};xl={alpha:"\u0410\u043B\u0444\u0430",blue:"\u0421\u0438\u043D\u044C\u043E",brightness:"\u042F\u0440\u043A\u043E\u0441\u0442",green:"\u0417\u0435\u043B\u0435\u043D\u043E",hue:"\u041E\u0442\u0442\u0435\u043D\u044A\u043A",lightness:"\u041B\u0435\u043A\u043E\u0442\u0430",red:"\u0427\u0435\u0440\u0432\u0435\u043D\u043E",saturation:"\u041D\u0430\u0441\u0438\u0442\u0435\u043D\u043E\u0441\u0442"};var Sl={};Sl={alpha:"Alfa",blue:"Modr\xE1",brightness:"Jas",green:"Zelen\xE1",hue:"Odst\xEDn",lightness:"Sv\u011Btlost",red:"\u010Cerven\xE1",saturation:"Sytost"};var kl={};kl={alpha:"Alfa",blue:"Bl\xE5",brightness:"Lysstyrke",green:"Gr\xF8n",hue:"Tone",lightness:"Lyshed",red:"R\xF8d",saturation:"Farvem\xE6tning"};var wl={};wl={alpha:"Alpha",blue:"Blau",brightness:"Helligkeit",green:"Gr\xFCn",hue:"Farbton",lightness:"Leuchtkraft",red:"Rot",saturation:"S\xE4ttigung"};var Cl={};Cl={alpha:"\u0386\u03BB\u03C6\u03B1",blue:"\u039C\u03C0\u03BB\u03B5",brightness:"\u03A6\u03C9\u03C4\u03B5\u03B9\u03BD\u03CC\u03C4\u03B7\u03C4\u03B1",green:"\u03A0\u03C1\u03AC\u03C3\u03B9\u03BD\u03BF",hue:"\u03A4\u03CC\u03BD\u03BF\u03C2",lightness:"\u03A6\u03C9\u03C4\u03B5\u03B9\u03BD\u03CC\u03C4\u03B7\u03C4\u03B1",red:"\u039A\u03CC\u03BA\u03BA\u03B9\u03BD\u03BF",saturation:"\u039A\u03BF\u03C1\u03B5\u03C3\u03BC\u03CC\u03C2"};var Nl={};Nl={hue:"Hue",saturation:"Saturation",lightness:"Lightness",brightness:"Brightness",red:"Red",green:"Green",blue:"Blue",alpha:"Alpha"};var Ml={};Ml={alpha:"Alpha",blue:"Azul",brightness:"Brillo",green:"Verde",hue:"Tono",lightness:"Luminosidad",red:"Rojo",saturation:"Saturaci\xF3n"};var Tl={};Tl={alpha:"Alfa",blue:"Sinine",brightness:"Heledus",green:"Roheline",hue:"V\xE4rv",lightness:"Valgus",red:"Punane",saturation:"K\xFCllastus"};var El={};El={alpha:"Alpha",blue:"Sininen",brightness:"Kirkkaus",green:"Vihre\xE4",hue:"S\xE4vy",lightness:"Valom\xE4\xE4r\xE4",red:"Punainen",saturation:"V\xE4rikyll\xE4isyys"};var Ol={};Ol={alpha:"Alpha",blue:"Bleu",brightness:"Luminosit\xE9",green:"Vert",hue:"Teinte",lightness:"Luminosit\xE9",red:"Rouge",saturation:"Saturation"};var Al={};Al={alpha:"\u05D0\u05DC\u05E4\u05D0",blue:"\u05DB\u05D7\u05D5\u05DC",brightness:"\u05D1\u05D4\u05D9\u05E8\u05D5\u05EA",green:"\u05D9\u05E8\u05D5\u05E7",hue:"\u05D2\u05D5\u05D5\u05DF",lightness:"\u05DB\u05DE\u05D5\u05EA \u05D0\u05D5\u05E8",red:"\u05D0\u05D3\u05D5\u05DD",saturation:"\u05E8\u05D5\u05D5\u05D9\u05D4"};var Il={};Il={alpha:"Alfa",blue:"Plava",brightness:"Svjetlina",green:"Zelena",hue:"Nijansa",lightness:"Osvijetljenost",red:"Crvena",saturation:"Zasi\u0107enost"};var Dl={};Dl={alpha:"Alfa",blue:"K\xE9k",brightness:"F\xE9nyess\xE9g",green:"Z\xF6ld",hue:"Sz\xEDn\xE1rnyalat",lightness:"Vil\xE1goss\xE1g",red:"Piros",saturation:"Tel\xEDtetts\xE9g"};var zl={};zl={alpha:"Alfa",blue:"Blu",brightness:"Luminosit\xE0",green:"Verde",hue:"Tonalit\xE0",lightness:"Luminosit\xE0",red:"Rosso",saturation:"Saturazione"};var Pl={};Pl={alpha:"\u30A2\u30EB\u30D5\u30A1",blue:"\u9752",brightness:"\u660E\u308B\u3055",green:"\u7DD1",hue:"\u8272\u76F8",lightness:"\u660E\u5EA6",red:"\u8D64",saturation:"\u5F69\u5EA6"};var Rl={};Rl={alpha:"\uC54C\uD30C",blue:"\uD30C\uB791",brightness:"\uBA85\uB3C4",green:"\uCD08\uB85D",hue:"\uC0C9\uC870",lightness:"\uBC1D\uAE30",red:"\uBE68\uAC15",saturation:"\uCC44\uB3C4"};var Fl={};Fl={alpha:"Alfa",blue:"M\u0117lyna",brightness:"Ry\u0161kumas",green:"\u017Dalia",hue:"Atspalvis",lightness:"\u0160viesumas",red:"Raudona",saturation:"\u012Esotinimas"};var Ll={};Ll={alpha:"Alfa",blue:"Zila",brightness:"Spilgtums",green:"Za\u013Ca",hue:"Nokr\u0101sa",lightness:"Gai\u0161ums",red:"Sarkana",saturation:"Pies\u0101tin\u0101jums"};var _l={};_l={alpha:"Alfa",blue:"Bl\xE5",brightness:"Lysstyrke",green:"Gr\xF8nn",hue:"Fargetone",lightness:"Lyshet",red:"R\xF8d",saturation:"Metning"};var Bl={};Bl={alpha:"Alfa",blue:"Blauw",brightness:"Helderheid",green:"Groen",hue:"Kleurtoon",lightness:"Lichtsterkte",red:"Rood",saturation:"Verzadiging"};var $l={};$l={alpha:"Alfa",blue:"Niebieski",brightness:"Jasno\u015B\u0107",green:"Zielony",hue:"Odcie\u0144",lightness:"Jaskrawo\u015B\u0107",red:"Czerwony",saturation:"Nasycenie"};var Vl={};Vl={alpha:"Alfa",blue:"Azul",brightness:"Brilho",green:"Verde",hue:"Matiz",lightness:"Luminosidade",red:"Vermelho",saturation:"Satura\xE7\xE3o"};var Hl={};Hl={alpha:"Alfa",blue:"Azul",brightness:"Luminosidade",green:"Verde",hue:"Tonalidade",lightness:"Claridade",red:"Vermelho",saturation:"Satura\xE7\xE3o"};var ql={};ql={alpha:"Alfa",blue:"Albastru",brightness:"Luminozitate",green:"Verde",hue:"Nuan\u021B\u0103",lightness:"Luminozitate",red:"Ro\u0219u",saturation:"Satura\u021Bie"};var Ul={};Ul={alpha:"\u0410\u043B\u044C\u0444\u0430",blue:"\u0421\u0438\u043D\u0438\u0439",brightness:"\u042F\u0440\u043A\u043E\u0441\u0442\u044C",green:"\u0417\u0435\u043B\u0435\u043D\u044B\u0439",hue:"\u041E\u0442\u0442\u0435\u043D\u043E\u043A",lightness:"\u041E\u0441\u0432\u0435\u0449\u0435\u043D\u043D\u043E\u0441\u0442\u044C",red:"\u041A\u0440\u0430\u0441\u043D\u044B\u0439",saturation:"\u041D\u0430\u0441\u044B\u0449\u0435\u043D\u043D\u043E\u0441\u0442\u044C"};var Wl={};Wl={alpha:"Alfa",blue:"Modr\xE1",brightness:"Jas",green:"Zelen\xE1",hue:"Odtie\u0148",lightness:"Svetlos\u0165",red:"\u010Cerven\xE1",saturation:"S\xFDtos\u0165"};var jl={};jl={alpha:"Alfa",blue:"Modra",brightness:"Svetlost",green:"Zelena",hue:"Barva",lightness:"Lahkost",red:"Rde\u010Da",saturation:"Nasi\u010Denost"};var Jl={};Jl={alpha:"Alfa",blue:"Plava",brightness:"Osvetljenost",green:"Zelena",hue:"Nijansa",lightness:"Osvetljenje",red:"Crvena",saturation:"Zasi\u0107enje"};var Kl={};Kl={alpha:"Alfa",blue:"Bl\xE5tt",brightness:"Ljusstyrka",green:"Gr\xF6nt",hue:"Nyans",lightness:"Ljushet",red:"R\xF6tt",saturation:"M\xE4ttnad"};var Gl={};Gl={alpha:"Alfa",blue:"Mavi",brightness:"Parlakl\u0131k",green:"Ye\u015Fil",hue:"Ton",lightness:"Canl\u0131l\u0131k",red:"K\u0131rm\u0131z\u0131",saturation:"Doygunluk"};var Ql={};Ql={alpha:"\u0410\u043B\u044C\u0444\u0430",blue:"\u0421\u0438\u043D\u0456\u0439",brightness:"\u042F\u0441\u043A\u0440\u0430\u0432\u0456\u0441\u0442\u044C",green:"\u0417\u0435\u043B\u0435\u043D\u0438\u0439",hue:"\u0422\u043E\u043D",lightness:"\u041E\u0441\u0432\u0456\u0442\u043B\u0435\u043D\u0456\u0441\u0442\u044C",red:"\u0427\u0435\u0440\u0432\u043E\u043D\u0438\u0439",saturation:"\u041D\u0430\u0441\u0438\u0447\u0435\u043D\u0456\u0441\u0442\u044C"};var Yl={};Yl={alpha:"Alpha",blue:"\u84DD\u8272",brightness:"\u4EAE\u5EA6",green:"\u7EFF\u8272",hue:"\u8272\u76F8",lightness:"\u660E\u4EAE\u5EA6",red:"\u7EA2\u8272",saturation:"\u9971\u548C\u5EA6"};var Xl={};Xl={alpha:"Alpha",blue:"\u85CD\u8272",brightness:"\u4EAE\u5EA6",green:"\u7DA0\u8272",hue:"\u8272\u76F8",lightness:"\u660E\u4EAE",red:"\u7D05\u8272",saturation:"\u98FD\u548C\u5EA6"};yl={"ar-AE":vl,"bg-BG":xl,"cs-CZ":Sl,"da-DK":kl,"de-DE":wl,"el-GR":Cl,"en-US":Nl,"es-ES":Ml,"et-EE":Tl,"fi-FI":El,"fr-FR":Ol,"he-IL":Al,"hr-HR":Il,"hu-HU":Dl,"it-IT":zl,"ja-JP":Pl,"ko-KR":Rl,"lt-LT":Fl,"lv-LV":Ll,"nb-NO":_l,"nl-NL":Bl,"pl-PL":$l,"pt-BR":Vl,"pt-PT":Hl,"ro-RO":ql,"ru-RU":Ul,"sk-SK":Wl,"sl-SI":jl,"sr-SP":Jl,"sv-SE":Kl,"tr-TR":Gl,"uk-UA":Ql,"zh-CN":Yl,"zh-TW":Xl};const Pf=new Af(zf(yl));function yn(n){let e=zt.parse(n)||Pt.parse(n)||Rt.parse(n);if(e)return e;throw new Error("Invalid color value: "+n)}class Ki{toHexInt(){return this.toFormat("rgb").toHexInt()}getChannelValue(e){if(e in this)return this[e];throw new Error("Unsupported color channel: "+e)}withChannelValue(e,t){if(e in this){let r=this.clone();return r[e]=t,r}throw new Error("Unsupported color channel: "+e)}getChannelName(e,t){return Pf.getStringForLocale(e,t)}getColorSpaceAxes(e){let{xChannel:t,yChannel:r}=e,s=t||this.getColorChannels().find(l=>l!==r),a=r||this.getColorChannels().find(l=>l!==s),o=this.getColorChannels().find(l=>l!==s&&l!==a);return{xChannel:s,yChannel:a,zChannel:o}}}class zt extends Ki{static parse(e){let t=[];if(/^#[\da-f]+$/i.test(e)&&[4,5,7,9].includes(e.length)){const a=(e.length<6?e.replace(/[^#]/gi,"$&$&"):e).slice(1).split("");for(;a.length>0;)t.push(parseInt(a.splice(0,2).join(""),16));t[3]=t[3]!==void 0?t[3]/255:void 0}const r=e.match(/^rgba?\((.*)\)$/);r!=null&&r[1]&&(t=r[1].split(",").map(a=>Number(a.trim())),t=t.map((a,o)=>Xt(a,0,o<3?255:1)));var s;return t.length<3?void 0:new zt(t[0],t[1],t[2],(s=t[3])!==null&&s!==void 0?s:1)}toString(e){switch(e){case"hex":return"#"+(this.red.toString(16).padStart(2,"0")+this.green.toString(16).padStart(2,"0")+this.blue.toString(16).padStart(2,"0")).toUpperCase();case"hexa":return"#"+(this.red.toString(16).padStart(2,"0")+this.green.toString(16).padStart(2,"0")+this.blue.toString(16).padStart(2,"0")+Math.round(this.alpha*255).toString(16).padStart(2,"0")).toUpperCase();case"rgb":return`rgb(${this.red}, ${this.green}, ${this.blue})`;case"css":case"rgba":return`rgba(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`;default:return this.toFormat(e).toString(e)}}toFormat(e){switch(e){case"hex":case"hexa":case"rgb":case"rgba":return this;case"hsb":case"hsba":return this.toHSB();case"hsl":case"hsla":return this.toHSL();default:throw new Error("Unsupported color conversion: rgb -> "+e)}}toHexInt(){return this.red<<16|this.green<<8|this.blue}toHSB(){const e=this.red/255,t=this.green/255,r=this.blue/255,s=Math.min(e,t,r),a=Math.max(e,t,r),o=a-s,l=a===0?0:o/a;let c=0;if(o!==0){switch(a){case e:c=(t-r)/o+(t<r?6:0);break;case t:c=(r-e)/o+2;break;case r:c=(e-t)/o+4;break}c/=6}return new Pt(de(c*360,2),de(l*100,2),de(a*100,2),this.alpha)}toHSL(){const e=this.red/255,t=this.green/255,r=this.blue/255,s=Math.min(e,t,r),a=Math.max(e,t,r),o=(a+s)/2,l=a-s;let c,d;if(l===0)c=d=0;else{switch(d=l/(o<.5?a+s:2-a-s),a){case e:c=(t-r)/l+(t<r?6:0);break;case t:c=(r-e)/l+2;break;case r:c=(e-t)/l+4;break}c/=6}return new Rt(de(c*360,2),de(d*100,2),de(o*100,2),this.alpha)}clone(){return new zt(this.red,this.green,this.blue,this.alpha)}getChannelRange(e){switch(e){case"red":case"green":case"blue":return{minValue:0,maxValue:255,step:1,pageSize:17};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+e)}}formatChannelValue(e,t){let r,s=this.getChannelValue(e);switch(e){case"red":case"green":case"blue":r={style:"decimal"};break;case"alpha":r={style:"percent"};break;default:throw new Error("Unknown color channel: "+e)}return new Pi(t,r).format(s)}getColorSpace(){return"rgb"}getColorChannels(){return zt.colorChannels}constructor(e,t,r,s){super(),this.red=e,this.green=t,this.blue=r,this.alpha=s}}Ri(zt,"colorChannels",["red","green","blue"]);const Rf=/hsb\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%)\)|hsba\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d(.\d+)?)\)/;class Pt extends Ki{static parse(e){let t;if(t=e.match(Rf)){var r;const[s,a,o,l]=((r=t[1])!==null&&r!==void 0?r:t[2]).split(",").map(c=>Number(c.trim().replace("%","")));return new Pt(Zl(s,360),Xt(a,0,100),Xt(o,0,100),Xt(l!=null?l:1,0,1))}}toString(e){switch(e){case"css":return this.toHSL().toString("css");case"hex":return this.toRGB().toString("hex");case"hexa":return this.toRGB().toString("hexa");case"hsb":return`hsb(${this.hue}, ${de(this.saturation,2)}%, ${de(this.brightness,2)}%)`;case"hsba":return`hsba(${this.hue}, ${de(this.saturation,2)}%, ${de(this.brightness,2)}%, ${this.alpha})`;default:return this.toFormat(e).toString(e)}}toFormat(e){switch(e){case"hsb":case"hsba":return this;case"hsl":case"hsla":return this.toHSL();case"rgb":case"rgba":return this.toRGB();default:throw new Error("Unsupported color conversion: hsb -> "+e)}}toHSL(){let e=this.saturation/100,t=this.brightness/100,r=t*(1-e/2);return e=r===0||r===1?0:(t-r)/Math.min(r,1-r),new Rt(de(this.hue,2),de(e*100,2),de(r*100,2),this.alpha)}toRGB(){let e=this.hue,t=this.saturation/100,r=this.brightness/100,s=(a,o=(a+e/60)%6)=>r-t*r*Math.max(Math.min(o,4-o,1),0);return new zt(Math.round(s(5)*255),Math.round(s(3)*255),Math.round(s(1)*255),this.alpha)}clone(){return new Pt(this.hue,this.saturation,this.brightness,this.alpha)}getChannelRange(e){switch(e){case"hue":return{minValue:0,maxValue:360,step:1,pageSize:15};case"saturation":case"brightness":return{minValue:0,maxValue:100,step:1,pageSize:10};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+e)}}formatChannelValue(e,t){let r,s=this.getChannelValue(e);switch(e){case"hue":r={style:"unit",unit:"degree",unitDisplay:"narrow"};break;case"saturation":case"brightness":r={style:"percent"},s/=100;break;case"alpha":r={style:"percent"};break;default:throw new Error("Unknown color channel: "+e)}return new Pi(t,r).format(s)}getColorSpace(){return"hsb"}getColorChannels(){return Pt.colorChannels}constructor(e,t,r,s){super(),this.hue=e,this.saturation=t,this.brightness=r,this.alpha=s}}Ri(Pt,"colorChannels",["hue","saturation","brightness"]);const Ff=/hsl\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%)\)|hsla\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d(.\d+)?)\)/;function Zl(n,e){return(n%e+e)%e}class Rt extends Ki{static parse(e){let t;if(t=e.match(Ff)){var r;const[s,a,o,l]=((r=t[1])!==null&&r!==void 0?r:t[2]).split(",").map(c=>Number(c.trim().replace("%","")));return new Rt(Zl(s,360),Xt(a,0,100),Xt(o,0,100),Xt(l!=null?l:1,0,1))}}toString(e){switch(e){case"hex":return this.toRGB().toString("hex");case"hexa":return this.toRGB().toString("hexa");case"hsl":return`hsl(${this.hue}, ${de(this.saturation,2)}%, ${de(this.lightness,2)}%)`;case"css":case"hsla":return`hsla(${this.hue}, ${de(this.saturation,2)}%, ${de(this.lightness,2)}%, ${this.alpha})`;default:return this.toFormat(e).toString(e)}}toFormat(e){switch(e){case"hsl":case"hsla":return this;case"hsb":case"hsba":return this.toHSB();case"rgb":case"rgba":return this.toRGB();default:throw new Error("Unsupported color conversion: hsl -> "+e)}}toHSB(){let e=this.saturation/100,t=this.lightness/100,r=t+e*Math.min(t,1-t);return e=r===0?0:2*(1-t/r),new Pt(de(this.hue,2),de(e*100,2),de(r*100,2),this.alpha)}toRGB(){let e=this.hue,t=this.saturation/100,r=this.lightness/100,s=t*Math.min(r,1-r),a=(o,l=(o+e/30)%12)=>r-s*Math.max(Math.min(l-3,9-l,1),-1);return new zt(Math.round(a(0)*255),Math.round(a(8)*255),Math.round(a(4)*255),this.alpha)}clone(){return new Rt(this.hue,this.saturation,this.lightness,this.alpha)}getChannelRange(e){switch(e){case"hue":return{minValue:0,maxValue:360,step:1,pageSize:15};case"saturation":case"lightness":return{minValue:0,maxValue:100,step:1,pageSize:10};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+e)}}formatChannelValue(e,t){let r,s=this.getChannelValue(e);switch(e){case"hue":r={style:"unit",unit:"degree",unitDisplay:"narrow"};break;case"saturation":case"lightness":r={style:"percent"},s/=100;break;case"alpha":r={style:"percent"};break;default:throw new Error("Unknown color channel: "+e)}return new Pi(t,r).format(s)}getColorSpace(){return"hsl"}getColorChannels(){return Rt.colorChannels}constructor(e,t,r,s){super(),this.hue=e,this.saturation=t,this.lightness=r,this.alpha=s}}Ri(Rt,"colorChannels",["hue","saturation","lightness"]);yn("#ffffff");yn("hsl(0, 100%, 50%)");const Lf=yn("#000000"),_f=yn("#FFFFFF");Lf.toHexInt();_f.toHexInt();function Bf({onChange:n,value:e,colors:t}){const r=t.map(s=>{const a=e===s;return i(Qo,{onClick:()=>{n==null||n(s)},className:P("relative block flex-shrink-0 w-26 h-26 border rounded",a&&"shadow-md"),style:{backgroundColor:s},children:a&&i("span",{className:"absolute inset-0 m-auto rounded-full w-8 h-8 bg-white"})},s)});return i("div",{className:"flex flex-wrap gap-6",children:r})}const $f=[{color:"rgb(255, 255, 255)",name:S("White")},{color:"rgb(239,245,245)",name:S("Solitude")},{color:"rgb(245,213,174)",name:S("Wheat")},{color:"rgb(253,227,167)",name:S("Cape Honey")},{color:"rgb(242,222,186)",name:S("Milk punch")},{color:"rgb(97,118,75)",name:S("Dingy"),foreground:"rgb(255, 255, 255)"},{color:"rgb(4, 147, 114)",name:S("Aquamarine"),foreground:"rgb(255, 255, 255)"},{color:"rgb(222,245,229)",name:S("Cosmic Latte")},{color:"rgb(233,119,119)",name:S("Geraldine"),foreground:"rgb(90,14,14)"},{color:"rgb(247,164,164)",name:S("Sundown")},{color:"rgb(30,139,195)",name:S("Pelorous"),foreground:"rgb(255, 255, 255)"},{color:"rgb(142,68,173)",name:S("Deep Lilac"),foreground:"rgb(255, 255, 255)"},{color:"rgb(108,74,182)",name:S("Blue marguerite"),foreground:"rgb(255, 255, 255)"},{color:"rgb(139,126,116)",name:S("Americano"),foreground:"rgb(255, 255, 255)"},{color:"rgb(0,0,0)",name:S("Black"),foreground:"rgb(255, 255, 255)"},{color:"rgb(64,66,88)",name:S("Blue zodiac"),foreground:"rgb(255, 255, 255)"},{color:"rgb(101,100,124)",name:S("Comet"),foreground:"rgb(255, 255, 255)"}],Vf=$f.map(({color:n})=>n).slice(0,14);function Hf({defaultValue:n,onChange:e,colorPresets:t,showInput:r}){const[s,a]=v.exports.useState(n),o=t||Vf,l=zi({size:"sm"});return g("div",{children:[i(Mf,{className:"!w-auto",color:s,onChange:c=>{e==null||e(c),a(c)}}),g("div",{className:"py-20 px-12",children:[o&&i(Bf,{colors:o,onChange:c=>{if(c){const d=yn(c).toString("hex");e==null||e(d),a(d)}},value:s}),r&&i("div",{className:"pt-20",children:i(Of,{autoComplete:"off",role:"textbox",autoCorrect:"off",spellCheck:"false",required:!0,"aria-label":"Hex color",prefixed:!0,className:l.input,color:s,onChange:c=>{e==null||e(c),a(c)}})})]})]})}function Gi({defaultValue:n,onChange:e,hideFooter:t=!1,showInput:r=!0}){const{close:s}=oe(),[a,o]=v.exports.useState(n||"");return g(ue,{size:"2xs",children:[i(Hf,{showInput:r,defaultValue:a,onChange:l=>{o(l),e==null||e(l)}}),!t&&g(ze,{dividerTop:!0,children:[i(E,{variant:"text",size:"xs",onClick:()=>{s()},children:i(u,{message:"Cancel"})}),i(E,{variant:"flat",color:"primary",size:"xs",onClick:()=>{s(a)},children:i(u,{message:"Apply"})})]})]})}function qf(){return g(v.exports.Fragment,{children:[i(Uf,{}),g("div",{className:"my-24 py-24 border-y",children:[i(ht,{to:"action-buttons",elementType:le,className:"mb-20",children:i(u,{message:"Action buttons"})}),i(ht,{to:"primary-features",elementType:le,children:i(u,{message:"Primary features"})}),i(ht,{to:"secondary-features",elementType:le,children:i(u,{message:"Secondary features"})})]}),i(Wf,{})]})}function Uf(){const n=vn(e=>{var t,r;return(r=(t=e.defaults)==null?void 0:t.settings.homepage.appearance)==null?void 0:r.headerImage});return g(re,{children:[i(w,{label:i(u,{message:"Header title"}),className:"mb-20",name:"settings.homepage.appearance.headerTitle",onFocus:()=>{ee().preview.setHighlight('[data-testid="headerTitle"]')}}),i(w,{label:i(u,{message:"Header subtitle"}),className:"mb-30",inputElementType:"textarea",rows:4,name:"settings.homepage.appearance.headerSubtitle",onFocus:()=>{ee().preview.setHighlight('[data-testid="headerSubtitle"]')}}),i(fn,{name:"settings.homepage.appearance.headerImage",className:"mb-30",label:i(u,{message:"Header image"}),defaultValue:n,diskPrefix:"homepage"}),i(df,{name:"settings.homepage.appearance.headerImageOpacity",label:i(u,{message:"Header image opacity"}),minValue:0,step:.1,maxValue:1,formatOptions:{style:"percent"}}),i("div",{className:"text-muted text-xs mb-20",children:i(u,{message:"In order for overlay colors to appear, header image opacity will need to be less then 100%"})}),i(Aa,{formKey:"settings.homepage.appearance.headerOverlayColor1",label:i(u,{message:"Header overlay color 1"})}),i(Aa,{formKey:"settings.homepage.appearance.headerOverlayColor2",label:i(u,{message:"Header overlay color 2"})})]})}function Wf(){const n=vn(e=>{var t,r;return(r=(t=e.defaults)==null?void 0:t.settings.homepage.appearance)==null?void 0:r.footerImage});return g(v.exports.Fragment,{children:[i(w,{label:i(u,{message:"Footer title"}),className:"mb-20",name:"settings.homepage.appearance.footerTitle",onFocus:()=>{ee().preview.setHighlight('[data-testid="footerTitle"]')}}),i(w,{label:i(u,{message:"Footer subtitle"}),className:"mb-20",name:"settings.homepage.appearance.footerSubtitle",onFocus:()=>{ee().preview.setHighlight('[data-testid="footerSubtitle"]')}}),i(fn,{name:"settings.homepage.appearance.footerImage",className:"mb-30",label:i(u,{message:"Footer background image"}),defaultValue:n,diskPrefix:"homepage"})]})}function Aa({label:n,formKey:e}){const t=e,{watch:r,setValue:s}=_(),a=r(t),o=l=>{s(e,l,{shouldDirty:!0})};return g(W,{type:"popover",onClose:l=>{o(l)},children:[i(ht,{className:"capitalize",startIcon:i(pl,{viewBox:"0 0 48 48",className:"icon-lg",style:{fill:a}}),children:n}),i(Gi,{defaultValue:a,onChange:l=>{o(l)}})]})}function ec(n){return n&&n.charAt(0).toUpperCase()+n.slice(1)}const jf=Z.forwardRef(({valueListKey:n="permissions",...e},t)=>{const{data:r}=st([n]),s=(r==null?void 0:r.permissions)||(r==null?void 0:r.workspacePermissions),[a,o]=mr(e.value,[],e.onChange),[l,c]=v.exports.useState(!1);if(!s)return null;const d=tc(s,a,l),h=f=>{const p=[...a],m=p.findIndex(b=>b.id===f.id);m>-1&&p.splice(m,1,f),o(p)};return g(v.exports.Fragment,{children:[i(Ht,{variant:"outline",ref:t,children:d.map(({groupName:f,items:p,anyChecked:m})=>i(Ge,{label:i(u,{message:Yi(f)}),startIcon:m?i(du,{size:"sm"}):void 0,children:i(Yo,{children:p.map(b=>{const y=a.findIndex(k=>k.id===b.id),x=y>-1;return g("div",{children:[i(Xo,{onSelected:()=>{if(x){const k=[...a];k.splice(y,1),o(k)}else o([...a,b])},endSection:i(ni,{tabIndex:-1,checked:x,onChange:()=>{}}),description:i(u,{message:b.description}),children:i(u,{message:b.display_name||b.name})}),x&&i(Jf,{permission:b,onChange:h})]},b.id)})})},f))}),i(ni,{className:"mt-30",checked:l,onChange:f=>{c(f.target.checked)},children:i(u,{message:"Show advanced permissions"})})]})});function Jf({permission:n,onChange:e}){var r;if(!((r=n==null?void 0:n.restrictions)!=null&&r.length))return null;const t=(s,a)=>{const o=uu(n,l=>{const c=l.restrictions.find(d=>d.name===s);c&&(c.value=a)});e==null||e(o)};return i("div",{className:"px-40 py-20",children:n.restrictions.map((s,a)=>{const o=a===n.restrictions.length-1,l=i(u,{message:Yi(s.name)}),c=s.description?i(u,{message:s.description}):void 0;return s.type==="bool"?i(ni,{description:c,className:P(!o&&"mb-30"),checked:Boolean(s.value),onChange:d=>{t(s.name,d.target.checked)},children:l},s.name):i(un,{size:"sm",label:l,description:c,type:"number",className:P(!o&&"mb-30"),value:s.value||"",onChange:d=>{t(s.name,d.target.value===""?void 0:parseInt(d.target.value))}},s.name)})})}function Qi(n){const{field:{onChange:e,value:t=[],ref:r}}=Bn({name:n.name});return i(jf,{ref:r,...hn({onChange:e,value:t},n)})}const Yi=n=>ec(n.replace("_"," "));function tc(n,e,t){const r=[];return n.forEach(s=>{const a=e.findIndex(l=>l.id===s.id);if(!t&&s.advanced)return;let o=r.find(l=>l.groupName===s.group);if(o||(o={groupName:s.group,anyChecked:!1,items:[]},r.push(o)),a>-1){const l={...s,restrictions:Kf(s.restrictions,e[a].restrictions)};o.anyChecked=!0,o.items.push(l)}else o.items.push(s)}),r}function Kf(n,e){return n==null?void 0:n.map(t=>{const r=e.find(s=>s.name===t.name);return r?{...t,value:r.value}:t})}function nc(){const n=sc.sections.menus.config;return n?n.availableRoutes.map(e=>({id:e,label:e,action:e,type:"route",target:"_self"})):[]}const Os={grid:"flex flex-wrap gap-24",button:"flex flex-col items-center rounded hover:bg-hover h-90 aspect-square"},Gf=[...Array(60).keys()],Qf=Z.lazy(()=>gr(()=>import("./icon-list.2de5be51.js"),["./icon-list.2de5be51.js","./main.2bd0a4cf.js","./main.21a886d7.css","./UnfoldMore.ea196e44.js","./Edit.da0e054a.js","./Info.85b22dea.js","./OpenInNew.dbce3025.js","./TaskAlt.29816e3d.js","./TrendingUp.a8209b48.js","./use-resume-subscription.20c77bdf.js"],import.meta.url));function Yf({onIconSelected:n}){const{trans:e}=Q(),[t,r]=Z.useState("");return g("div",{className:"py-4",children:[i(un,{className:"mb-20",value:t,onChange:s=>{r(s.target.value)},placeholder:e({message:"Search icons..."})}),i(or,{mode:"wait",children:i(v.exports.Suspense,{fallback:i(Dn.div,{..._r,className:Os.grid,children:Gf.map((s,a)=>i("div",{className:Os.button,children:i(Rr,{variant:"rect"})},a))}),children:i(Dn.div,{..._r,className:Os.grid,children:i(Qf,{searchQuery:t,onIconSelected:n})})})})]})}function Xf(){return g(ue,{size:"w-850",className:"min-h-dialog",children:[i(ve,{children:i(u,{message:"Select icon"})}),i(pe,{children:i(Zf,{})})]})}function Zf(){const{close:n}=oe();return i(Yf,{onIconSelected:e=>{n(e)}})}function ep(n){const e=v.exports.useRef();return v.exports.useEffect(()=>{e.current=n},[n]),e.current}function Tn({formPathPrefix:n,hideRoleAndPermissionFields:e}){const{trans:t}=Q(),r=s=>n?`${n}.${s}`:s;return g(v.exports.Fragment,{children:[i(w,{className:"mb-20",name:r("label"),label:i(u,{message:"Label"}),placeholder:t(S("No label...")),startAppend:i(tp,{prefixName:r})}),i(np,{prefixName:r}),!e&&g(v.exports.Fragment,{children:[i(rp,{prefixName:r}),i(sp,{prefixName:r})]}),i(ip,{prefixName:r})]})}function tp({prefixName:n,...e}){const{watch:t,setValue:r}=_(),s=n("icon"),a=t(s),o=a&&Zo(a);return g(W,{type:"modal",onClose:l=>{(l||l===null)&&r(s,l,{shouldDirty:!0})},children:[i(R,{className:"text-muted icon-sm",variant:"outline",size:"md",...e,children:o?i(o,{}):i(Ct,{})}),i(Xf,{})]})}function np({prefixName:n}){const e=_(),t=e.watch(n("type")),r=ep(t),{data:s}=st(["menuItemCategories"]),a=(s==null?void 0:s.menuItemCategories)||[],o=a.find(d=>d.type===t),{trans:l}=Q(),c=nc();return v.exports.useEffect(()=>{r&&r!==t&&e.setValue(n("action"),"")},[t,r,e,n]),g(v.exports.Fragment,{children:[g(se,{className:"mb-20",name:n("type"),selectionMode:"single",label:i(u,{message:"Type"}),children:[i(C,{value:"link",children:i(u,{message:"Custom link"})}),i(C,{value:"route",children:i(u,{message:"Site page"})}),a.map(d=>i(C,{value:d.type,children:d.name},d.type))]}),t==="link"&&i(w,{className:"mb-20",required:!0,type:"url",name:n("action"),placeholder:l({message:"Enter a url..."}),label:i(u,{message:"Url"})}),t==="route"&&i(se,{className:"mb-20",required:!0,items:c,name:n("action"),label:i(u,{message:"Page"}),searchPlaceholder:l(S("Search pages")),showSearchField:!0,selectionMode:"single",children:d=>i(C,{value:d.id,children:d.label},d.id)}),o&&i(se,{className:"mb-20",required:!0,items:o.items,name:n("action"),showSearchField:!0,searchPlaceholder:l(S("Search...")),selectionMode:"single",label:i(u,{message:o.name}),children:d=>i(C,{value:d.action,children:i(u,{message:d.label})})})]})}function rp({prefixName:n}){const{data:e}=st(["roles","permissions"]),t=(e==null?void 0:e.roles)||[],{trans:r}=Q();return i(cs,{className:"mb-20",placeholder:r({message:"Add role..."}),label:i(u,{message:"Only show if user has role"}),name:n("roles"),chipSize:"sm",suggestions:t,valueKey:"id",displayWith:s=>{var a;return(a=t.find(o=>o.id===s.id))==null?void 0:a.name},children:s=>i(C,{value:s.id,capitalizeFirst:!0,children:i(u,{message:s.name})},s.id)})}function sp({prefixName:n}){const{data:e}=st(["roles","permissions"]),{trans:t}=Q(),r=v.exports.useMemo(()=>tc((e==null?void 0:e.permissions)||[],[],!1),[e==null?void 0:e.permissions]);return i(cs,{label:i(u,{message:"Only show if user has permissions"}),placeholder:t({message:"Add permission..."}),chipSize:"sm",suggestions:r,name:n("permissions"),valueKey:"name",children:({groupName:s,items:a})=>i(el,{label:Yi(s),children:a.map(o=>i(C,{value:o.name,description:i(u,{message:o.description}),children:i(u,{message:o.display_name||o.name})},o.name))},s)})}function ip({prefixName:n}){return _().watch(n("type"))!=="link"?null:g(se,{className:"mt-20",selectionMode:"single",name:n("target"),label:i(u,{message:"Open link in"}),children:[i(C,{value:"_self",children:i(u,{message:"Same window"})}),i(C,{value:"_blank",children:i(u,{message:"New window"})})]})}function ap(){const[n,e]=v.exports.useState(["cta1"]);return g(Ht,{variant:"outline",expandedValues:n,onExpandedChange:t=>{e(t),t.length&&ee().preview.setHighlight(`[data-testid="${t[0]}"]`)},children:[i(Ge,{value:"cta1",label:i(u,{message:"Header button 1"}),children:i(Tn,{formPathPrefix:"settings.homepage.appearance.actions.cta1"})}),i(Ge,{value:"ct2",label:i(u,{message:"Header button 2"}),children:i(Tn,{formPathPrefix:"settings.homepage.appearance.actions.cta2"})}),i(Ge,{value:"cta3",label:i(u,{message:"Footer button"}),children:i(Tn,{formPathPrefix:"settings.homepage.appearance.actions.cta3"})})]})}function op(){const{fields:n,remove:e,append:t}=Ze({name:"settings.homepage.appearance.primaryFeatures"}),[r,s]=v.exports.useState([0]);return g("div",{children:[i(Ht,{variant:"outline",expandedValues:r,onExpandedChange:a=>{s(a),a.length&&ee().preview.setHighlight(`[data-testid="primary-root-${a[0]}"]`)},children:n.map((a,o)=>g(Ge,{value:o,label:i(u,{message:`Primary feature ${o+1}`}),children:[i(lp,{index:o}),i("div",{className:"text-right",children:i(E,{size:"xs",variant:"outline",color:"danger",onClick:()=>{e(o)},children:i(u,{message:"Remove"})})})]},a.id))}),i("div",{className:"mt-20 text-right",children:i(E,{size:"xs",variant:"outline",color:"primary",startIcon:i(Qe,{}),onClick:()=>{t({}),s([n.length])},children:i(u,{message:"Add feature"})})})]})}function lp({index:n}){const e=vn(t=>{var r,s,a;return(a=(s=(r=t.defaults)==null?void 0:r.settings.homepage.appearance)==null?void 0:s.primaryFeatures[n])==null?void 0:a.image});return g(re,{children:[i(fn,{name:`settings.homepage.appearance.primaryFeatures.${n}.image`,className:"mb-30",label:i(u,{message:"Image"}),defaultValue:e,diskPrefix:"homepage"}),i(w,{name:`settings.homepage.appearance.primaryFeatures.${n}.title`,label:i(u,{message:"Title"}),className:"mb-20",onFocus:()=>{ee().preview.setHighlight(`[data-testid="primary-title-${n}"]`)}}),i(w,{name:`settings.homepage.appearance.primaryFeatures.${n}.subtitle`,label:i(u,{message:"Subtitle"}),className:"mb-20",inputElementType:"textarea",rows:4,onFocus:()=>{ee().preview.setHighlight(`[data-testid="primary-subtitle-${n}"]`)}})]})}function cp(){const{fields:n,remove:e,append:t}=Ze({name:"settings.homepage.appearance.secondaryFeatures"}),[r,s]=v.exports.useState([0]);return g("div",{children:[i(Ht,{variant:"outline",expandedValues:r,onExpandedChange:a=>{s(a),a.length&&ee().preview.setHighlight(`[data-testid="secondary-root-${a[0]}"]`)},children:n.map((a,o)=>g(Ge,{value:o,label:i(u,{message:`Secondary feature ${o+1}`}),children:[i(dp,{index:o}),i("div",{className:"text-right",children:i(E,{size:"xs",variant:"outline",color:"danger",onClick:()=>{e(o)},children:i(u,{message:"Remove"})})})]},a.id))}),i("div",{className:"mt-20 text-right",children:i(E,{size:"xs",variant:"outline",color:"primary",startIcon:i(Qe,{}),onClick:()=>{t({}),s([n.length])},children:i(u,{message:"Add feature"})})})]})}function dp({index:n}){return g(re,{children:[i(fn,{name:`settings.homepage.appearance.secondaryFeatures.${n}.image`,className:"mb-30",label:i(u,{message:"Image"}),defaultValue:up(n),diskPrefix:"homepage"}),i(w,{name:`settings.homepage.appearance.secondaryFeatures.${n}.title`,label:i(u,{message:"Title"}),className:"mb-20",onFocus:()=>{ee().preview.setHighlight(`[data-testid="secondary-title-${n}"]`)}}),i(w,{name:`settings.homepage.appearance.secondaryFeatures.${n}.subtitle`,label:i(u,{message:"Subtitle"}),className:"mb-20",inputElementType:"textarea",rows:4,onFocus:()=>{ee().preview.setHighlight(`[data-testid="secondary-subtitle-${n}"]`)}}),i(w,{name:`settings.homepage.appearance.secondaryFeatures.${n}.description`,label:i(u,{message:"Description"}),className:"mb-20",inputElementType:"textarea",rows:4,onFocus:()=>{ee().preview.setHighlight(`[data-testid="secondary-description-${n}"]`)}})]})}function up(n){var e,t;return(t=((e=ee().defaults)==null?void 0:e.settings.homepage.appearance).secondaryFeatures[n])==null?void 0:t.image}const rc={preview:{defaultRoute:"drive",navigationRoutes:["s","drive"]},sections:{"landing-page":{label:S("Landing Page"),position:1,previewRoute:"/",routes:[{path:"landing-page",element:i(qf,{})},{path:"landing-page/action-buttons",element:i(ap,{})},{path:"landing-page/primary-features",element:i(op,{})},{path:"landing-page/secondary-features",element:i(cp,{})}],buildBreadcrumb:(n,e)=>{const r=n.split("/").filter(a=>!!a).pop(),s=[{label:S("Landing page"),location:"landing-page"}];return r==="action-buttons"&&s.push({label:S("Action buttons"),location:"landing-page/action-buttons"}),r==="primary-features"&&s.push({label:S("Primary features"),location:"landing-page/primary-features"}),r==="secondary-features"&&s.push({label:S("Secondary features"),location:"landing-page/secondary-features"}),s}},menus:{config:{positions:["drive-navbar","drive-sidebar","homepage-navbar","shareable-link-page","footer","footer-secondary"],availableRoutes:["/drive","/drive/shares","/drive/recent","/drive/starred","/drive/trash"]}}}},sc=hu.all([tf,rc]),vn=fu()(Zh(pu((n,e)=>({defaults:null,iframeWindow:null,config:sc,setDefaults:t=>{n(r=>{r.defaults={...t}})},setIframeWindow:t=>{n(()=>({iframeWindow:t}))},preview:{navigate:t=>{var o;const r=(o=e().config)==null?void 0:o.sections[t],s=(r==null?void 0:r.previewRoute)||"/",a=e().iframeWindow;s&&Kn(a,{type:"navigate",to:s})},setValues:t=>{const r=e().iframeWindow;Kn(r,{type:"setValues",values:t})},setThemeColor:(t,r)=>{const s=e().iframeWindow;Kn(s,{type:"setThemeColor",name:t,value:r})},setActiveTheme:t=>{const r=e().iframeWindow;Kn(r,{type:"setActiveTheme",themeId:t})},setCustomCode:(t,r)=>{const s=e().iframeWindow;Kn(s,{type:"setCustomCode",mode:t,value:r})},setHighlight:t=>{n(()=>{var a;let r=null;const s=(a=e().iframeWindow)==null?void 0:a.document;s&&t&&(r=s.querySelector(t)),r&&requestAnimationFrame(()=>{!r||r.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})})}}}))));function Kn(n,e){n&&n.postMessage({source:"be-appearance-editor",...e},"*")}function ee(){return vn.getState()}function hp(n){return q.post("admin/appearance",{changes:n}).then(e=>e.data)}function fp(){return te(n=>hp(n),{onSuccess:()=>{ne(S("Changes saved"))},onError:n=>Oe(n)})}function pp(){return dn(["admin/appearance/values"],()=>mp(),{staleTime:1/0})}function mp(){return q.get("admin/appearance/values").then(n=>n.data)}function gp(){const{pathname:n}=Fi(),{getValues:e}=_(),[t,r]=v.exports.useState(null);return v.exports.useEffect(()=>{var a;const[,,s]=n.split("/").filter(o=>!!o);if(s){const o=(a=ee().config)==null?void 0:a.sections[s];if(o){r([{label:S("Appearance"),location:""},...o.buildBreadcrumb(n,e())]);return}}r(null)},[n,e]),!t||t.length<2?null:g("div",{className:"flex items-center border-b h-60 flex-shrink-0",children:[i(R,{iconSize:"md",radius:"rounded-none",className:"text-muted h-full w-50 flex-shrink-0",elementType:le,to:`/admin/appearance/${t[t.length-2].location}`,children:i(Hi,{})}),g("div",{className:"border-l p-10 min-w-0",children:[i("div",{className:"text-xs text-muted",children:i(u,{message:"Customizing"})}),i("div",{className:"flex items-center gap-4 text-sm mt-2",children:t.map((s,a)=>{const o=t.length-1===a,l=a===0,c=i(mu,{value:s.label});return l?null:g(v.exports.Fragment,{children:[i("div",{className:P("whitespace-nowrap overflow-hidden overflow-ellipsis min-w-0",o&&"text-primary",o?"flex-shrink-0":"flex-auto"),children:c}),!o&&i(ls,{className:"icon-sm text-muted flex-shrink-0"})]},a)})})]})]})}function bp(){const{isAppearanceEditorActive:n}=gu(),{data:e}=pp(),{base_url:t}=Ye(),r=v.exports.useRef(null),{pathname:s}=Fi(),a=Xe();return v.exports.useEffect(()=>{(e==null?void 0:e.defaults)&&!ee().defaults&&ee().setDefaults(e.defaults)},[e]),v.exports.useEffect(()=>{r.current&&ee().setIframeWindow(r.current.contentWindow)},[]),v.exports.useEffect(()=>{const o=s.split("/")[3];ee().preview.navigate(o)},[s]),n?i(tl,{to:"/admin"}):g("div",{className:"md:flex items-center h-screen",children:[i(ss,{children:i(u,{message:"Appearance"})}),i(yp,{values:e==null?void 0:e.values}),i("div",{className:"flex-auto h-full relative",children:i("iframe",{ref:r,className:P("w-full h-full",a&&"hidden"),src:`${t}?appearanceEditor=true`})})]})}function yp({values:n}){const e=i("div",{className:"flex items-center justify-center flex-auto h-full",children:i(is,{isIndeterminate:!0,"aria-label":"Loading editor"})});return i(v.exports.Fragment,{children:i("div",{className:"bg relative w-full md:w-320 shadow-lg border-r h-full z-10",children:n?i(vp,{defaultValues:n}):e})})}function vp({defaultValues:n}){const e=ae({defaultValues:n}),{watch:t,reset:r}=e,s=fp();return v.exports.useEffect(()=>{const a=t(o=>{ee().preview.setValues(o)});return()=>a.unsubscribe()},[t]),g(Ee,{className:"h-full flex flex-col",form:e,onSubmit:a=>{s.mutate(a,{onSuccess:()=>r(a)})},children:[i(xp,{isLoading:s.isLoading}),i(gp,{}),i("div",{className:"px-14 py-20 flex-auto overflow-y-auto",children:i(br,{children:i(Oi,{})})})]})}function xp({isLoading:n}){const{formState:{dirtyFields:e}}=_(),t=Object.keys(e).length;return g("div",{className:"border-b flex items-center h-50 pr-10 flex-shrink-0",children:[i(R,{border:"border-r",className:"text-muted",elementType:le,to:"..",children:i($t,{})}),i("div",{className:"pl-10",children:i(u,{message:"Appearance editor"})}),i(E,{variant:"flat",color:"primary",className:"block ml-auto",disabled:!t||n,type:"submit",children:t?i(u,{message:"Save"}):i(u,{message:"Saved"})})]})}function Sp(){const n=pn(),{trans:e}=Q(),{fields:t,append:r}=Ze({name:"settings.menus",keyName:"key"});return g(v.exports.Fragment,{children:[i("div",{children:t.map((s,a)=>i(ht,{to:`${a}`,elementType:le,children:s.name},s.key))}),i("div",{className:"text-right",children:i(E,{variant:"outline",color:"primary",startIcon:i(Qe,{}),size:"xs",onClick:()=>{const s=Li(10);r({name:e(S("New menu :number",{values:{number:t.length+1}})),id:s,positions:[],items:[]}),n(`${t.length}`)},children:i(u,{message:"Create menu"})})})]})}function ic({title:n=i(u,{message:"Add menu item"})}){const{data:e}=st(["menuItemCategories"]),t=(e==null?void 0:e.menuItemCategories)||[],r=nc();return g(ue,{size:"sm",children:[i(ve,{children:n}),i(pe,{children:g(Ht,{variant:"outline",children:[i(Ge,{label:i(u,{message:"Link"}),bodyClassName:"max-h-240 overflow-y-auto",children:i(kp,{})}),i(Ge,{label:i(u,{message:"Route"}),bodyClassName:"max-h-240 overflow-y-auto",children:i(Ia,{items:r})}),t.map(s=>i(Ge,{label:i(u,{message:s.name}),children:i(Ia,{items:s.items})},s.name))]})})]})}function kp(){const n=ae({defaultValues:{id:Li(6),type:"link",target:"_blank"}}),{close:e}=oe();return g(Ee,{form:n,onSubmit:t=>{e(t)},children:[i(w,{required:!0,name:"label",label:i(u,{message:"Label"}),className:"mb-20"}),i(w,{required:!0,type:"url",name:"action",placeholder:"https://",label:i(u,{message:"Url"}),className:"mb-20"}),i("div",{className:"text-right",children:i(E,{type:"submit",variant:"flat",color:"primary",size:"xs",children:i(u,{message:"Add to menu"})})})]})}function Ia({items:n}){const{close:e}=oe();return i(Yo,{children:n.map(t=>i(Xo,{startIcon:i(Qe,{size:"sm"}),onSelected:()=>{if(t.label){const r=t.label.split("/").pop();t.label=r?ec(r):t.label,t.id=Li(6)}e(t)},children:t.label},t.id))})}const wp=U(i("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"DragIndicatorOutlined"),Cp=""+new URL("dropdown-menu.c9b3bd6a.svg",import.meta.url).href;function Np(n,e,t){const r=Br(e,0,n.length-1),s=Br(t,0,n.length-1);if(r===s)return n;const a=n[r],o=s<r?-1:1;for(let l=r;l!==s;l+=o)n[l]=n[l+o];return n[s]=a,n}function Mp(n,e,t){const r=n.slice();return r.splice(t<0?r.length+t:t,0,r.splice(e,1)[0]),r}let z=null;function Tp({item:n,items:e,type:t,ref:r,onSortEnd:s,onSortStart:a,onDragEnd:o,preview:l,disabled:c,onDropPositionChange:d,previewVariant:h="liveSort"}){const f=v.exports.useRef(null);v.exports.useEffect(()=>{z&&z.sortables.length!==e.length&&(z.sortables=[...e],z.activeIndex=e.indexOf(n))},[e,n]);const{draggableProps:p,dragHandleRef:m}=ih({id:n,ref:r,type:t,preview:l,disabled:c,onDragStart:()=>{var y;f.current=null,z={sortables:[...e],activeSortable:n,activeIndex:e.indexOf(n),finalIndex:e.indexOf(n),dropPosition:null,scrollParent:r.current?bu(r.current):void 0,scrollListener:()=>{oh(Kt)}},h==="liveSort"&&Op(),a==null||a(),(y=z.scrollParent)==null||y.addEventListener("scroll",z.scrollListener)},onDragEnd:()=>{var y;!z||(h==="liveSort"&&Ap(),z.dropPosition=null,d==null||d(z.dropPosition),z.activeIndex!==z.finalIndex&&(s==null||s(z.activeIndex,z.finalIndex)),(y=z.scrollParent)==null||y.removeEventListener("scroll",z.scrollListener),Da(),o==null||o(),z=null)},getData:()=>{}}),{droppableProps:b}=ah({id:n,ref:r,types:[t],disabled:c,allowDragEventsFromItself:!0,onDragOver:(y,x)=>{var B;if(!z||h!=="line")return;const k=z.dropPosition;let M=null;const T=(B=Kt.get(n))==null?void 0:B.rect;if(T){const A=T.top+T.height/2;x.clientY<=A?M="before":x.clientY>=A&&(M="after")}if(M!==k){const A=z.sortables.indexOf(n);if(z.dropPosition=M,d==null||d(z.dropPosition),Da(),r.current)if(z.dropPosition==="after")As(r.current,"bottom");else if(A===0)As(r.current,"top");else{const D=z.sortables[A-1],Y=Kt.get(D);Y!=null&&Y.ref.current&&As(Y.ref.current,"bottom")}const H=e.indexOf(n);if(z.activeIndex===H){z.finalIndex=z.activeIndex;return}(A>z.activeIndex?"after":"before")==="after"?z.finalIndex=z.dropPosition==="before"?H-1:H:z.finalIndex=z.dropPosition==="after"?H+1:H}},onDragEnter:()=>{if(!z||h==="line")return;const y=z.sortables.indexOf(n),x=z.sortables.indexOf(z.activeSortable);Np(z.sortables,x,y);const k=z.sortables.map(M=>{var T;return(T=Kt.get(M))==null?void 0:T.rect});z.sortables.forEach((M,T)=>{if(!z)return;const B=Mp(k,y,z.activeIndex),A=k[T],H=B[T],j=Kt.get(M);if((j==null?void 0:j.ref.current)&&H&&A){const D=H.left-A.left,Y=H.top-A.top;j.ref.current.style.transform=`translate3d(${D}px, ${Y}px, 0)`}}),z.finalIndex=y},onDragLeave:()=>{!z||h!=="line"||(z.dropPosition=null,d==null||d(z.dropPosition))}});return{sortableProps:{...hn(p,b)},dragHandleRef:m}}const Ep="transform 0.2s cubic-bezier(0.2, 0, 0, 1)";function Op(){!z||z.sortables.forEach((n,e)=>{const t=Kt.get(n);!(t!=null&&t.ref.current)||(t.ref.current.style.transition=Ep,(z==null?void 0:z.activeIndex)===e&&(t.ref.current.style.opacity="0.4"))})}function Ap(){!z||z.sortables.forEach(n=>{const e=Kt.get(n);e!=null&&e.ref.current&&(e.ref.current.style.transform="",e.ref.current.style.transition="",e.ref.current.style.opacity="",e.ref.current.style.zIndex="")})}function Da(){z!=null&&z.linePreviewEl&&(z.linePreviewEl.style.borderBottomColor="",z.linePreviewEl.style.borderTopColor="",z.linePreviewEl=void 0)}function As(n,e){const t="rgb(var(--be-primary))";e==="top"?n.style.borderTopColor=t:n.style.borderBottomColor=t,z&&(z.linePreviewEl=n)}function Ip(){const{menuIndex:n}=qe(),e=pn(),{getValues:t}=_(),r=`settings.menus.${n}`,s=t(r);return v.exports.useEffect(()=>{s?ee().preview.setHighlight(`[data-menu-id="${s.id}"]`):e("/admin/appearance/menus")},[e,s]),s?i(Dp,{formPath:r}):null}function Dp({formPath:n}){const{site:{has_mobile_app:e}}=Ye(),t=vn(a=>{var o;return(o=a.config)==null?void 0:o.sections.menus.config}),r=v.exports.useMemo(()=>{const a=[...t==null?void 0:t.positions];return e&&a.push("mobile-app-about"),a.map(o=>({key:o,name:o.replaceAll("-"," ")}))},[t,e]),s=Ze({name:`${n}.items`,keyName:"key"});return g(v.exports.Fragment,{children:[g("div",{className:"mb-30 pb-30 border-b",children:[i(w,{name:`${n}.name`,label:i(u,{message:"Menu name"}),className:"mb-20",autoFocus:!0}),i(cs,{chipSize:"sm",name:`${n}.positions`,valueKey:"id",label:i(u,{message:"Menu positions"}),description:i(u,{message:"Where should this menu appear on the site"}),children:r.map(a=>i(C,{value:a.key,capitalizeFirst:!0,children:a.name},a.key))})]}),i(zp,{fieldArray:s}),i("div",{className:"text-right",children:i(Pp,{})})]})}function zp({fieldArray:{append:n,fields:e,move:t}}){const r=pn();return g(v.exports.Fragment,{children:[g("div",{className:"flex items-center gap-16 justify-between flex-shrink-0",children:[i(u,{message:"Menu items"}),g(W,{type:"popover",placement:"right",offset:20,onClose:s=>{s&&(n({...s}),r(`items/${e.length}`))},children:[i(E,{variant:"outline",color:"primary",size:"xs",startIcon:i(Qe,{}),children:i(u,{message:"Add"})}),i(ic,{})]})]}),g("div",{className:"mt-20 flex-shrink-0",children:[e.map((s,a)=>i(Rp,{item:s,items:e,index:a,onSortEnd:(o,l)=>{t(o,l)}},s.key)),e.length?null:i(Ii,{size:"xs",className:"my-40",image:i(Di,{src:Cp}),title:i(u,{message:"No menu items yet"}),description:i(u,{message:"Click \u201Cadd\u201C button to start adding links, pages, routes and other items to this menu. "})})]})]})}function Pp(){const n=pn(),{menuIndex:e}=qe(),{fields:t,remove:r}=Ze({name:"settings.menus",keyName:"key"});if(!e)return null;const s=t[+e];return g(W,{type:"modal",onClose:a=>{if(a){const o=t.findIndex(l=>l.id===s.id);r(o),n("/admin/appearance/menus")}},children:[i(E,{variant:"outline",color:"danger",size:"xs",startIcon:i(ds,{}),children:i(u,{message:"Delete menu"})}),i(bt,{isDanger:!0,title:i(u,{message:"Delete menu"}),body:i(u,{message:"Are you sure you want to delete \u201C:name\u201C?",values:{name:s.name}}),confirm:i(u,{message:"Delete"})})]})}function Rp({item:n,items:e,index:t,onSortEnd:r}){const s=v.exports.useRef(null),{sortableProps:a,dragHandleRef:o}=Tp({item:n,items:e,type:"menuEditorSortable",ref:s,onSortEnd:r,previewVariant:"liveSort"}),l=n.icon&&Zo(n.icon),c=g("div",{className:"text-muted flex items-center gap-4 text-xs",children:[l&&i(l,{size:"sm"}),"(",i(u,{message:"No label..."}),")"]});return i(v.exports.Fragment,{children:i(ht,{elementType:le,to:`items/${t}`,ref:s,...a,children:g("div",{className:"flex items-center gap-10",children:[i(R,{ref:o,size:"sm",children:i(wp,{className:"text-muted hover:cursor-move"})}),i("div",{children:n.label||c})]})})})}function Fp(){const{menuIndex:n,menuItemIndex:e}=qe(),t=Fe(),{getValues:r}=_(),s=`settings.menus.${n}.items.${e}`,a=r(s);return v.exports.useEffect(()=>{a&&ee().preview.setHighlight(`[data-menu-item-id="${a.id}"]`)},[t,a]),!a||e==null?null:i(Lp,{formPath:s})}function Lp({formPath:n}){return g(v.exports.Fragment,{children:[i(Tn,{formPathPrefix:n}),i("div",{className:"text-right mt-40",children:i(_p,{})})]})}function _p(){const n=Fe(),{menuIndex:e,menuItemIndex:t}=qe(),{fields:r,remove:s}=Ze({name:`settings.menus.${+e}.items`});if(!t)return null;const a=r[+t];return g(W,{type:"modal",onClose:o=>{o&&t&&(s(+t),n(`/admin/appearance/menus/${e}`))},children:[i(E,{variant:"outline",color:"danger",size:"xs",startIcon:i(ds,{}),children:i(u,{message:"Delete this item"})}),i(bt,{isDanger:!0,title:i(u,{message:"Delete menu item"}),body:i(u,{message:"Are you sure you want to delete \u201C:name\u201C?",values:{name:a.label}}),confirm:i(u,{message:"Delete"})})]})}function Bp(){return g(v.exports.Fragment,{children:[i(Gn,{label:i(u,{message:"Favicon"}),description:i(u,{message:"This will generate different size favicons. Image should be at least 512x512 in size."}),type:"favicon"}),i(Gn,{label:i(u,{message:"Light logo"}),description:i(u,{message:"Will be used on dark backgrounds."}),type:"logo_light"}),i(Gn,{label:i(u,{message:"Dark logo"}),description:i(u,{message:"Will be used on light backgrounds. Will default to light logo if left empty."}),type:"logo_dark"}),i(Gn,{label:i(u,{message:"Mobile light logo"}),description:i(u,{message:"Will be used on light backgrounds on mobile. Will default to desktop logo if left empty."}),type:"logo_light_mobile"}),i(Gn,{label:i(u,{message:"Mobile dark logo"}),description:i(u,{message:"Will be used on dark backgrounds on mobile. Will default to desktop if left empty."}),type:"logo_dark_mobile"}),i($p,{}),i(Vp,{})]})}function Gn({label:n,description:e,type:t}){const r=vn(s=>{var a;return(a=s.defaults)==null?void 0:a.settings.branding[t]});return i(fn,{name:`settings.branding.${t}`,className:"border-b pb-30 mb-30",label:n,description:e,diskPrefix:"branding_media",defaultValue:r,onChange:()=>{ee().preview.setHighlight('[data-logo="navbar"]')}})}function $p(){return i(w,{name:"appearance.env.app_name",required:!0,className:"mt-20",label:i(u,{message:"Site name"})})}function Vp(){return i(w,{name:"settings.branding.site_description",className:"mt-20",inputElementType:"textarea",rows:4,label:i(u,{message:"Site description"})})}function Hp(n=1,e=1e4){const t=new Uint32Array(1);window.crypto.getRandomValues(t);const r=t[0]/(4294967295+1);return n=Math.ceil(n),e=Math.floor(e),Math.floor(r*(e-n+1))+n}function qp(){const{trans:n}=Q(),e=pn(),{data:{themes:t}}=nl(),{fields:r,append:s}=Ze({name:"appearance.themes.all",keyName:"key"});return v.exports.useEffect(()=>{t.selectedThemeId&&ee().preview.setActiveTheme(t.selectedThemeId)},[t.selectedThemeId]),g(v.exports.Fragment,{children:[i("div",{className:"mb-20",children:i(E,{size:"xs",variant:"outline",color:"primary",startIcon:i(Qe,{}),onClick:()=>{var o;const a=(o=ee().defaults)==null?void 0:o.appearance.themes.light;s({id:Hp(),name:n(S("New theme")),colors:a}),e(`${r.length+1}`)},children:i(u,{message:"New theme"})})}),r.map((a,o)=>i(ht,{to:`${o}`,elementType:_i,children:a.name},a.key))]})}function Up(){const{fields:n}=Ze({name:"appearance.seo"});return i(v.exports.Fragment,{children:n.map((e,t)=>i(w,{className:"mb-20",name:`appearance.seo.${t}.value`,label:i(u,{message:e.name}),placeholder:e.defaultValue,inputElementType:"textarea",rows:3},e.id))})}const Wp=Z.lazy(()=>gr(()=>import("./ace-editor.db2fd5b4.js"),["./ace-editor.db2fd5b4.js","./main.2bd0a4cf.js","./main.21a886d7.css","./index.9b3ee2f7.js"],import.meta.url));function ac({defaultValue:n,mode:e="html",title:t}){const[r,s]=v.exports.useState(n),[a,o]=v.exports.useState(!0);return g(ue,{size:"fullscreen",className:"h-full w-full",children:[i(ve,{children:t}),i(pe,{className:"relative flex-auto",padding:"p-0",children:i(v.exports.Suspense,{fallback:i("div",{className:"flex items-center justify-center w-full h-400",children:i(is,{"aria-label":"Loading editor...",isIndeterminate:!0,size:"md"})}),children:i(Wp,{mode:e,onChange:l=>{s(l)},defaultValue:r||"",onIsValidChange:o})})}),i(jp,{isValid:a,value:r})]})}function jp({isValid:n,value:e}){const{close:t}=oe();return g(ze,{dividerTop:!0,children:[i(E,{onClick:()=>t(),children:i(u,{message:"Cancel"})}),i(E,{disabled:!n,variant:"flat",color:"primary",onClick:()=>{t(e)},children:i(u,{message:"Save"})})]})}function Jp(){return g(v.exports.Fragment,{children:[i(za,{mode:"css"}),i(za,{mode:"html"})]})}function za({mode:n}){const{getValues:e}=_(),{setValue:t}=_(),r=n==="html"?i(u,{message:"Custom HTML & JavaScript"}):i(u,{message:"Custom CSS"});return g(W,{type:"modal",onClose:s=>{s!=null&&(t(`appearance.custom_code.${n}`,s,{shouldDirty:!0}),ee().preview.setCustomCode(n,s))},children:[i(ht,{children:r}),i(ac,{title:r,defaultValue:e(`appearance.custom_code.${n}`)||"",mode:n})]})}const Kp=""+new URL("articles.8bfd9f17.svg",import.meta.url).href,Gp=n=>{const e=n.customPages.types.length>1?[{control:{type:Me.Select,defaultValue:"default",options:n.customPages.types.map(t=>({value:t.type,label:t.label,key:t.type}))},key:"type",label:S("Type"),description:S("Type of the page"),defaultOperator:Se.eq}]:[];return[{key:"user_id",label:S("User"),description:S("User page was created by"),defaultOperator:Se.eq,control:{type:Me.SelectModel,model:Ui}},...e,$n({description:S("Date page was created")}),Vn({description:S("Date page was last updated")})]},Qp=[{key:"slug",allowsSorting:!0,width:"flex-2 min-w-200",visibleInMode:"all",header:()=>i(u,{message:"Slug"}),body:n=>i(le,{target:"_blank",to:`/pages/${n.slug}`,className:Bi,children:n.slug})},{key:"user_id",allowsSorting:!0,width:"flex-2 min-w-140",header:()=>i(u,{message:"Owner"}),body:n=>n.user&&i(Hn,{image:n.user.avatar,label:n.user.display_name,description:n.user.email})},{key:"type",maxWidth:"max-w-100",header:()=>i(u,{message:"Type"}),body:n=>i(u,{message:n.type})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>i(u,{message:"Last updated"}),body:n=>i(Ve,{date:n.updated_at})},{key:"actions",header:()=>i(u,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-84 flex-shrink-0",visibleInMode:"all",body:n=>i(R,{size:"md",className:"text-muted",elementType:le,to:`${n.id}/edit`,children:i(Ct,{})})}];function Yp(){const n=v.exports.useContext(Vt),e=v.exports.useMemo(()=>Gp(n),[n]);return i(qt,{endpoint:"custom-pages",title:i(u,{message:"Custom pages"}),filters:e,columns:Qp,queryParams:{with:"user"},actions:i(Xp,{}),selectedActions:i(gn,{}),emptyStateMessage:i(mt,{image:Kp,title:i(u,{message:"No pages have been created yet"}),filteringTitle:i(u,{message:"No matching pages"})})})}function Xp(){return i(bn,{elementType:le,to:"new",children:i(u,{message:"New page"})})}const Zp=[{label:S("Drive"),to:"drive"}],oc=[{label:S("General"),to:"general"},...Zp,{label:S("Subscriptions"),to:"subscriptions"},{label:S("Localization"),to:"localization"},{label:S("Authentication"),to:"authentication"},{label:S("Uploading"),to:"uploading"},{label:S("Mail"),to:"mail"},{label:S("Cache"),to:"cache"},{label:S("Analytics"),to:"analytics"},{label:S("Logging"),to:"logging"},{label:S("Queue"),to:"queue"},{label:S("Recaptcha"),to:"recaptcha"},{label:S("GDPR"),to:"gdpr"},{label:S("Menus"),to:"/admin/appearance/menus"},{label:S("Seo"),to:"/admin/appearance/seo-settings"},{label:S("Themes"),to:"/admin/appearance/themes"}];function em({className:n}){const e=Xe();return g("div",{className:P(n,"md:flex gap-30 min-h-full items-start p-24 container mx-auto"),children:[i(ss,{children:i(u,{message:"Settings"})}),e?i(tm,{}):i(nm,{}),i("div",{className:"md:px-30 flex-auto relative max-w-500",children:i(Oi,{})})]})}function tm(){const{pathname:n}=Fi(),e=pn(),t=n.split("/").pop();return i(rs,{minWidth:"min-w-none",className:"w-full bg-paper mb-24",selectionMode:"single",selectedValue:t,onSelectionChange:r=>{e(r)},children:oc.map(r=>i(C,{value:r.to,children:i(u,{...r.label})},r.to))})}function nm(){return i("div",{className:"w-240 sticky top-24 flex-shrink-0",children:oc.map(n=>i(_i,{to:n.to,className:({isActive:e})=>P("block p-14 whitespace-nowrap mb-8 rounded border-l-4 text-sm transition-bg-color",e?"bg-primary/selected border-l-primary font-medium":"border-l-transparent hover:bg-hover"),children:i(u,{...n.label})},n.to))})}function xr(){return dn(["fetchAdminSettings"],()=>rm(),{staleTime:1/0})}function rm(){return q.get("settings").then(n=>n.data)}function sm(){return q.post("sitemap/generate").then(n=>n.data)}function im(){return te(()=>sm(),{onSuccess:()=>{ne(S("Sitemap generated"))},onError:n=>Oe(n)})}const Is=n=>n instanceof Date,am=n=>Object.keys(n).length===0,ai=n=>n!=null&&typeof n=="object",Pa=(n,...e)=>Object.prototype.hasOwnProperty.call(n,...e),Ds=n=>ai(n)&&am(n),om=()=>Object.create(null),oi=(n,e)=>{if(n===e)return{};if(!ai(n)||!ai(e))return e;const t=Object.keys(n).reduce((r,s)=>(Pa(e,s)||(r[s]=void 0),r),om());return Is(n)||Is(e)?n.valueOf()==e.valueOf()?{}:e:Object.keys(e).reduce((r,s)=>{if(!Pa(n,s))return r[s]=e[s],r;const a=oi(n[s],e[s]);return Ds(a)&&!Is(a)&&(Ds(n[s])||!Ds(e[s]))||(r[s]=a),r},t)};function lc(n){const{data:e}=xr();return te(t=>{var a,o,l,c,d,h;(o=(a=t.client)==null?void 0:a.cookie_notice)!=null&&o.button&&(t.client.cookie_notice.button=JSON.stringify(t.client.cookie_notice.button)),(c=(l=t.client)==null?void 0:l.registration)!=null&&c.policies&&(t.client.registration.policies=JSON.stringify(t.client.registration.policies)),(h=(d=t.client)==null?void 0:d.artistPage)!=null&&h.tabs&&(t.client.artistPage.tabs=JSON.stringify(t.client.artistPage.tabs));const r=t.client?oi(e.client,t.client):null,s=t.server?oi(e.server,t.server):null;return lm({client:r,server:s,files:t.files})},{onSuccess:()=>{ne(S("Settings updated"),{position:"bottom-right"}),G.invalidateQueries(["fetchAdminSettings"])},onError:t=>He(t,n)})}function lm({client:n,server:e,files:t}){const r=new FormData;return n&&r.set("client",JSON.stringify(ka.dot(n))),e&&r.set("server",JSON.stringify(ka.dot(e))),Object.entries(t||{}).forEach(([s,a])=>{r.set(s,a)}),q.post("settings",r,{headers:{"Content-Type":"multipart/form-data"}}).then(s=>s.data)}function Ue({title:n,description:e,children:t}){const{data:r}=xr();return g("section",{children:[g("div",{className:"mb-40",children:[i("h2",{className:"text-xl mb-4",children:n}),i("div",{className:"text-sm text-muted",children:e})]}),r?i(cm,{defaultValues:r,children:t}):i(is,{isIndeterminate:!0,"aria-label":"Loading settings..."})]})}function cm({children:n,defaultValues:e}){const t=ae({defaultValues:e}),r=lc(t);return g(v.exports.Fragment,{children:[g(Ee,{form:t,onBeforeSubmit:()=>{const s=t.formState.errors,a=Object.keys(s).filter(o=>o.endsWith("_group"));t.clearErrors(a)},onSubmit:s=>{r.mutate(s)},children:[n,i("div",{className:"mt-40",children:i(E,{type:"submit",variant:"flat",color:"primary",disabled:r.isLoading,children:i(u,{message:"Update"})})})]}),r.isLoading&&i(jo,{size:"xs",className:"absolute -bottom-14 left-30 w-full",isIndeterminate:!0,"aria-label":"Saving settings..."})]})}function St(){return i("div",{className:"h-1 bg-divider my-30"})}function Sr({link:n,className:e}){const{site:t}=Ye();return t.hide_docs_button?null:g("div",{className:P("flex items-center gap-8",e),children:[i(Wi,{size:"sm"}),i(as,{href:n,children:i(u,{message:"Learn more"})})]})}function dm(){return g(Ue,{title:i(u,{message:"General"}),description:i(u,{message:"Configure site url, homepage, theme and other general settings."}),children:[i(um,{}),i(St,{}),i(hm,{}),i(St,{}),i(fm,{}),i(St,{}),i(pm,{})]})}function um(){const{data:n}=xr();if(!n)return null;let e=null;const t=n.server,r=t.newAppUrl&&t.newAppUrl!==t.app_url;return r&&(e=i("div",{className:"text-sm text-danger mt-20",children:i(u,{values:{baseUrl:t.app_url,currentUrl:t.newAppUrl,b:s=>i("b",{children:s})},message:"Base site url is set as <b>:baseUrl</b> in configuration, but current url is <b>:currentUrl</b>. It is recommended to set the primary url you want to use in configuration file and then redirect all other url versions to this primary version via cpanel or .htaccess file."})})),g(v.exports.Fragment,{children:[i(w,{invalid:!!r,name:"server.app_url",label:i(u,{message:"Primary site url"}),description:i(Sr,{link:"https://support.vebto.com/help-center/articles/35/primary-site-url"})}),e]})}function hm(){var s,a;const{watch:n}=_(),{homepage:e}=v.exports.useContext(Vt),{data:t}=st(["menuItemCategories"]),r=n("client.homepage.type");return g("div",{children:[g(se,{name:"client.homepage.type",selectionMode:"single",label:i(u,{message:"Site home page"}),description:i(u,{message:"Which page should be used as site homepage."}),children:[e.options.map(o=>i(C,{value:o.value,children:i(u,{...o.label})},o.value)),(s=t==null?void 0:t.menuItemCategories)==null?void 0:s.map(o=>i(C,{value:o.type,children:o.name},o.type))]}),(a=t==null?void 0:t.menuItemCategories)==null?void 0:a.map(o=>r===o.type?i(se,{className:"mt-24",name:"client.homepage.value",selectionMode:"single",label:i(u,{message:"Homepage :name",values:{name:o.name}}),children:o.items.map(l=>i(C,{value:l.model_id,children:l.label},l.label))},o.name):null)]})}function fm(){const{data:{themes:n}}=nl();return g(v.exports.Fragment,{children:[g(se,{className:"mb-20",name:"client.themes.default_id",selectionMode:"single",label:i(u,{message:"Default site theme"}),description:i(u,{message:"Which theme to use for users that have not chosen a theme manually."}),children:[i(C,{value:0,children:i(u,{message:"System"})}),n.all.map(e=>i(C,{value:e.id,children:e.name},e.id))]}),i(K,{name:"client.themes.user_change",description:i(u,{message:"Allow users to manually change site theme."}),children:i(u,{message:"Allow theme change"})})]})}function pm(){const n=im(),{base_url:e}=Ye(),t=`${e}/storage/sitemaps/sitemap-index.xml`,r=i(as,{href:t,children:t});return g(re,{children:[i(E,{variant:"outline",size:"xs",color:"primary",disabled:n.isLoading,onClick:()=>{n.mutate()},children:i(u,{message:"Generate sitemap"})}),i("div",{className:"text-sm text-muted mt-14",children:i(u,{message:"Once generated, sitemap url will be: :url",values:{url:r}})})]})}function mm(n){return yn(n).toString("rgb").replace("rgb(","").replace(")","").replace(/, ?/g," ")}function gm(n){try{return yn(`rgb(${n.split(" ").join(",")})`).toString("hex")}catch{return n}}const bm=U(i("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"}),"TuneOutlined");function ym(){const{getValues:n,setValue:e}=_(),{themeIndex:t}=qe(),r=n(`appearance.themes.all.${+t}`);return g(W,{type:"modal",onClose:s=>{!s||n("appearance.themes.all").forEach((a,o)=>{if(a.id===s.id){e(`appearance.themes.all.${o}`,s,{shouldDirty:!0});return}if(s.default_light){e(`appearance.themes.all.${o}`,{...a,default_light:!1},{shouldDirty:!0});return}if(s.default_dark){e(`appearance.themes.all.${o}`,{...a,default_dark:!1},{shouldDirty:!0});return}})},children:[i(E,{size:"xs",variant:"outline",color:"primary",startIcon:i(bm,{}),children:i(u,{message:"Settings"})}),i(vm,{theme:r})]})}function vm({theme:n}){const e=ae({defaultValues:n}),{close:t,formId:r}=oe();return v.exports.useEffect(()=>{const s=e.watch((a,{name:o})=>{o==="default_light"&&a.default_light&&e.setValue("default_dark",!1),o==="default_dark"&&a.default_dark&&e.setValue("default_light",!1)});return()=>s.unsubscribe()},[e]),g(ue,{children:[i(ve,{children:i(u,{message:"Update settings"})}),i(pe,{children:g(Ee,{form:e,id:r,onSubmit:s=>{t(s)},children:[i(w,{name:"name",label:i(u,{message:"Name"}),className:"mb-30",autoFocus:!0}),i(K,{name:"is_dark",className:"mb-20 pb-20 border-b",description:i(u,{message:"Whether this theme has light text on dark background."}),children:i(u,{message:"Dark theme"})}),i(K,{name:"default_light",className:"mb-30",description:i(u,{message:"When light mode is selected, this theme will be used."}),children:i(u,{message:"Default for light mode"})}),i(K,{name:"default_dark",description:i(u,{message:"When dark mode is selected, this theme will be used."}),children:i(u,{message:"Default for dark mode"})})]})}),g(ze,{children:[i(E,{onClick:()=>{t()},children:i(u,{message:"Cancel"})}),i(E,{variant:"flat",color:"primary",type:"submit",form:r,disabled:!e.formState.isDirty,children:i(u,{message:"Save"})})]})]})}const xm=U(i("path",{d:"M6 13c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91zm14 0c0-4.42-3.58-8-8-8-.06 0-.12.01-.18.01l1.09-1.09L11.5 2.5 8 6l3.5 3.5 1.41-1.41-1.08-1.08c.06 0 .12-.01.17-.01 3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93z"}),"RestartAltOutlined");function Sm(){const n=Fe(),{themeIndex:e}=qe(),[t,r]=v.exports.useState(!1),{setValue:s,getValues:a}=_(),{fields:o,remove:l}=Ze({name:"appearance.themes.all"}),c=()=>{if(o.length<=1){ne.danger(S("At least one theme is required"));return}e&&(n("/admin/appearance/themes"),l(+e),s("appearance.themes.selectedThemeId",null))};return g(v.exports.Fragment,{children:[g(yr,{onItemSelected:d=>{if(d==="delete")r(!0);else if(d==="reset"){const h=`appearance.themes.all.${+e}`,f=a(`${h}.is_dark`)?ee().defaults.appearance.themes.dark:ee().defaults.appearance.themes.light;Object.entries(f).forEach(([p,m])=>{ee().preview.setThemeColor(p,m)}),s(`${h}.colors`,f,{shouldDirty:!0})}},children:[i(R,{size:"md",className:"text-muted",children:i(ol,{})}),g(vr,{children:[i(C,{value:"reset",startIcon:i(xm,{}),children:i(u,{message:"Reset colors"})}),i(C,{value:"delete",startIcon:i(ds,{}),children:i(u,{message:"Delete"})})]})]}),i(W,{type:"modal",isOpen:t,onClose:d=>{d&&c(),r(!1)},children:i(bt,{isDanger:!0,title:i(u,{message:"Delete theme"}),body:i(u,{message:"Are you sure you want to delete this theme?"}),confirm:i(u,{message:"Delete"})})})]})}function km(){const n=pn(),{themeIndex:e}=qe(),{getValues:t}=_(),r=t(`appearance.themes.all.${+e}`);return v.exports.useEffect(()=>{r||n("/admin/appearance/themes")},[n,r]),v.exports.useEffect(()=>{r!=null&&r.id&&ee().preview.setActiveTheme(r.id)},[r==null?void 0:r.id]),r?g(v.exports.Fragment,{children:[g("div",{className:"mb-20 flex items-center gap-10 justify-between",children:[i(ym,{}),i(Sm,{})]}),i("div",{children:Object.entries(r.colors).filter(([s])=>!s.endsWith("opacity")).map(([s,a])=>i(wm,{colorName:s,initialThemeValue:a,theme:r},s))})]}):null}function wm({theme:n,colorName:e,initialThemeValue:t}){const{setValue:r}=_(),{themeIndex:s}=qe(),[a,o]=v.exports.useState(t),l=d=>{o(d),ee().preview.setThemeColor(e,d)};v.exports.useEffect(()=>{o(t)},[t]);const c=gm(t);return g(W,{currentValue:c,type:"popover",placement:"right",offset:10,onClose:d=>{d&&d!==c?(r(`appearance.themes.all.${+s}.colors.${e}`,a,{shouldDirty:!0}),r("appearance.themes.selectedThemeId",n.id)):l(t)},children:[i(ht,{className:"capitalize",startIcon:i(pl,{viewBox:"0 0 48 48",className:"icon-lg",style:{fill:`rgb(${a})`}}),children:e.replace("--be-","").replace("-"," ")}),i(Gi,{defaultValue:c,onChange:d=>{l(mm(d))}})]})}function Cm(){return g(Ue,{title:i(u,{message:"Drive"}),description:i(u,{message:"Configure defaults for drive user dashboard."}),children:[g($i,{required:!0,className:"mb-30",size:"md",name:"client.drive.default_view",orientation:"vertical",label:i(u,{message:"Default view mode"}),description:i(u,{message:"Which view mode should user drive use by default."}),children:[i(Zt,{value:"list",children:i(u,{message:"List"})}),i(Zt,{value:"grid",children:i(u,{message:"Grid"})})]}),i(K,{className:"mb-30",name:"client.drive.send_share_notification",description:i(u,{message:"Send a notification to user when a file or folder is shared with them."}),children:i(u,{message:"Share notifications"})}),i(K,{name:"client.share.suggest_emails",description:i(u,{message:"Suggest email address of existing users when sharing a file or folder."}),children:i(u,{message:"Suggest emails"})})]})}const Nm=[{path:"drive",element:i(Cm,{})}];function Le({children:n,name:e,separatorBottom:t=!0,separatorTop:r=!0}){const{formState:{errors:s}}=_(),a=v.exports.useRef(null),o=s[e];return v.exports.useEffect(()=>{var l;o&&((l=a.current)==null||l.scrollIntoView({behavior:"smooth"}))},[o]),g("div",{className:P(t&&"border-b mb-20 pb-20",r&&"border-t mt-20 pt-20",o&&"border-y-error"),ref:a,children:[n(!!o),o&&i("div",{className:"text-danger text-sm mt-20",dangerouslySetInnerHTML:{__html:o.message}})]})}function li({children:n,...e}){const{field:{onChange:t,onBlur:r,value:s=[],ref:a},fieldState:{invalid:o,error:l}}=Bn({name:e.name}),c=v.exports.useMemo(()=>{const h=s;return typeof h=="string"?JSON.parse(h):h},[s]),d={onChange:h=>{const f=JSON.stringify(h.map(p=>p.name));t(f)},onBlur:r,value:c,invalid:o,errorMessage:l==null?void 0:l.message};return i(lh,{ref:a,...hn(d,e)})}const kr=Z.createContext(null);function cc(n){const{size:e="md",children:t,className:r,isLazy:s,overflow:a="overflow-hidden"}=n,o=v.exports.useRef([]),l=v.exports.useId(),[c,d]=mr(n.selectedTab,n.defaultSelectedTab||0,n.onTabChange),h=v.exports.useMemo(()=>({selectedTab:c,setSelectedTab:d,tabsRef:o,size:e,isLazy:s,id:l}),[c,l,s,d,e]);return i(kr.Provider,{value:h,children:i("div",{className:P(r,a,"max-w-full"),children:t})})}function Mm(){const{tabsRef:n,selectedTab:e}=v.exports.useContext(kr),[t,r]=v.exports.useState({width:void 0,transform:void 0,className:void 0});return rl(()=>{if(e!=null&&n.current){const s=n.current[e];if(!s)return;r(a=>({width:`${s.offsetWidth}px`,transform:`translateX(${s.offsetLeft}px)`,className:a.width===void 0?"":"transition-all"}))}},[r,e,n]),i("div",{className:P("absolute bottom-0 left-0 h-2 bg-primary",t.className),role:"presentation",style:{width:t.width,transform:t.transform}})}function dc({children:n,center:e,expand:t,className:r}){const s=v.exports.Children.toArray(n);return i(qo,{children:g("div",{className:P("flex relative max-w-full overflow-auto border-b max-sm:hidden-scrollbar md:compact-scrollbar",r),role:"tablist","aria-orientation":"horizontal",children:[s.map((a,o)=>v.exports.isValidElement(a)?v.exports.cloneElement(a,{index:o,className:P(a.props.className,t&&"flex-auto",e&&o===0&&"ml-auto",e&&o===s.length-1&&"mr-auto")}):null),i(Mm,{})]})})}function $r({index:n,className:e,isDisabled:t,children:r,padding:s,elementType:a="button",to:o,relative:l,width:c="min-w-min"}){const{selectedTab:d,setSelectedTab:h,tabsRef:f,size:p="md",id:m}=v.exports.useContext(kr),b=n===d,y=Uo(),x=s||(p==="sm"?"px-12":"px-18"),k=P("tracking-wide overflow-hidden capitalize text-sm flex items-center justify-center outline-none transition-colors","focus-visible:ring focus-visible:ring-2 ring-inset rounded whitespace-nowrap cursor-pointer",c,Tm({isDisabled:t,isSelected:b}),e,p==="md"&&`${x} h-48`,p==="sm"&&`${x} h-32`,t&&"pointer-events-none"),M=A=>{switch(A.key){case"ArrowLeft":y.focusPrevious();break;case"ArrowRight":y.focusNext();break;case"Home":y.focusFirst();break;case"End":y.focusLast();break}},T=b?0:-1;return i(a,{disabled:t,id:`${m}-${n}-tab`,"aria-controls":`${m}-${n}-tabpanel`,type:"button",role:"tab","aria-selected":b,tabIndex:t?void 0:T,onKeyDown:M,onClick:()=>{h(n)},to:o,relative:l,className:k,ref:A=>{f.current&&A&&(f.current[n]=A)},children:r})}function Tm({isDisabled:n,isSelected:e}){return n?"text-disabled cursor-default":e?"text-primary":"text-muted hover:text-main"}function uc({children:n,className:e}){const{selectedTab:t,isLazy:r}=v.exports.useContext(kr),s=v.exports.Children.toArray(n).filter(o=>!!o);let a;if(r){const o=s[t];a=v.exports.isValidElement(o)?v.exports.cloneElement(s[t],{index:t}):null}else a=s.map((o,l)=>{if(v.exports.isValidElement(o)){const c=l===t;return v.exports.cloneElement(o,{index:l,"aria-hidden":!c,className:c?o.props.className:P(o.props.className,"hidden")})}return null});return i("div",{className:e,children:a})}function Vr({className:n,children:e,index:t,...r}){const{id:s}=v.exports.useContext(kr),[a,o]=v.exports.useState(0),l=v.exports.useRef(null);return rl(()=>{if(l!=null&&l.current){const c=()=>{const h=yu(l.current,{tabbable:!0});o(h.nextNode()?void 0:0)};c();const d=new MutationObserver(c);return d.observe(l.current,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabIndex","disabled"]}),()=>{d.disconnect()}}},[l]),i("div",{tabIndex:a,ref:l,id:`${s}-${t}-tabpanel`,"aria-labelledby":`${s}-${t}-tab`,className:P(n,"focus-visible:outline-primary-light"),role:"tabpanel",...r,children:e})}function Em(){const{trans:n}=Q();return i(Ue,{title:i(u,{message:"Subscriptions"}),description:i(u,{message:"Configure gateway integration, accepted cards, invoices and other related settings."}),children:g(cc,{children:[g(dc,{children:[i($r,{children:i(u,{message:"General"})}),i($r,{children:i(u,{message:"Invoices"})})]}),g(uc,{className:"pt-30",children:[g(Vr,{children:[i(K,{name:"client.billing.enable",description:i(u,{message:"Enable or disable all subscription related functionality across the site."}),children:i(u,{message:"Enable subscriptions"})}),i(St,{}),i(Om,{}),i(Am,{}),i(St,{}),i(li,{label:i(u,{message:"Accepted cards"}),name:"client.billing.accepted_cards",placeholder:n({message:"Add new card..."})})]}),g(Vr,{children:[i(w,{inputElementType:"textarea",rows:5,label:i(u,{message:"Invoice address"}),name:"client.billing.invoice.address",className:"mb-30"}),i(w,{inputElementType:"textarea",rows:5,label:i(u,{message:"Invoice notes"}),description:i(u,{message:"Default notes to show under `notes` section of user invoice. Optional."}),name:"client.billing.invoice.notes"})]})]})]})})}function Om(){const{watch:n}=_(),e=n("client.billing.paypal.enable");return g("div",{className:"mb-30",children:[i(K,{name:"client.billing.paypal.enable",description:g("div",{children:[i(u,{message:"Enable PayPal payment gateway integration."}),i(Sr,{className:"mt-6",link:"https://support.vebto.com/help-center/articles/147/configuring-paypal"})]}),children:i(u,{message:"PayPal gateway"})}),e?i(Le,{name:"paypal_group",children:t=>g(v.exports.Fragment,{children:[i(w,{name:"server.paypal_client_id",label:i(u,{message:"PayPal Client ID"}),required:!0,invalid:t,className:"mb-20"}),i(w,{name:"server.paypal_secret",label:i(u,{message:"PayPal Secret"}),required:!0,invalid:t,className:"mb-20"}),i(w,{name:"server.paypal_webhook_id",label:i(u,{message:"PayPal Webhook ID"}),required:!0,invalid:t,className:"mb-20"}),i(K,{name:"client.billing.paypal_test_mode",invalid:t,description:i("div",{children:i(u,{message:"Allows testing PayPal payments with sandbox accounts."})}),children:i(u,{message:"PayPal test mode"})})]})}):null]})}function Am(){const{watch:n}=_(),e=n("client.billing.stripe.enable");return g(v.exports.Fragment,{children:[i(K,{name:"client.billing.stripe.enable",description:g("div",{children:[i(u,{message:"Enable Stripe payment gateway integration."}),i(Sr,{className:"mt-6",link:"https://support.vebto.com/help-center/articles/148/configuring-stripe"})]}),children:i(u,{message:"Stripe gateway"})}),e?i(Le,{name:"stripe_group",separatorBottom:!1,children:t=>g(v.exports.Fragment,{children:[i(w,{name:"server.stripe_key",label:i(u,{message:"Stripe publishable key"}),required:!0,className:"mb-20",invalid:t}),i(w,{name:"server.stripe_secret",label:i(u,{message:"Stripe secret key"}),required:!0,className:"mb-20",invalid:t}),i(w,{name:"server.stripe_webhook_secret",label:i(u,{message:"Stripe webhook signing secret"}),className:"mb-20",invalid:t})]})}):null]})}function Im(){const{data:n}=st(["timezones","localizations"]),e=ch(),{trans:t}=Q();return g(Ue,{title:i(u,{message:"Localization"}),description:i(u,{message:"Configure global date, time and language settings."}),children:[g(se,{className:"mb-30",required:!0,name:"client.dates.default_timezone",showSearchField:!0,selectionMode:"single",label:i(u,{message:"Default timezone"}),searchPlaceholder:t(S("Search timezones")),description:i(u,{message:"Which timezone should be selected by default for new users and guests."}),children:[i(C,{value:"auto",children:i(u,{message:"Auto"})},"auto"),Object.entries((n==null?void 0:n.timezones)||{}).map(([r,s])=>i(el,{label:r,children:s.map(a=>i(C,{value:a.value,children:a.text},a.value))},r))]}),g(se,{name:"client.locale.default",className:"mb-30",selectionMode:"single",label:i(u,{message:"Default language"}),description:i(u,{message:"Which localization should be selected by default for new users and guests."}),children:[i(C,{value:"auto",children:i(u,{message:"Auto"})},"auto"),((n==null?void 0:n.localizations)||[]).map(r=>i(C,{value:r.language,capitalizeFirst:!0,children:r.name},r.language))]}),g($i,{required:!0,className:"mb-30",size:"sm",name:"client.dates.format",orientation:"vertical",label:i(u,{message:"Date verbosity"}),description:i(u,{message:"Default verbosity for all dates displayed across the site. Month/day order and separators will be adjusted automatically, based on user's locale."}),children:[i(Zt,{value:"auto",children:i(u,{message:"Auto"})},"auto"),Object.entries(vu).map(([r,s])=>i(Zt,{value:r,children:i(Ve,{date:e,options:s})},r))]}),i(K,{name:"client.i18n.enable",description:i(u,{message:"If disabled, site will always be shown in default language and user will not be able to change their locale."}),children:i(u,{message:"Enable translations"})})]})}function Dm(){return g(Ue,{title:i(u,{message:"Authentication"}),description:i(u,{message:"Configure registration, social login and related 3rd party integrations."}),children:[i(zm,{}),i(K,{className:"mb-24",name:"client.registration.disable",description:i(u,{message:"All registration related functionality (including social login) will be disabled."}),children:i(u,{message:"Disable registration"})}),i(K,{className:"mb-24",name:"client.single_device_login",description:i(u,{message:"Only allow one device to be logged into user account at the same time."}),children:i(u,{message:"Single device login"})}),i(K,{name:"client.social.compact_buttons",description:i(u,{message:"Use compact design for social login buttons."}),children:i(u,{message:"Compact buttons"})}),i(Pm,{}),i(Rm,{}),i(Fm,{}),i(Lm,{}),i(St,{}),i(w,{inputElementType:"textarea",rows:3,className:"mt-24",name:"client.auth.domain_blacklist",label:i(u,{message:"Domain blacklist"}),description:i(u,{message:"Comma separated list of domains. Users will not be able to register or login using any email adress from specified domains."})})]})}function zm(){const{watch:n}=_(),e=n("server.mail_setup");return i(K,{className:"mb-30",name:"client.require_email_confirmation",description:g(v.exports.Fragment,{children:[i(u,{message:"Require newly registered users to validate their email address before being able to login."}),!e&&i("p",{className:"mt-10 text-danger",children:i(u,{message:"Outgoing mail method needs to be setup before enabling this setting. <a>Fix now</a>",values:{a:t=>i(le,{className:"font-bold block underline",to:"/admin/settings/mail#outgoing-emails",children:t})}})})]}),children:i(u,{message:"Require email confirmation"})})}function Pm(){const{watch:n}=_(),{envato:e}=Ye(),t=n("client.social.envato.enable");return e!=null&&e.enable?i(Le,{separatorBottom:!1,name:"envato_group",children:r=>g(re,{children:[i(K,{invalid:r,name:"client.social.envato.enable",description:i(u,{message:"Enable logging into the site via envato."}),children:i(u,{message:"Envato login"})}),t&&g(re,{children:[i(w,{invalid:r,className:"mt-30",name:"server.envato_id",label:i(u,{message:"Envato ID"}),required:!0}),i(w,{invalid:r,className:"mt-30",name:"server.envato_secret",label:i(u,{message:"Envato secret"}),required:!0}),i(w,{invalid:r,className:"mt-30",name:"server.envato_personal_token",label:i(u,{message:"Envato personal token"}),required:!0})]})]})}):null}function Rm(){const{watch:n}=_(),e=n("client.social.google.enable");return i(Le,{name:"google_group",children:t=>g(re,{children:[i(K,{invalid:t,name:"client.social.google.enable",description:i(u,{message:"Enable logging into the site via google."}),children:i(u,{message:"Google login"})}),e&&g(re,{children:[i(w,{invalid:t,className:"mt-30",name:"server.google_id",label:i(u,{message:"Google client ID"}),required:!0}),i(w,{className:"mt-30",name:"server.google_secret",label:i(u,{message:"Google client secret"}),required:!0})]})]})})}function Fm(){const{watch:n}=_(),e=n("client.social.facebook.enable");return i(Le,{name:"facebook_group",separatorTop:!1,children:t=>g(re,{children:[i(K,{invalid:t,name:"client.social.facebook.enable",description:i(u,{message:"Enable logging into the site via facebook."}),children:i(u,{message:"Facebook login"})}),e&&g(re,{children:[i(w,{invalid:t,className:"mt-30",name:"server.facebook_id",label:i(u,{message:"Facebook app ID"}),required:!0}),i(w,{invalid:t,className:"mt-30",name:"server.facebook_secret",label:i(u,{message:"Facebook app secret"}),required:!0})]})]})})}function Lm(){const{watch:n}=_(),e=n("client.social.twitter.enable");return i(Le,{name:"twitter_group",separatorTop:!1,separatorBottom:!1,children:t=>g(re,{children:[i(K,{invalid:t,name:"client.social.twitter.enable",description:i(u,{message:"Enable logging into the site via twitter."}),children:i(u,{message:"Twitter login"})}),e&&g(re,{children:[i(w,{invalid:t,className:"mt-30",name:"server.twitter_id",label:i(u,{message:"Twitter ID"}),required:!0}),i(w,{invalid:t,className:"mt-30",name:"server.twitter_secret",label:i(u,{message:"Twitter secret"}),required:!0})]})]})})}function sn({title:n,description:e,actions:t,color:r="primary",className:s}){return g("div",{className:P(s,"p-10 rounded",r==="positive"&&"bg-positive/focus border-l-positive border-l-4",r==="warning"&&"bg-warning/focus border-l-warning border-l-4",r==="danger"&&"bg-danger/focus border-l-danger border-l-4",r==="primary"&&"bg-primary/focus border-l-primary border-l-4",r==="neutral"&&"bg-paper border"),children:[n&&i("div",{className:"text-sm mb-4 font-medium",children:n}),e&&i("div",{className:"text-sm",children:e}),t&&i("div",{className:"mt-14",children:t})]})}function _m(){return q.get("uploads/server-max-file-size").then(n=>n.data)}function Bm(){return dn(["MaxServerUploadSize"],()=>_m())}const $m=["B","KB","MB","GB","TB","PB"];function Ra(n,e){if(n==null)return 0;switch(e){case"KB":return n*1024;case"MB":return n*1024**2;case"GB":return n*1024**3;case"TB":return n*1024**4;case"PB":return n*1024**5;default:return n}}const Vm=0x630000000000,tr=Z.forwardRef(({name:n,...e},t)=>{const{field:{onChange:r,onBlur:s,value:a="",ref:o},fieldState:{invalid:l,error:c}}=Bn({name:n}),[d,h]=v.exports.useState(""),[f,p]=v.exports.useState("MB");v.exports.useEffect(()=>{if(a==null||a===""){h("");return}const{amount:y,unit:x}=Hm({bytes:Math.min(a,Vm)});p(x||"MB"),h(Number.isNaN(y)?"":y)},[a,f]);const m={onChange:y=>{const x=parseInt(y.target.value);if(Number.isNaN(x))r(x);else{const k=Ra(parseInt(y.target.value),f);r(k)}},onBlur:s,value:d,invalid:l,errorMessage:c==null?void 0:c.message,inputRef:o},b=i(rs,{minWidth:"min-w-80",selectionMode:"single",selectedValue:f,disabled:!a,onSelectionChange:y=>{const x=Ra(d||0,y);r(x)},children:$m.slice(0,5).map(y=>i(C,{value:y,children:y==="B"?"Bytes":y},y))});return i(un,{...hn(m,e),type:"number",ref:t,endAppend:b})}),Hm=xu(({bytes:n})=>{const e=sl(n);if(!e)return{amount:"",unit:"MB"};let t=parseInt(e.split(" ")[0]);return t=Math.round(t),{amount:t,unit:e.split(" ")[1]}});function qm(){const{trans:n}=Q();return te(()=>Um(),{onSuccess:()=>{ne(n(S("CORS file updated"))),G.invalidateQueries(["Query Key"])},onError:e=>Oe(e)})}function Um(){return q.post("s3/cors/upload").then(n=>n.data)}function Wm(){return te(n=>jm(n),{onError:n=>Oe(n)})}function jm(n){return q.post("settings/uploading/dropbox-refresh-token",n).then(e=>e.data)}function Jm({isInvalid:n}){const{watch:e,setValue:t}=_(),r=e("server.storage_dropbox_app_key"),s=e("server.storage_dropbox_app_secret");return g(v.exports.Fragment,{children:[i(w,{invalid:n,className:"mb-20",name:"server.storage_dropbox_app_key",label:i(u,{message:"Dropbox application key"}),required:!0}),i(w,{invalid:n,className:"mb-20",name:"server.storage_dropbox_app_secret",label:i(u,{message:"Dropbox application secret"}),required:!0}),i(w,{invalid:n,className:"mb-20",name:"server.storage_dropbox_refresh_token",label:i(u,{message:"Dropbox refresh token"}),required:!0}),g(W,{type:"modal",onClose:a=>{a&&t("server.storage_dropbox_refresh_token",a)},children:[i(E,{variant:"outline",color:"primary",size:"xs",disabled:!r||!s,children:i(u,{message:"Get dropbox refresh token"})}),i(Km,{appKey:r,appSecret:s})]})]})}function Km({appKey:n,appSecret:e}){const t=ae(),{formId:r,close:s}=oe(),a=Wm();return g(ue,{children:[i(ve,{children:i(u,{message:"Connected dropbox account"})}),i(pe,{children:g(Ee,{id:r,form:t,onSubmit:o=>{a.mutate({app_key:n,app_secret:e,access_code:o.accessCode},{onSuccess:l=>{s(l.refreshToken)}})},children:[g("div",{className:"mb-20 pb-20 border-b",children:[i("div",{className:"text-muted text-sm mb-10",children:i(u,{message:"Click the 'get access code' button to get dropbox access code, then paste it into the field below."})}),i(E,{variant:"outline",color:"primary",size:"xs",elementType:"a",target:"_blank",href:`https://www.dropbox.com/oauth2/authorize?client_id=${n}&token_access_type=offline&response_type=code`,children:i(u,{message:"Get access code"})})]}),i(w,{name:"accessCode",label:i(u,{message:"Dropbox access code"}),required:!0})]})}),g(ze,{children:[i(E,{onClick:()=>{s()},children:i(u,{message:"Cancel"})}),i(E,{variant:"flat",color:"primary",form:r,type:"submit",disabled:!n||!e||a.isLoading,children:i(u,{message:"Connect"})})]})]})}function Gm(){const{trans:n}=Q();return g(Ue,{title:i(u,{message:"Uploading"}),description:i(u,{message:"Configure size and type of files that users are able to upload. This will affect all uploads across the site."}),children:[i(Ym,{}),i(Xm,{}),i(Zm,{}),i(Le,{name:"static_delivery_group",children:e=>g($i,{invalid:e,size:"sm",name:"server.static_file_delivery",orientation:"vertical",label:i(u,{message:"File delivery optimization"}),description:i(u,{message:"Both X-Sendfile and X-Accel need to be enabled on the server first. When enabled, it will reduce server memory and CPU usage when previewing or downloading files, especially for large files."}),children:[i(Zt,{value:"",children:i(u,{message:"None"})}),i(Zt,{value:"xsendfile",children:i(u,{message:"X-Sendfile (Apache)"})}),i(Zt,{value:"xaccel",children:i(u,{message:"X-Accel (Nginx)"})})]})}),i(tr,{className:"mb-30",name:"client.uploads.chunk_size",min:1,label:i(u,{message:"Chunk size"}),placeholder:"Infinity",description:i(u,{message:"Size (in bytes) for each file chunk. It should only be changed if there is a maximum upload size on your server or proxy (for example cloudflare). If chunk size is larger then limit on the server, uploads will fail."})}),i(Qm,{}),i(St,{}),i(tr,{min:1,name:"client.uploads.max_size",className:"mb-30",label:i(u,{message:"Maximum file size"}),description:i(u,{message:"Maximum size (in bytes) for a single file user can upload."})}),i(tr,{min:1,name:"client.uploads.available_space",className:"mb-30",label:i(u,{message:"Available space"}),description:i(u,{message:"Disk space (in bytes) each user uploads are allowed to take up. This can be overridden per user."})}),i(li,{name:"client.uploads.allowed_extensions",className:"mb-30",label:i(u,{message:"Allowed extensions"}),placeholder:n(S("Add extension...")),description:i(u,{message:"List of allowed file types (jpg, mp3, pdf etc.). Leave empty to allow all file types."})}),i(li,{name:"client.uploads.blocked_extensions",label:i(u,{message:"Blocked extensions"}),placeholder:n(S("Add extension...")),description:i(u,{message:"Prevent uploading of these file types, even if they are allowed above."})})]})}function Qm(){const{data:n}=Bm();return i(sn,{color:"warning",description:i(u,{message:"Maximum upload size on your server currently is set to <b>:size</b>",values:{size:n==null?void 0:n.maxSize,b:e=>i("b",{children:e})}})})}function Ym(){const{watch:n,clearErrors:e}=_();return n("server.uploads_disk_driver")?g(se,{className:"mb-30",selectionMode:"single",name:"server.uploads_disk_driver",label:i(u,{message:"User Uploads Storage Method"}),description:i(u,{message:"Where should user private file uploads be stored."}),onSelectionChange:()=>{e()},children:[i(C,{value:"local",children:i(u,{message:"Local Disk (Default)"})}),i(C,{value:"ftp",children:"FTP"}),i(C,{value:"digitalocean_s3",children:"DigitalOcean Spaces"}),i(C,{value:"backblaze_s3",children:"Backblaze"}),i(C,{value:"s3",children:"Amazon S3 (Or compatible service)"}),i(C,{value:"dropbox",children:"Dropbox"}),i(C,{value:"rackspace",children:"Rackspace"})]}):null}function Xm(){const{watch:n,clearErrors:e}=_();return n("server.public_disk_driver")?g(se,{label:i(u,{message:"Public Uploads Storage Method"}),selectionMode:"single",name:"server.public_disk_driver",description:i(u,{message:"Where should user public uploads (like avatars) be stored."}),onSelectionChange:()=>{e()},children:[i(C,{value:"local",children:i(u,{message:"Local Disk (Default)"})}),i(C,{value:"s3",children:"Amazon S3"}),i(C,{value:"ftp",children:"FTP"}),i(C,{value:"digitalocean_s3",children:"DigitalOcean Spaces"}),i(C,{value:"backblaze_s3",children:"Backblaze"})]}):null}function Zm(){const{watch:n}=_(),e=[n("server.uploads_disk_driver"),n("server.public_disk_driver")];return e[0]==="local"&&e[1]==="local"?null:i(Le,{separatorBottom:!1,name:"storage_group",children:t=>{if(e.includes("s3"))return i(eg,{isInvalid:t});if(e.includes("ftp"))return i(rg,{isInvalid:t});if(e.includes("dropbox"))return i(Jm,{isInvalid:t});if(e.includes("digitalocean_s3"))return i(tg,{isInvalid:t});if(e.includes("backblaze_s3"))return i(ng,{isInvalid:t})}})}function eg({isInvalid:n}){return g(v.exports.Fragment,{children:[i(w,{invalid:n,className:"mb-30",name:"server.storage_s3_key",label:i(u,{message:"Amazon S3 key"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_s3_secret",label:i(u,{message:"Amazon S3 secret"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_s3_region",label:i(u,{message:"Amazon S3 region"}),pattern:"[a-z1-9\\-]+",placeholder:"us-east-1"}),i(w,{invalid:n,className:"mb-30",name:"server.storage_s3_bucket",label:i(u,{message:"Amazon S3 bucket"}),required:!0}),i(w,{invalid:n,name:"server.storage_s3_endpoint",label:i(u,{message:"Amazon S3 endpoint"}),description:i(u,{message:"Only change endpoint if you are using another S3 compatible storage service."})}),i(Xi,{invalid:n})]})}function tg({isInvalid:n}){return g(v.exports.Fragment,{children:[i(w,{invalid:n,className:"mb-30",name:"server.storage_digitalocean_key",label:i(u,{message:"DigitalOcean key"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_digitalocean_secret",label:i(u,{message:"DigitalOcean secret"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_digitalocean_region",label:i(u,{message:"DigitalOcean region"}),pattern:"[a-z0-9\\-]+",placeholder:"us-east-1",required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_digitalocean_bucket",label:i(u,{message:"DigitalOcean bucket"}),required:!0}),i(Xi,{invalid:n})]})}function ng({isInvalid:n}){return g(v.exports.Fragment,{children:[i(w,{invalid:n,className:"mb-30",name:"server.storage_backblaze_key",label:i(u,{message:"Backblaze KeyID"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_backblaze_secret",label:i(u,{message:"Backblaze applicationKey"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_backblaze_region",label:i(u,{message:"Backblaze Region"}),pattern:"[a-z0-9\\-]+",placeholder:"us-west-002",required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_backblaze_bucket",label:i(u,{message:"Backblaze bucket name"}),required:!0}),i(Xi,{invalid:n})]})}function Xi({invalid:n}){var s,a;const e=qm(),{data:t}=xr(),r=((s=t==null?void 0:t.server.uploads_disk_driver)==null?void 0:s.endsWith("s3"))||((a=t==null?void 0:t.server.public_disk_driver)==null?void 0:a.endsWith("s3"));return g(v.exports.Fragment,{children:[i(K,{className:"mt-30",invalid:n,name:"client.uploads.s3_direct_upload",description:g("div",{children:[i("p",{children:i(u,{message:"Upload files directly from the browser to s3 without going through the server. It will save on server bandwidth and should result in faster upload times. This should be enabled, unless storage provider does not support multipart uploads."})}),i("p",{className:"mt-10",children:i(u,{message:"If s3 provider is not configured to allow uploads from browser, this can be done automatically via CORS button below, when valid credentials are saved."})})]}),children:i(u,{message:"Direct upload"})}),i(E,{variant:"flat",color:"primary",size:"xs",className:"mt-20",onClick:()=>{e.mutate()},disabled:!r||e.isLoading,children:i(u,{message:"Configure CORS"})})]})}function rg({isInvalid:n}){return g(re,{children:[i(w,{invalid:n,className:"mb-30",name:"server.storage_ftp_host",label:i(u,{message:"FTP hostname"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_ftp_username",label:i(u,{message:"FTP username"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_ftp_password",label:i(u,{message:"FTP password"}),type:"password",required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.storage_ftp_root",label:i(u,{message:"FTP directory"}),placeholder:"/"}),i(w,{invalid:n,className:"mb-30",name:"server.storage_ftp_port",label:i(u,{message:"FTP port"}),type:"number",min:0,placeholder:"21"}),i(K,{invalid:n,name:"server.storage_ftp_passive",className:"mb-30",children:i(u,{message:"Passive"})}),i(K,{invalid:n,name:"server.storage_ftp_ssl",children:i(u,{message:"SSL"})})]})}function sg({isInvalid:n}){return g(v.exports.Fragment,{children:[i(w,{invalid:n,className:"mb-30",name:"server.mailgun_domain",label:i(u,{message:"Mailgun domain"}),description:i(u,{message:"Usually the domain of your site (site.com)"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.mailgun_secret",label:i(u,{message:"Mailgun API key"}),description:i(u,{message:"Should start with `key-`"}),required:!0}),i(w,{invalid:n,name:"server.mailgun_endpoint",label:i(u,{message:"Mailgun endpoint"}),description:i(u,{message:"Can be left empty, if your mailgun account is in the US region."}),placeholder:"api.eu.mailgun.net"})]})}function ig({isInvalid:n}){return g(re,{children:[i(w,{invalid:n,className:"mb-30",name:"server.mail_host",label:i(u,{message:"SMTP host"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.mail_username",label:i(u,{message:"SMTP username"}),required:!0}),i(w,{invalid:n,className:"mb-30",type:"password",name:"server.mail_password",label:i(u,{message:"SMTP password"}),required:!0}),i(w,{invalid:n,className:"mb-30",type:"number",name:"server.mail_port",label:i(u,{message:"SMTP port"})}),i(w,{invalid:n,className:"mb-30",name:"server.mail_encryption",label:i(u,{message:"SMTP encryption"})})]})}function ag({isInvalid:n}){return g(v.exports.Fragment,{children:[i(w,{invalid:n,className:"mb-30",name:"server.ses_key",label:i(u,{message:"SES key"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.ses_secret",label:i(u,{message:"SES secret"}),required:!0}),i(w,{invalid:n,name:"server.ses_region",label:i(u,{message:"SES region"}),placeholder:"us-east-1",required:!0})]})}function og({isInvalid:n}){return i(w,{invalid:n,name:"server.postmark_token",label:i(u,{message:"Postmark token"}),required:!0})}const Fa=U([i("path",{fill:"#4caf50",d:"M45,16.2l-5,2.75l-5,4.75L35,40h7c1.657,0,3-1.343,3-3V16.2z"},"0"),i("path",{fill:"#1e88e5",d:"M3,16.2l3.614,1.71L13,23.7V40H6c-1.657,0-3-1.343-3-3V16.2z"},"1"),i("polygon",{fill:"#e53935",points:"35,11.2 24,19.45 13,11.2 12,17 13,23.7 24,31.95 35,23.7 36,17"},"2"),i("path",{fill:"#c62828",d:"M3,12.298V16.2l10,7.5V11.2L9.876,8.859C9.132,8.301,8.228,8,7.298,8h0C4.924,8,3,9.924,3,12.298z"},"3"),i("path",{fill:"#fbc02d",d:"M45,12.298V16.2l-10,7.5V11.2l3.124-2.341C38.868,8.301,39.772,8,40.702,8h0 C43.076,8,45,9.924,45,12.298z"},"4")],"Gmail","0 0 48 48");function lg(){const{watch:n,setValue:e}=_(),{connectSocial:t}=Su(),r=n("server.connectedGmailAccount"),s=n("client.mail.handler")==="gmailApi",a=async()=>{const c=await t("secure/settings/mail/gmail/connect");if((c==null?void 0:c.status)==="SUCCESS"){const d=c.callbackData.profile.email;e("server.connectedGmailAccount",d),ne(S("Connected gmail account: :email",{values:{email:d}}))}},o=i(E,{variant:"outline",color:"primary",startIcon:i(Fa,{}),onClick:()=>{a()},children:i(u,{message:"Connect gmail account"})}),l=g("div",{className:"px-14 py-6 rounded bg-alt border flex items-center gap-14 text-sm",children:[i(Fa,{size:"lg"}),r,i(E,{variant:"text",color:"primary",className:"ml-auto",onClick:()=>{a()},children:i(u,{message:"Reconnect"})})]});return g(v.exports.Fragment,{children:[s&&i(w,{name:"client.gmail.incoming.topicName",minLength:10,required:!0,label:i(u,{message:"Gmail topic name"}),description:i(u,{message:"Google cloud Pub/Sub topic name."}),className:"mb-30"}),i("div",{className:"text-sm mb-12",children:i(u,{message:"Gmail account"})}),r?l:o]})}function cg(){const{watch:n,clearErrors:e}=_(),t=[n("server.mail_driver"),n("client.mail.handler")],r=[];return t.includes("mailgun")&&r.push(sg),t.includes("smtp")&&r.push(ig),t.includes("ses")&&r.push(ag),t.includes("postmark")&&r.push(og),t.includes("gmailApi")&&r.push(lg),i(Le,{separatorTop:!1,separatorBottom:!1,name:"mail_group",children:s=>g(v.exports.Fragment,{children:[g(se,{onSelectionChange:()=>{e()},invalid:s,selectionMode:"single",name:"server.mail_driver",label:i(u,{message:"Outgoing mail method"}),description:g("div",{children:[i(u,{message:"Which method should be used for sending outgoing application emails (like registration confirmation)"}),i(Sr,{className:"mt-8",link:"https://support.vebto.com/help-center/articles/42/44/155/incoming-emails"})]}),children:[i(C,{value:"mailgun",children:"Mailgun"}),i(C,{value:"gmailApi",children:"Gmail Api"}),i(C,{value:"smtp",children:"SMTP"}),i(C,{value:"postmark",children:"Postmark"}),i(C,{value:"ses",children:"Ses (Amazon Simple Email Service)"}),i(C,{value:"sendmail",children:"SendMail"}),i(C,{value:"log",children:"Log (Email will be saved to error log)"})]}),r.length?i("div",{className:"mt-30",children:r.map((a,o)=>i(a,{isInvalid:s},o))}):null]})})}function dg(){const{clearErrors:n}=_(),{settings:e}=v.exports.useContext(Vt);return e!=null&&e.showIncomingMailMethod?g(se,{onSelectionChange:()=>{n()},className:"my-30",selectionMode:"single",name:"client.mail_handler",label:i(u,{message:"Incoming mail method"}),description:g("div",{children:[i(u,{message:"Which method should be used to handle incoming application emails."}),i(Sr,{className:"mt-8",link:"https://support.vebto.com/help-center/articles/76/configuring-email-provider"})]}),children:[i(C,{value:"mailgun",children:"Mailgun"}),i(C,{value:"gmailApi",children:"Gmail Api"}),i(C,{value:"null",children:"Rest API (Send emails via http API)"}),i(C,{value:"pipe",children:"Pipe (Pipe emails directly)"})]}):null}function ug(){return g(Ue,{title:i(u,{message:"Mail settings"}),description:i(u,{message:"Change incoming and outgoing email handlers, email credentials and other related settings."}),children:[i(w,{id:"outgoing-emails",className:"mb-30",type:"email",name:"server.mail_from_address",label:i(u,{message:"From address"}),description:i(u,{message:"All outgoing application emails will be sent from this email address."}),required:!0}),i(hg,{}),i(w,{className:"mb-30",name:"server.mail_from_name",label:i(u,{message:"From name"}),description:i(u,{message:"All outgoing application emails will be sent using this name."}),required:!0}),i(sn,{color:"warning",description:i(u,{message:"Your selected mail method must be authorized to send emails using this address and name."})}),i(St,{}),i(dg,{}),i(cg,{})]})}function hg(){const{base_url:n}=Ye(),e=`${n}/contact`;return i(w,{className:"mb-30",type:"email",name:"client.mail.contact_page_address",label:i(u,{message:"Contact page address"}),description:i(u,{values:{contactPageUrl:i(as,{href:e,children:e})},message:"Where emails from :contactPageUrl page should be sent to."})})}function fg(){return q.post("cache/flush").then(n=>n.data)}function pg(){return te(()=>fg(),{onSuccess:()=>{ne(S("Cache cleared"))},onError:n=>Oe(n)})}function mg(){const n=pg();return g(Ue,{title:i(u,{message:"Cache settings"}),description:i(u,{message:"Select cache provider and manually clear cache."}),children:[i(gg,{}),i(E,{type:"button",variant:"outline",size:"xs",color:"primary",disabled:n.isLoading,onClick:()=>{n.mutate()},children:i(u,{message:"Clear cache"})}),i(sn,{color:"warning",className:"mt-30",description:i(u,{message:'"File" is the best option for most cases and should not be changed, unless you are familiar with another cache method and have it set up on the server already.'})})]})}function gg(){const{watch:n,clearErrors:e}=_(),t=n("server.cache_driver");let r=null;return t==="memcached"&&(r=bg),i(Le,{separatorTop:!1,name:"cache_group",children:s=>g(re,{children:[g(se,{invalid:s,onSelectionChange:()=>{e()},selectionMode:"single",name:"server.cache_driver",label:i(u,{message:"Cache method"}),description:i(u,{message:"Which method should be used for storing and retrieving cached items."}),children:[i(C,{value:"file",children:i(u,{message:"File (Default)"})}),i(C,{value:"array",children:i(u,{message:"None"})}),i(C,{value:"apc",children:"APC"}),i(C,{value:"memcached",children:"Memcached"}),i(C,{value:"redis",children:"Redis"})]}),r&&i("div",{className:"mt-30",children:i(r,{isInvalid:s})})]})})}function bg({isInvalid:n}){return g(re,{children:[i(w,{invalid:n,className:"mb-30",name:"server.memcached_host",label:i(u,{message:"Memcached host"}),required:!0}),i(w,{invalid:n,type:"number",name:"server.memcached_port",label:i(u,{message:"Memcached port"}),required:!0})]})}function yg(){return g(Ue,{title:i(u,{message:"Error logging"}),description:i(u,{message:"Configure site error logging and related 3rd party integrations."}),children:[i(vg,{}),i(sn,{className:"mt-30",color:"positive",description:i(u,{values:{a:n=>i(as,{href:"https://sentry.io",children:n})},message:"<a>Sentry</a> integration provides real-time error tracking and helps identify and fix issues when site is in production."})})]})}function vg(){const{clearErrors:n}=_();return i(Le,{separatorTop:!1,separatorBottom:!1,name:"logging_group",children:e=>i(w,{onChange:()=>{n()},invalid:e,name:"server.sentry_dsn",type:"url",minLength:30,required:!0,label:i(u,{message:"Sentry DSN"})})})}function xg(){return g(Ue,{title:i(u,{message:"Queue"}),description:i(u,{message:"Select active queue method and enter related 3rd party API keys."}),children:[i(sn,{color:"positive",className:"mb-30",description:i(u,{message:"Queues allow to defer time consuming tasks, such as sending an email, until a later time. Deferring these tasks can speed up web requests to the application."})}),i(sn,{color:"warning",className:"mb-30",description:i(u,{message:"All methods except sync require additional setup, which should be performed before changing the queue method. Consult documentation for more information."})}),i(Sg,{})]})}function Sg(){const{watch:n,clearErrors:e}=_(),t=n("server.queue_driver");let r=null;return t==="sqs"&&(r=kg),i(Le,{separatorTop:!1,separatorBottom:!1,name:"queue_group",children:s=>g(re,{children:[g(se,{invalid:s,onSelectionChange:()=>{e()},selectionMode:"single",name:"server.queue_driver",label:i(u,{message:"Queue method"}),required:!0,children:[i(C,{value:"sync",children:i(u,{message:"Sync (Default)"})}),i(C,{value:"beanstalkd",children:"Beanstalkd"}),i(C,{value:"database",children:i(u,{message:"Database"})}),i(C,{value:"sqs",children:i(u,{message:"SQS (Amazon simple queue service)"})}),i(C,{value:"redis",children:"Redis"})]}),r&&i("div",{className:"mt-30",children:i(r,{isInvalid:s})})]})})}function kg({isInvalid:n}){return g(re,{children:[i(w,{invalid:n,className:"mb-30",name:"server.sqs_queue_key",label:i(u,{message:"SQS queue key"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.sqs_queue_secret",label:i(u,{message:"SQS queue secret"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.sqs_queue_prefix",label:i(u,{message:"SQS queue prefix"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.sqs_queue_name",label:i(u,{message:"SQS queue name"}),required:!0}),i(w,{invalid:n,className:"mb-30",name:"server.sqs_queue_region",label:i(u,{message:"SQS queue region"}),required:!0})]})}function wg(){const{settings:n}=v.exports.useContext(Vt);return g(Ue,{title:i(u,{message:"Recaptcha"}),description:i(u,{message:"Configure google recaptcha integration and credentials."}),children:[(n==null?void 0:n.showRecaptchaLinkSwitch)&&i(K,{className:"mb-30",name:"client.recaptcha.enable.link_creation",description:i(u,{message:"Enable recaptcha integration when creating links from homepage or user dashboard."}),children:i(u,{message:"Link creation"})}),i(K,{className:"mb-30",name:"client.recaptcha.enable.contact",description:i(u,{message:'Enable recaptcha integration for "contact us" page.'}),children:i(u,{message:"Contact page"})}),i(K,{className:"mb-30",name:"client.recaptcha.enable.register",description:i(u,{message:"Enable recaptcha integration for registration page."}),children:i(u,{message:"Registration page"})}),i(Cg,{})]})}function Cg(){const{clearErrors:n}=_();return i(Le,{separatorTop:!1,separatorBottom:!1,name:"recaptcha_group",children:e=>g(re,{children:[i(w,{className:"mb-30",onChange:()=>{n()},invalid:e,name:"client.recaptcha.site_key",label:i(u,{message:"Recaptcha v3 site key"})}),i(w,{onChange:()=>{n()},invalid:e,name:"client.recaptcha.secret_key",label:i(u,{message:"Recaptcha v3 secret key"})})]})})}const Ng=Z.forwardRef((n,e)=>{const t=Go(e),{fieldProps:r,inputProps:s}=ku({...n,focusRef:t}),a=zi(n);return i(wu,{ref:e,fieldClassNames:a,...r,children:i("input",{type:"file",ref:t,...s,className:P(a.input,"py-8","file:bg-primary file:text-on-primary file:border-none file:rounded file:text-sm file:font-semibold file:px-10 file:h-24 file:mr-10")})})});function Mg({name:n,...e}){const{field:{onChange:t,onBlur:r,ref:s},fieldState:{invalid:a,error:o}}=Bn({name:n}),[l,c]=Z.useState(""),d={onChange:h=>{var f;t((f=h.target.files)==null?void 0:f[0]),c(h.target.value)},onBlur:r,value:l,invalid:a,errorMessage:o==null?void 0:o.message};return i(Ng,{ref:s,...hn(d,e)})}function Tg(){return i(Ue,{title:i(u,{message:"Analytics"}),description:i(u,{message:"Configure google analytics integration and credentials."}),children:i(Eg,{})})}function Eg(){const{clearErrors:n}=_();return i(Le,{separatorTop:!1,separatorBottom:!1,name:"analytics_group",children:e=>g(v.exports.Fragment,{children:[i(Mg,{className:"mb-30",onChange:()=>{n()},invalid:e,name:"files.certificate",accept:".json",label:i(u,{message:"Google service account key file (.json)"})}),i(w,{className:"mb-30",onChange:()=>{n()},invalid:e,name:"server.analytics_property_id",type:"number",label:i(u,{message:"Google analytics property ID"})}),i(w,{className:"mb-30",onChange:()=>{n()},invalid:e,name:"client.analytics.tracking_code",placeholder:"G-******",min:"1",max:"20",description:i(u,{message:"Google analytics measurement ID only, not the whole javascript snippet."}),label:i(u,{message:"Google tag manager measurement ID"})}),i(w,{name:"client.analytics.gchart_api_key",label:i(u,{message:"Google maps javascript API key"}),description:i(u,{message:"Only required in order to show world geochart on integrated analytics pages."})})]})})}function Og(n){const e=Fe();return te(t=>Ag(t),{onSuccess:(t,r)=>{ne(S("User updated")),G.invalidateQueries(["users"]),e("/admin/users")},onError:t=>He(t,n)})}function Ag({id:n,...e}){return e.roles&&(e.roles=e.roles.map(t=>t.id)),q.put(`users/${n}`,e).then(t=>t.data)}function hc(){const[n,e]=v.exports.useState(!1),t=v.exports.useRef(),r=v.exports.useCallback(s=>{var a;if(s){const o=new IntersectionObserver(([l])=>e(l.intersectionRatio<1),{threshold:[1]});t.current=o,o.observe(s)}else t.current&&((a=t.current)==null||a.disconnect())},[]);return{isSticky:n,sentinelRef:r}}function wr({onSubmit:n,form:e,title:t,children:r,actions:s,backButton:a,isLoading:o=!1,disableSaveWhenNotDirty:l=!1,wrapInContainer:c=!0}){const{isSticky:d,sentinelRef:h}=hc(),f=l?Object.keys(e.formState.dirtyFields).length:!0;return g(Ee,{onSubmit:n,onBeforeSubmit:()=>e.clearErrors(),form:e,children:[i("div",{ref:h}),i("div",{className:P("sticky top-0 my-12 md:my-24 z-10 transition-shadow",d&&"bg-paper shadow"),children:g("div",{className:P("flex items-center md:items-start gap-24 py-14",c&&"container mx-auto px-24"),children:[a,i("h1",{className:"text-xl md:text-3xl whitespace-nowrap overflow-hidden overflow-ellipsis md:mr-64",children:t}),i("div",{className:"mr-auto"}),s,i(E,{variant:"flat",color:"primary",type:"submit",disabled:o||!f,children:i(u,{message:"Save"})})]})}),i("div",{className:c?"container mx-auto px-24 pb-24":void 0,children:i("div",{className:"rounded",children:r})})]})}function fc({onSubmit:n,form:e,title:t,isLoading:r,avatarManager:s,resendEmailButton:a,children:o}){const{require_email_confirmation:l}=Ye(),{data:c}=st(["roles","permissions"]);return g(wr,{onSubmit:n,form:e,title:t,isLoading:r,children:[g("div",{className:"flex items-start gap-40 md:gap-80 mb-40",children:[s,g("div",{className:"flex-auto",children:[o,i(w,{className:"mb-30",name:"first_name",label:i(u,{message:"First name"})}),i(w,{name:"last_name",label:i(u,{message:"Last name"})})]})]}),g("div",{className:"border-t border-b mb-30 pb-30 pt-30",children:[i(K,{className:P(a&&"mb-30"),disabled:!l,name:"email_verified_at",description:i(u,{message:"Whether email address has been confirmed. User will not be able to login until address is confirmed, unless confirmation is disabled from settings page."}),children:i(u,{message:"Email confirmed"})}),a]}),i(tr,{className:"mb-30",name:"available_space",label:i(u,{message:"Allowed storage space"}),description:i(u,{values:{a:d=>i(le,{className:Bi,target:"_blank",to:"/admin/settings/uploading",children:d})},message:"Total storage space all user uploads are allowed to take up. If left empty, this value will be inherited from any roles or subscriptions user has, or from 'Available space' setting in <a>Uploading</a> settings page."})}),i(cs,{className:"mb-30",name:"roles",label:i(u,{message:"Roles"}),suggestions:c==null?void 0:c.roles,children:d=>i(C,{value:d.id,children:d.name},d.id)}),g("div",{className:"mt-30 pt-30 border-t",children:[i("div",{className:"text-sm mb-10",children:i(u,{message:"Permissions"})}),i(Qi,{name:"permissions"})]})]})}function Ig(){var c;const n=ae(),{require_email_confirmation:e}=Ye(),{userId:t}=qe(),r=Og(n),s=Cu(),{data:a,isLoading:o}=Nu(t,{with:["subscriptions","roles","permissions"]});if(v.exports.useEffect(()=>{(a==null?void 0:a.user)&&!n.getValues().id&&n.reset({first_name:a.user.first_name,last_name:a.user.last_name,roles:a.user.roles,permissions:a.user.permissions,id:a.user.id,email_verified_at:Boolean(a.user.email_verified_at),available_space:a.user.available_space,avatar:a.user.avatar})},[a==null?void 0:a.user,n]),o)return i(mn,{});const l=i(E,{size:"xs",variant:"outline",color:"primary",disabled:!e||s.isLoading||((c=a==null?void 0:a.user)==null?void 0:c.email_verified_at)!=null,onClick:()=>{s.mutate({email:a.user.email})},children:i(u,{message:"Resend email"})});return i(fc,{onSubmit:d=>{r.mutate(d)},form:n,title:i(u,{values:{email:a==null?void 0:a.user.email},message:"Edit \u201C:email\u201C"}),isLoading:r.isLoading,avatarManager:i(Dg,{user:a.user,onChange:()=>{G.invalidateQueries(["users"])}}),resendEmailButton:l,children:i(w,{className:"mb-30",name:"password",type:"password",label:i(u,{message:"New password"})})})}function Dg({user:n,onChange:e}){const t=Mu({user:n}),r=Tu({user:n});return i(br,{children:i(fn,{name:"avatar",diskPrefix:"avatars",variant:"avatar",stretchPreview:!0,label:i(u,{message:"Profile image"}),previewSize:"w-90 h-90",showRemoveButton:!0,onChange:s=>{s?t.mutate({url:s}):r.mutate(),e()}})})}function zg(n){const e=Fe();return te(t=>Pg(t),{onSuccess:()=>{ne(S("User created")),G.invalidateQueries(ce("users")),e("/admin/users")},onError:t=>He(t,n)})}function Pg(n){return n.roles&&(n.roles=n.roles.map(e=>e.id)),q.post("users",n).then(e=>e.data)}function Rg(){const n=ae(),e=zg(n),t=i(br,{children:i(fn,{name:"avatar",diskPrefix:"avatars",variant:"avatar",stretchPreview:!0,label:i(u,{message:"Profile image"}),previewSize:"w-90 h-90",showRemoveButton:!0})});return g(fc,{onSubmit:r=>{e.mutate(r)},form:n,title:i(u,{message:"Add new user"}),isLoading:e.isLoading,avatarManager:t,children:[i(w,{className:"mb-30",name:"email",type:"email",label:i(u,{message:"Email"})}),i(w,{className:"mb-30",name:"password",type:"password",label:i(u,{message:"Password"})})]})}const Fg=U(i("path",{d:"m12.87 15.07-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7 1.62-4.33L19.12 17h-3.24z"}),"TranslateOutlined"),pc=n=>{const e=["getLocaleWithLines"];return n!=null&&e.push(n),e};function Lg(n){return dn(pc(n),()=>_g(n),{staleTime:1/0})}function _g(n){return q.get(`localizations/${n}`).then(e=>e.data)}function Bg({id:n,...e}){return q.put(`localizations/${n}`,e).then(t=>t.data)}function mc(n){return te(e=>Bg(e),{onSuccess:()=>{ne(S("Localization updated")),G.invalidateQueries(ce("localizations")),G.invalidateQueries(pc())},onError:e=>n?He(e,n):Oe(e)})}function $g({localization:n}){const{trans:e}=Q(),{formId:t,close:r}=oe(),s=ae({defaultValues:{id:n.id,name:n.name,language:n.language}}),{data:a}=st(["languages"]),o=(a==null?void 0:a.languages)||[],l=mc(s);return g(ue,{children:[i(ve,{children:i(u,{message:"Update localization"})}),i(pe,{children:g(Ee,{form:s,id:t,onSubmit:c=>{l.mutate(c,{onSuccess:r})},children:[i(w,{name:"name",label:i(u,{message:"Name"}),className:"mb-30",required:!0}),i(se,{required:!0,name:"language",label:i(u,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:e(S("Search languages")),children:o.map(c=>i(C,{value:c.code,children:c.name},c.code))})]})}),g(ze,{children:[i(E,{onClick:r,children:i(u,{message:"Cancel"})}),i(E,{variant:"flat",color:"primary",type:"submit",form:t,disabled:l.isLoading,children:i(u,{message:"Save"})})]})]})}function Vg(n){return q.post("localizations",n).then(e=>e.data)}function Hg(n){return te(e=>Vg(e),{onSuccess:()=>{ne(S("Localization created")),G.invalidateQueries(ce("localizations"))},onError:e=>He(e,n)})}function qg(){const{trans:n}=Q(),{formId:e,close:t}=oe(),r=ae({defaultValues:{language:"en"}}),{data:s}=st(["languages"]),a=(s==null?void 0:s.languages)||[],o=Hg(r);return g(ue,{children:[i(ve,{children:i(u,{message:"Create localization"})}),i(pe,{children:g(Ee,{form:r,id:e,onSubmit:l=>{o.mutate(l,{onSuccess:t})},children:[i(w,{autoFocus:!0,name:"name",label:i(u,{message:"Name"}),className:"mb-30",required:!0}),i(se,{required:!0,name:"language",label:i(u,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:n(S("Search languages")),children:a.map(l=>i(C,{value:l.code,children:l.name},l.code))})]})}),g(ze,{children:[i(E,{onClick:t,children:i(u,{message:"Cancel"})}),i(E,{variant:"flat",color:"primary",type:"submit",form:e,disabled:o.isLoading,children:i(u,{message:"Save"})})]})]})}const Ug=""+new URL("around-the-world.df9b11c5.svg",import.meta.url).href,Wg=[{key:"name",allowsSorting:!0,sortingKey:"name",visibleInMode:"all",width:"flex-3 min-w-200",header:()=>i(u,{message:"Name"}),body:n=>n.name},{key:"language",allowsSorting:!0,sortingKey:"language",header:()=>i(u,{message:"Language code"}),body:n=>n.language},{key:"updatedAt",allowsSorting:!0,width:"w-100",header:()=>i(u,{message:"Last updated"}),body:n=>i(Ve,{date:n.updated_at})},{key:"actions",header:()=>i(u,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-84 flex-shrink-0",visibleInMode:"all",body:n=>g("div",{className:"text-muted",children:[i(le,{to:`${n.id}/translate`,children:i(pt,{label:i(u,{message:"Translate"}),children:i(R,{size:"md",children:i(Fg,{})})})}),g(W,{type:"modal",children:[i(pt,{label:i(u,{message:"Edit"}),children:i(R,{children:i(Ct,{})})}),i($g,{localization:n})]})]})}];function jg(){return i(qt,{endpoint:"localizations",title:i(u,{message:"Localizations"}),columns:Wg,actions:i(Jg,{}),selectedActions:i(gn,{}),emptyStateMessage:i(mt,{image:Ug,title:i(u,{message:"No localizations have been created yet"}),filteringTitle:i(u,{message:"No matching localizations"})})})}function Jg(){return i(v.exports.Fragment,{children:g(W,{type:"modal",children:[i(bn,{children:i(u,{message:"Add new localization"})}),i(qg,{})]})})}function Kg(){const{formId:n,close:e}=oe(),t=ae();return g(ue,{children:[i(ve,{children:i(u,{message:"Add translation"})}),i(pe,{children:g(Ee,{form:t,id:n,onSubmit:r=>{e(r)},children:[i(sn,{className:"mb-30",title:i(u,{message:"Add a new translation, if it does not exist already."}),description:i(u,{message:"This should only need to be done for things like custom menu items."})}),i(w,{inputElementType:"textarea",rows:2,autoFocus:!0,name:"key",label:i(u,{message:"Translation key"}),className:"mb-30",required:!0}),i(w,{inputElementType:"textarea",rows:2,name:"value",label:i(u,{message:"Translation value"}),required:!0})]})}),g(ze,{children:[i(E,{onClick:e,children:i(u,{message:"Cancel"})}),i(E,{variant:"flat",color:"primary",type:"submit",form:n,children:i(u,{message:"Add"})})]})]})}function Gg(){const{localeId:n}=qe(),{data:e,isLoading:t}=Lg(n),r=e==null?void 0:e.localization;return t||!r?i(mn,{}):i(Qg,{localization:r})}function Qg({localization:n}){const[e,t]=v.exports.useState(n.lines||{}),r=Fe(),s=mc(),[a,o]=v.exports.useState("");return g("form",{className:"p-14 md:p-24 flex flex-col h-full",onSubmit:l=>{l.preventDefault(),s.mutate({id:n.id,lines:e},{onSuccess:()=>{r("/admin/localizations")}})},children:[i(Yg,{localization:n,setLines:t,lines:e,searchQuery:a,setSearchQuery:o,isLoading:s.isLoading}),i(Xg,{lines:e,setLines:t,searchQuery:a})]})}function Yg({localization:n,searchQuery:e,setSearchQuery:t,isLoading:r,lines:s,setLines:a}){const o=Fe(),l=Xe(),{trans:c}=Q();return g("div",{className:"flex-shrink-0",children:[g(yh,{size:"lg",className:"mb-16",children:[i(wa,{onSelected:()=>{o("/admin/localizations")},children:i(u,{message:"Localizations"})}),i(wa,{children:i(u,{message:":locale translations",values:{locale:n.name}})})]}),g("div",{className:"mb-24 flex items-center gap-32 md:gap-12",children:[i("div",{className:"max-w-440 flex-auto",children:i(un,{value:e,onChange:d=>t(d.target.value),startAdornment:i(Ai,{}),placeholder:c({message:"Type to search..."})})}),g(W,{type:"modal",onClose:d=>{if(d){const h={...s};h[d.key]=d.value,a(h)}},children:[!l&&i(E,{className:"ml-auto",variant:"outline",color:"primary",startIcon:i(Qe,{}),children:i(u,{message:"Add new"})}),i(Kg,{})]}),i(E,{variant:"flat",color:"primary",type:"submit",disabled:r,children:l?i(u,{message:"Save"}):i(u,{message:"Save translations"})})]})]})}function Xg({searchQuery:n,lines:e,setLines:t}){const r=v.exports.useMemo(()=>Object.entries(e).filter(([o,l])=>{const c=n==null?void 0:n.toLowerCase();return!c||(o==null?void 0:o.toLowerCase().includes(c))||(l==null?void 0:l.toLowerCase().includes(c))}),[e,n]),s=v.exports.useRef(null),a=dh({count:r.length,getScrollElement:()=>s.current,estimateSize:()=>123});return i("div",{className:"flex-auto overflow-y-auto",ref:s,children:i("div",{className:"relative w-full",style:{height:`${a.getTotalSize()}px`},children:a.getVirtualItems().map(o=>{const[l,c]=r[o.index];return i("div",{className:"w-full absolute top-0 left-0",style:{height:`${o.size}px`,transform:`translateY(${o.start}px)`},children:g("div",{className:"rounded border mb-10 md:mr-10",children:[g("div",{className:"flex items-center gap-24 justify-between px-10 py-2 border-b",children:[i("label",{className:"text-xs font-semibold flex-auto",htmlFor:l,children:l}),i(R,{size:"xs",className:"text-muted",onClick:()=>{const d={...e};delete d[l],t(d)},children:i($t,{})})]}),i("div",{children:i("textarea",{id:l,name:l,defaultValue:c,className:"w-full bg-inherit block rounded resize-none outline-none focus-visible:ring-2 p-10 text-sm",rows:2,onChange:d=>{const h={...e};h[l]=d.target.value,t(h)}})})]})},l)})})})}function Zg(n){const{close:e}=oe(),{image:t,images:r}=n,[s,a]=mr(n.activeIndex,n.defaultActiveIndex,n.onActiveIndexChange),o=t||(r==null?void 0:r[s]);return i(ue,{size:"fullscreenTakeover",background:"bg-black/80",children:g(pe,{padding:"p-0",className:"w-full h-full",children:[i(R,{size:"lg",color:"paper",className:"absolute top-0 right-0 text-white z-20",onClick:()=>{e()},children:i($t,{})}),g("div",{className:"relative p-40 flex items-center justify-center w-full h-full",children:[r!=null&&r.length?i(R,{size:"lg",color:"white",variant:"flat",className:"absolute my-auto top-0 bottom-0 left-20",radius:"rounded",disabled:s<1,onClick:()=>{a(s-1)},children:i(Hi,{})}):null,i("img",{src:o,alt:"",className:"max-h-full w-auto shadow object-contain"}),r!=null&&r.length?i(R,{size:"lg",color:"white",variant:"flat",className:"absolute my-auto top-0 bottom-0 right-20",radius:"rounded",disabled:s+1===(r==null?void 0:r.length),onClick:()=>{a(s+1)},children:i(ls,{})}):null]})]})})}function eb(){var e;const n=xr();return g("div",{className:"container mx-auto p-12 md:p-24",children:[i(ss,{children:i(u,{message:"Ads"})}),i("h1",{className:"font-light text-2xl md:text-3xl mb-20 md:mb-40",children:i(u,{message:"Predefined Ad slots"})}),n.isLoading?i(is,{isIndeterminate:!0}):i(tb,{defaultValues:((e=n.data)==null?void 0:e.client.ads)||{}})]})}function tb({defaultValues:n}){const{admin:{ads:e}}=v.exports.useContext(Vt),t=ae({defaultValues:{client:{ads:n}}}),r=lc(t);return g(Ee,{form:t,onSubmit:s=>{r.mutate(s)},children:[e.map(s=>i(nb,{adConfig:s},s.slot)),i(K,{name:"client.ads.disable",className:"mb-30",description:i(u,{message:"Disable all add related functionality across the site."}),children:i(u,{message:"Disable ads"})}),i(E,{type:"submit",variant:"flat",color:"primary",disabled:r.isLoading,children:i(u,{message:"Save"})})]})}function nb({adConfig:n}){const e=Xe();return g("div",{className:"flex items-center gap-24",children:[i(w,{className:"mb-30 flex-auto",name:`client.${n.slot}`,inputElementType:"textarea",rows:8,label:i(u,{...n.description})}),!e&&g(W,{type:"modal",children:[i("button",{type:"button",className:"outline-none focus-visible:ring cursor-zoom-in rounded overflow-hidden hover:scale-105 transition",children:i("img",{src:n.image,className:"w-auto h-[186px] border",alt:"Ad slot example"})}),i(Zg,{image:n.image})]})]})}function rb(){const n=vn(t=>{var r;return(r=t.config)==null?void 0:r.sections}),e=v.exports.useMemo(()=>n?Object.entries(n||[]).map(([t,r])=>({...r,key:t})).sort((t,r)=>((t==null?void 0:t.position)||1)-((r==null?void 0:r.position)||1)):[],[n]);return i(v.exports.Fragment,{children:e.map(t=>i(ht,{to:t.key,elementType:_i,children:i(u,{...t.label})},t.key))})}const sb=[{key:"type",label:S("Type"),description:S("Type of the role"),defaultOperator:Se.ne,control:{type:Me.Select,defaultValue:"01",options:[{key:"01",label:S("Sitewide"),value:"sitewide"},{key:"02",label:S("Workspace"),value:"workspace"}]}},$n({description:S("Date role was created")}),Vn({description:S("Date role was last updated")})],ib=[{key:"name",allowsSorting:!0,visibleInMode:"all",header:()=>i(u,{message:"Role"}),body:n=>g("div",{children:[i("div",{children:i(u,{message:n.name})}),i("div",{className:"text-muted text-xs overflow-x-hidden overflow-ellipsis",children:n.description?i(u,{message:n.description}):void 0})]})},{key:"type",maxWidth:"max-w-100",allowsSorting:!0,header:()=>i(u,{message:"Type"}),body:n=>i(u,{message:n.type})},{key:"updated_at",maxWidth:"max-w-100",allowsSorting:!0,header:()=>i(u,{message:"Last updated"}),body:n=>i(Ve,{date:n.updated_at})},{key:"actions",header:()=>i(u,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-42 flex-shrink-0",body:n=>i(le,{to:`${n.id}/edit`,children:i(R,{size:"md",className:"text-muted",children:i(Ct,{})})})}];function ab(){return i(qt,{endpoint:"roles",title:i(u,{message:"Roles"}),columns:ib,filters:sb,actions:i(ob,{}),selectedActions:i(gn,{}),emptyStateMessage:i(mt,{image:lr,title:i(u,{message:"No roles have been created yet"}),filteringTitle:i(u,{message:"No matching roles"})})})}function ob(){return g(v.exports.Fragment,{children:[i(hl,{endpoint:"roles/csv/export"}),i(bn,{elementType:le,to:"new",children:i(u,{message:"Add new role"})})]})}const gc=n=>`roles/${n}`;function lb(n){return q.get(gc(n)).then(e=>e.data)}function cb(){const{roleId:n}=qe();return dn([gc(n)],()=>lb(n))}const bc=n=>`roles/${n}`;function db(){const{trans:n}=Q(),e=Fe();return te(t=>ub(t),{onSuccess:t=>{ne(n(S("Role updated"))),G.invalidateQueries([bc(t.role.id)]),G.invalidateQueries(ce("roles")),e("/admin/roles")},onError:t=>Oe(t)})}function ub({id:n,...e}){return q.put(bc(n),e).then(t=>t.data)}function yc({isInternal:n=!1}){const{trans:e}=Q(),{workspaces:t}=Ye(),{watch:r}=_(),s=r("type");return g(re,{children:[i(w,{label:i(u,{message:"Name"}),name:"name",className:"mb-20",required:!0}),i(w,{label:i(u,{message:"Description"}),name:"description",inputElementType:"textarea",placeholder:e(S("Role description...")),rows:4,className:"mb-20"}),t.integrated&&g(se,{label:i(u,{message:"Type"}),name:"type",selectionMode:"single",className:"mb-20",description:i(u,{message:"Whether this role will be assigned to users globally on the site or only within workspaces."}),children:[i(C,{value:"sitewide",children:i(u,{message:"Sitewide"})}),i(C,{value:"workspace",children:i(u,{message:"Workspace"})})]}),!n&&g(re,{children:[i(K,{name:"default",className:"mb-20",description:i(u,{message:"Assign this role to new users automatically."}),children:i(u,{message:"Default"})}),s==="sitewide"&&i(K,{name:"guests",description:i(u,{message:"Assign this role to guests (not logged in users)."}),children:i(u,{message:"Guests"})})]}),i("h2",{className:"mb-10 mt-30 text-lg",children:i(u,{message:"Permissions"})}),i(Qi,{name:"permissions",valueListKey:s==="sitewide"?"permissions":"workspacePermissions"})]})}function hb({onUserSelected:n}){var d;const{close:e}=oe(),[t,r]=v.exports.useState(""),{trans:s}=Q(),a=uh(Ui,{query:t,perPage:14}),o=((d=a.data)==null?void 0:d.results)||[],l=i(Ii,{className:"pt-20",size:"sm",title:i(u,{message:"No matching users"}),description:i(u,{message:"Try another search query"}),image:i(Di,{src:lr})}),c=h=>{e(),n(h)};return g(ue,{children:[i(ve,{children:i(u,{message:"Select a user"})}),g(pe,{children:[i(un,{autoFocus:!0,className:"mb-20",startAdornment:i(Ai,{}),placeholder:s(S("Search for user by name or email")),value:t,onChange:h=>{r(h.target.value)}}),!a.isLoading&&!o.length&&l,i("div",{className:"grid grid-cols-2 gap-x-10",children:o.map(h=>i(fb,{user:h,onUserSelected:c},h.id))})]})]})}function fb({user:n,onUserSelected:e}){return g("div",{className:"flex items-center gap-10 outline-none focus-visible:ring ring-offset-4 hover:bg-hover p-10 rounded",role:"button",tabIndex:0,onClick:()=>{e(n)},onKeyDown:t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(n))},children:[i(al,{src:n.image}),g("div",{className:"overflow-hidden",children:[i("div",{className:"text-ellipsis overflow-hidden",children:n.name}),i("div",{className:"text-muted text-ellipsis overflow-hidden",children:n.description})]})]},n.id)}function pb(n){return te(({userIds:e})=>mb({userIds:e,roleId:n.id}),{onSuccess:(e,t)=>{ne(S("Removed [one 1 user|other :count users] from \u201C{role}\u201C",{values:{count:t.userIds.length,role:n.name}}))},onError:e=>Oe(e)})}function mb({roleId:n,userIds:e}){return q.post(`roles/${n}/remove-users`,{userIds:e}).then(t=>t.data)}function gb(n){return te(({userIds:e})=>bb({userIds:e,roleId:n.id}),{onSuccess:(e,t)=>{ne(S("Assigned [one 1 user|other :count users] to {role}",{values:{count:t.userIds.length,role:n.name}}))},onError:e=>Oe(e)})}function bb({roleId:n,userIds:e}){return q.post(`roles/${n}/add-users`,{userIds:e}).then(t=>t.data)}const vc={key:"name",allowsSorting:!0,sortingKey:"email",header:()=>i(u,{message:"User"}),body:n=>i(Hn,{image:n.avatar,label:n.display_name,description:n.email}),width:"col-w-3"},yb=[vc,{key:"first_name",allowsSorting:!0,header:()=>i(u,{message:"First name"}),body:n=>n.first_name},{key:"last_name",allowsSorting:!0,header:()=>i(u,{message:"Last name"}),body:n=>n.last_name},{key:"created_at",allowsSorting:!0,header:()=>i(u,{message:"Assigned at"}),body:n=>i(Ve,{date:n.created_at})}],vb=[vc];function xb({role:n}){const e=Xe();return n.guests||n.type==="workspace"?i("div",{className:"pt-30 pb-10",children:i(mt,{image:lr,title:i(u,{message:"Users can't be assigned to this role"})})}):i(ul,{endpoint:"users",columns:e?vb:yb,queryParams:{roleId:`${n.id}`},actions:i(Sb,{role:n}),selectedActions:i(kb,{role:n}),emptyStateMessage:i(mt,{image:lr,title:i(u,{message:"No users have been assigned to this role yet"}),filteringTitle:i(u,{message:"No matching users"})})})}function Sb({role:n}){const e=gb(n);return g(W,{type:"modal",children:[i(E,{variant:"flat",color:"primary",disabled:e.isLoading,children:i(u,{message:"Assign user"})}),i(hb,{onUserSelected:t=>{e.mutate({userIds:[t.id]},{onSuccess:()=>{G.invalidateQueries(ce("users",{roleId:`${n.id}`}))}})}})]})}function kb({role:n}){const e=pb(n),{selectedRows:t}=ji();return g(W,{type:"modal",onClose:r=>{r&&e.mutate({userIds:t},{onSuccess:()=>{G.invalidateQueries(ce("users",{roleId:`${n.id}`}))}})},children:[i(E,{variant:"flat",color:"danger",disabled:e.isLoading,children:i(u,{message:"Remove users"})}),i(bt,{title:i(u,{message:"Remove [one 1 user|other :count users] from \u201C:name\u201C role?",values:{count:t.length,name:n.name}}),body:i(u,{message:"This will permanently remove the users."}),confirm:i(u,{message:"Remove"}),isDanger:!0})]})}function wb(){const n=cb();return n.status!=="success"?i(mn,{}):i(Cb,{role:n.data.role})}function Cb({role:n}){const e=ae({defaultValues:n}),t=db();return i(wr,{form:e,onSubmit:r=>{t.mutate(r)},title:i(u,{message:"Edit \u201C:name\u201C role",values:{name:n.name}}),isLoading:t.isLoading,children:g(cc,{isLazy:!0,children:[g(dc,{children:[i($r,{children:i(u,{message:"Settings"})}),i($r,{children:i(u,{message:"Users"})})]}),g(uc,{className:"pt-20",children:[i(Vr,{children:i(yc,{isInternal:n.internal})}),i(Vr,{children:i(xb,{role:n})})]})]})})}const Nb="roles";function Mb(n){const{trans:e}=Q();return te(t=>Tb(t),{onSuccess:()=>{ne(e(S("Created new role"))),G.invalidateQueries(ce("roles"))},onError:t=>He(t,n)})}function Tb({id:n,...e}){return q.post(Nb,e).then(t=>t.data)}function Eb(){const n=ae({defaultValues:{type:"sitewide"}}),e=Mb(n),t=Fe();return i(wr,{form:n,onSubmit:r=>{e.mutate(r,{onSuccess:s=>{t(`/admin/roles/${s.role.id}/edit`)}})},title:i(u,{message:"Add new role"}),isLoading:e.isLoading,children:i(yc,{})})}const Ob=n=>[{key:"type",label:S("Type"),description:S("Type of the tag"),defaultOperator:Se.ne,control:{type:Me.Select,defaultValue:n[0].name,options:n.map(e=>({key:e.name,label:S(e.name),value:e.name}))}},$n({description:S("Date tag was created")}),Vn({description:S("Date tag was last updated")})],xc=""+new URL("software-engineer.ba026106.svg",import.meta.url).href;function Sc({form:n,onSubmit:e,formId:t}){const{tags:{types:r}}=v.exports.useContext(Vt),s=n.watch("type"),a=!!r.find(o=>o.name===s&&o.system);return g(Ee,{id:t,form:n,onSubmit:e,children:[i(w,{name:"name",label:i(u,{message:"Name"}),description:i(u,{message:"Unique tag identifier."}),className:"mb-20",required:!0,autoFocus:!0}),i(w,{name:"display_name",label:i(u,{message:"Display name"}),description:i(u,{message:"User friendly tag name."}),className:"mb-20"}),i(se,{name:"type",selectionMode:"single",disabled:a,children:r.filter(o=>!o.system).map(o=>i(C,{value:o.name,children:i(u,{message:o.name})},o.name))})]})}function Ab(n){const{trans:e}=Q();return te(t=>Ib(t),{onSuccess:()=>{ne(e(S("Tag created"))),G.invalidateQueries(ce("tags"))},onError:t=>He(t,n)})}function Ib(n){return q.post("tags",n).then(e=>e.data)}function Db(){const{close:n,formId:e}=oe(),{tags:{types:t}}=v.exports.useContext(Vt),r=ae({defaultValues:{type:t[0].name}}),s=Ab(r);return g(ue,{children:[i(ve,{children:i(u,{message:"Add new tag"})}),i(pe,{children:i(Sc,{formId:e,form:r,onSubmit:a=>{s.mutate(a,{onSuccess:()=>{n()}})}})}),g(ze,{children:[i(E,{onClick:()=>{n()},children:i(u,{message:"Cancel"})}),i(E,{form:e,disabled:s.isLoading,variant:"flat",color:"primary",type:"submit",children:i(u,{message:"Save"})})]})]})}function zb(n){const{trans:e}=Q();return te(t=>Pb(t),{onSuccess:()=>{ne(e(S("Tag updated"))),G.invalidateQueries(ce("tags"))},onError:t=>He(t,n)})}function Pb({id:n,...e}){return q.put(`tags/${n}`,e).then(t=>t.data)}function Rb({tag:n}){const{close:e,formId:t}=oe(),r=ae({defaultValues:{id:n.id,name:n.name,display_name:n.display_name,type:n.type}}),s=zb(r);return g(ue,{children:[i(ve,{children:i(u,{message:"Update \u201C:name\u201C tag",values:{name:n.name}})}),i(pe,{children:i(Sc,{formId:t,form:r,onSubmit:a=>{s.mutate(a,{onSuccess:()=>{e()}})}})}),g(ze,{children:[i(E,{onClick:()=>{e()},children:i(u,{message:"Cancel"})}),i(E,{form:t,disabled:s.isLoading,variant:"flat",color:"primary",type:"submit",children:i(u,{message:"Save"})})]})]})}const Fb=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>i(u,{message:"Name"}),body:n=>n.name},{key:"type",allowsSorting:!0,header:()=>i(u,{message:"Type"}),body:n=>n.type},{key:"display_name",allowsSorting:!0,header:()=>i(u,{message:"Display name"}),body:n=>n.display_name},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>i(u,{message:"Last updated"}),body:n=>i(Ve,{date:n.updated_at})},{key:"actions",header:()=>i(u,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:n=>g(W,{type:"modal",children:[i(R,{size:"md",className:"text-muted",children:i(Ct,{})}),i(Rb,{tag:n})]})}];function Lb(){const{tags:n}=v.exports.useContext(Vt),e=v.exports.useMemo(()=>Ob(n.types),[n.types]);return i(qt,{endpoint:"tags",title:i(u,{message:"Tags"}),columns:Fb,filters:e,actions:i(_b,{}),selectedActions:i(gn,{}),emptyStateMessage:i(mt,{image:xc,title:i(u,{message:"No tags have been created yet"}),filteringTitle:i(u,{message:"No matching tags"})})})}function _b(){return i(re,{children:g(W,{type:"modal",children:[i(bn,{children:i(u,{message:"Add new tag"})}),i(Db,{})]})})}const Bb=v.exports.memo(({bytes:n})=>i(v.exports.Fragment,{children:sl(n)})),$b=U(i("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7z"}),"VisibilityOutlined"),Vb=""+new URL("upload.cabfc914.svg",import.meta.url).href,Hb=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>i(u,{message:"Name"}),body:n=>g(v.exports.Fragment,{children:[i("div",{className:"overflow-x-hidden overflow-ellipsis",children:n.name}),i("div",{className:"text-muted text-xs overflow-x-hidden overflow-ellipsis",children:n.file_name})]})},{key:"owner_id",allowsSorting:!0,width:"flex-3 min-w-200",header:()=>i(u,{message:"Uploader"}),body:n=>{var t;const e=(t=n.users)==null?void 0:t[0];return e?i(Hn,{image:e.avatar,label:e.display_name,description:e.email}):null}},{key:"type",width:"w-100 flex-shrink-0",allowsSorting:!0,header:()=>i(u,{message:"Type"}),body:n=>g("div",{className:"flex items-center gap-12",children:[i(Eu,{type:n.type,className:"w-24 h-24 overflow-hidden"}),i("div",{className:"capitalize",children:n.type})]})},{key:"public",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>i(u,{message:"Public"}),body:n=>n.public?i(Jo,{className:"icon-md text-positive"}):i($t,{className:"icon-md text-danger"})},{key:"file_size",allowsSorting:!0,maxWidth:"max-w-100",header:()=>i(u,{message:"File size"}),body:n=>i(Bb,{bytes:n.file_size})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>i(u,{message:"Last updated"}),body:n=>i(Ve,{date:n.updated_at})},{key:"actions",header:()=>i(u,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:n=>g(W,{type:"modal",children:[i(R,{size:"md",className:"text-muted",children:i($b,{})}),i(fh,{entries:[n]})]})}];function qb(){return i(qt,{endpoint:"file-entries",title:i(u,{message:"Uploaded files and folders"}),columns:Hb,filters:hh,selectedActions:i(gn,{}),emptyStateMessage:i(mt,{image:Vb,title:i(u,{message:"Nothing has been uploaded yet"}),filteringTitle:i(u,{message:"No matching files or folders"})})})}const Ub=[{key:"ends_at",label:S("Status"),description:S("Whether subscription is active or cancelled"),defaultOperator:Se.eq,control:{type:Me.Select,defaultValue:"active",options:[{key:"active",label:S("Active"),value:{value:null,operator:Se.eq}},{key:"cancelled",label:S("Cancelled"),value:{value:null,operator:Se.ne}}]}},{control:{type:Me.Select,defaultValue:"stripe",options:[{key:"stripe",label:S("Stripe"),value:"stripe"},{key:"paypal",label:S("PayPal"),value:"paypal"},{key:"none",label:S("None"),value:"none"}]},key:"gateway_name",label:S("Gateway"),description:S("With which payment provider was subscription created"),defaultOperator:Se.eq},ph({key:"renews_at",label:S("Renew date"),description:S("Date subscription will renew")}),$n({description:S("Date subscription was created")}),Vn({description:S("Date subscription was last updated")})],Wb=""+new URL("subscriptions.7eacea42.svg",import.meta.url).href;function jb(n){const{trans:e}=Q();return te(t=>Jb(t),{onSuccess:()=>{ne(e(S("Subscription updated"))),G.invalidateQueries(ce("billing/subscriptions"))},onError:t=>He(t,n)})}function Jb({id:n,...e}){return q.put(`billing/subscriptions/${n}`,e).then(t=>t.data)}function kc({form:n,onSubmit:e,formId:t}){var o,l;const r=Ou(),s=n.watch("product_id"),a=(o=r.data)==null?void 0:o.products.find(c=>c.id===s);return g(Ee,{id:t,form:n,onSubmit:e,children:[i(mh,{name:"user_id",className:"mb-20",modelType:Ui,label:i(u,{message:"User"}),openMenuOnFocus:!0}),i(se,{name:"product_id",selectionMode:"single",className:"mb-20",label:i(u,{message:"Plan"}),children:(l=r.data)==null?void 0:l.products.filter(c=>!c.free).map(c=>i(C,{value:c.id,children:i(u,{message:c.name})},c.id))}),!(a!=null&&a.free)&&i(se,{name:"price_id",selectionMode:"single",className:"mb-20",label:i(u,{message:"Price"}),children:a==null?void 0:a.prices.map(c=>i(C,{value:c.id,children:i(Vi,{price:c})},c.id))}),i(w,{inputElementType:"textarea",rows:3,name:"description",label:i(u,{message:"Description"}),className:"mb-20"}),i(ti,{className:"mb-20",name:"renews_at",granularity:"day",label:i(u,{message:"Renews at"}),description:i(u,{message:"This will only change local records. User will continue to be billed on their original cycle on the payment gateway."})}),i(ti,{className:"mb-20",name:"ends_at",granularity:"day",label:i(u,{message:"Ends at"}),description:i(u,{message:"This will only change local records. User will continue to be billed on their original cycle on the payment gateway."})})]})}function Kb({subscription:n}){const{close:e,formId:t}=oe(),r=ae({defaultValues:{id:n.id,product_id:n.product_id,price_id:n.price_id,description:n.description,renews_at:n.renews_at,ends_at:n.ends_at,user_id:n.user_id}}),s=jb(r);return g(ue,{size:"md",children:[i(ve,{children:i(u,{message:"Update subscription"})}),i(pe,{children:i(kc,{formId:t,form:r,onSubmit:a=>{s.mutate(a,{onSuccess:()=>{e()}})}})}),g(ze,{children:[i(E,{onClick:()=>{e()},children:i(u,{message:"Cancel"})}),i(E,{form:t,disabled:s.isLoading,variant:"flat",color:"primary",type:"submit",children:i(u,{message:"Save"})})]})]})}const wc="billing/subscriptions";function Gb(n){const{trans:e}=Q();return te(t=>Qb(t),{onSuccess:()=>{ne(e(S("Subscription created"))),G.invalidateQueries(ce(wc))},onError:t=>He(t,n)})}function Qb(n){return q.post(wc,n).then(e=>e.data)}function Yb(){const{close:n,formId:e}=oe(),t=ae({}),r=Gb(t);return g(ue,{children:[i(ve,{children:i(u,{message:"Add new subscription"})}),i(pe,{children:i(kc,{formId:e,form:t,onSubmit:s=>{r.mutate(s,{onSuccess:()=>{n()}})}})}),g(ze,{children:[i(E,{onClick:()=>{n()},children:i(u,{message:"Cancel"})}),i(E,{form:e,disabled:r.isLoading,variant:"flat",color:"primary",type:"submit",children:i(u,{message:"Save"})})]})]})}const Xb=U(i("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}),"PauseOutlined"),Zb=U(i("path",{d:"M10 8.64 15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z"}),"PlayArrowOutlined"),hs="billing/subscriptions",ey=[{key:"usr_id",allowsSorting:!0,width:"flex-3 min-w-200",visibleInMode:"all",header:()=>i(u,{message:"Customer"}),body:n=>i(Hn,{image:n.user.avatar,label:n.user.display_name,description:n.user.email})},{key:"status",width:"w-100 flex-shrink-0",header:()=>i(u,{message:"Status"}),body:n=>n.valid?i(ei,{size:"xs",color:"positive",radius:"rounded",className:"w-max",children:i(u,{message:"Active"})}):i(ei,{size:"xs",radius:"rounded",className:"w-max",children:i(u,{message:"Cancelled"})})},{key:"product_id",allowsSorting:!0,header:()=>i(u,{message:"Plan"}),body:n=>{var e;return(e=n.product)==null?void 0:e.name}},{key:"gateway",allowsSorting:!0,header:()=>i(u,{message:"Gateway"}),body:n=>i("span",{className:"capitalize",children:n.gateway_name})},{key:"renews_at",allowsSorting:!0,header:()=>i(u,{message:"Renews at"}),body:n=>i(Ve,{date:n.renews_at})},{key:"ends_at",allowsSorting:!0,header:()=>i(u,{message:"Ends at"}),body:n=>i(Ve,{date:n.ends_at})},{key:"created_at",allowsSorting:!0,header:()=>i(u,{message:"Created at"}),body:n=>i(Ve,{date:n.created_at})},{key:"actions",header:()=>i(u,{message:"Actions"}),hideHeader:!0,align:"end",visibleInMode:"all",width:"w-128 flex-shrink-0",body:n=>i(ry,{subscription:n})}];function ty(){return i(qt,{endpoint:hs,title:i(u,{message:"Subscriptions"}),columns:ey,filters:Ub,actions:i(ny,{}),enableSelection:!1,selectedActions:i(gn,{}),queryParams:{with:"product"},emptyStateMessage:i(mt,{image:Wb,title:i(u,{message:"No subscriptions have been created yet"}),filteringTitle:i(u,{message:"No matching subscriptions"})})})}function ny(){return i(re,{children:g(W,{type:"modal",children:[i(bn,{children:i(u,{message:"Add new subscription"})}),i(Yb,{})]})})}function ry({subscription:n}){return g(v.exports.Fragment,{children:[g(W,{type:"modal",children:[i(R,{size:"md",className:"text-muted",children:i(Ct,{})}),i(Kb,{subscription:n})]}),n.cancelled?i(iy,{subscription:n}):i(sy,{subscription:n}),i(ay,{subscription:n})]})}function sy({subscription:n}){const e=ll(),t=()=>{e.mutate({subscriptionId:n.id},{onSuccess:()=>{G.invalidateQueries(ce(hs))}})};return g(W,{type:"modal",onClose:r=>{r&&t()},children:[i(pt,{label:i(u,{message:"Cancel subscription"}),children:i(R,{size:"md",className:"text-muted",disabled:e.isLoading,children:i(Xb,{})})}),i(bt,{title:i(u,{message:"Cancel subscription"}),body:g("div",{children:[i(u,{message:"Are you sure you want to cancel this subscription?"}),i("div",{className:"font-semibold text-sm mt-10",children:i(u,{message:"This will put user on grace period until their next scheduled renewal date. Subscription can be renewed until that date by user or from admin area."})})]}),confirm:i(u,{message:"Confirm"})})]})}function iy({subscription:n}){const e=vh(),t=()=>{e.mutate({subscriptionId:n.id},{onSuccess:()=>{G.invalidateQueries(ce(hs))}})};return g(W,{type:"modal",onClose:r=>{r&&t()},children:[i(pt,{label:i(u,{message:"Renew subscription"}),children:i(R,{size:"md",className:"text-muted",onClick:t,disabled:e.isLoading,children:i(Zb,{})})}),i(bt,{title:i(u,{message:"Resume subscription"}),body:g("div",{children:[i(u,{message:"Are you sure you want to resume this subscription?"}),i("div",{className:"font-semibold text-sm mt-10",children:i(u,{message:"This will put user on their original plan and billing cycle."})})]}),confirm:i(u,{message:"Confirm"})})]})}function ay({subscription:n}){const e=ll(),t=()=>{e.mutate({subscriptionId:n.id,delete:!0},{onSuccess:()=>{G.invalidateQueries(ce(hs))}})};return g(W,{type:"modal",onClose:r=>{r&&t()},children:[i(pt,{label:i(u,{message:"Delete subscription"}),children:i(R,{size:"md",className:"text-muted",disabled:e.isLoading,children:i($t,{})})}),i(bt,{isDanger:!0,title:i(u,{message:"Delete subscription"}),body:g("div",{children:[i(u,{message:"Are you sure you want to delete this subscription?"}),i("div",{className:"font-semibold text-sm mt-10",children:i(u,{message:"This will permanently delete the subscription and immediately cancel it on billing gateway. Subscription will not be renewable anymore."})})]}),confirm:i(u,{message:"Confirm"})})]})}const oy=U(i("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}),"SyncOutlined");function ly(){const{trans:n}=Q();return te(()=>cy(),{onSuccess:()=>{ne(n(S("Plans synced")))},onError:e=>Oe(e,S("Could not sync plans"))})}function cy(){return q.post("billing/products/sync").then(n=>n.data)}const dy=n=>`billing/products/${n}`;function uy(){const{trans:n}=Q();return te(e=>hy(e),{onSuccess:()=>{ne(n(S("Plan deleted"))),G.invalidateQueries(ce("billing/products"))},onError:e=>Oe(e)})}function hy({productId:n}){return q.delete(dy(n)).then(e=>e.data)}const fy=[{key:"subscriptions",label:S("Subscriptions"),description:S("Whether plan has any active subscriptions"),defaultOperator:Se.eq,control:{type:Me.Select,defaultValue:"01",options:[{key:"01",label:S("Has active subscriptions"),value:{value:"*",operator:Se.has}},{key:"02",label:S("Does not have active subscriptions"),value:{value:"*",operator:Se.doesntHave}}]}},$n({description:S("Date plan was created")}),Vn({description:S("Date plan was last updated")})],py=[{key:"name",allowsSorting:!0,visibleInMode:"all",header:()=>i(u,{message:"Name"}),body:n=>{const e=n.prices[0];return i(Hn,{label:n.name,description:n.free?i(u,{message:"Free"}):i(Vi,{price:e})})}},{key:"created_at",allowsSorting:!0,maxWidth:"max-w-100",header:()=>i(u,{message:"Created"}),body:n=>i(Ve,{date:n.created_at})},{key:"updated_at",allowsSorting:!0,maxWidth:"max-w-100",header:()=>i(u,{message:"Last updated"}),body:n=>i(Ve,{date:n.updated_at})},{key:"actions",header:()=>i(u,{message:"Actions"}),visibleInMode:"all",hideHeader:!0,align:"end",maxWidth:"max-w-84",body:n=>g(v.exports.Fragment,{children:[i(R,{size:"md",className:"text-muted",elementType:le,to:`/admin/plans/${n.id}/edit`,children:i(Ct,{})}),i(gy,{product:n})]})}];function my(){const n=Fe();return i(qt,{endpoint:"billing/products",title:i(u,{message:"Subscription plans"}),columns:py,actions:i(by,{}),enableSelection:!1,filters:fy,onRowAction:e=>{n(`/admin/plans/${e.id}/edit`)},emptyStateMessage:i(mt,{image:xc,title:i(u,{message:"No plans have been created yet"}),filteringTitle:i(u,{message:"No matching plans"})})})}function gy({product:n}){const e=uy();return g(W,{type:"modal",onClose:t=>{t&&e.mutate({productId:n.id})},children:[i(pt,{label:i(u,{message:"Delete plan"}),children:i(R,{size:"md",className:"text-muted",disabled:e.isLoading,children:i(ds,{})})}),i(bt,{title:i(u,{message:"Delete plan"}),body:i(u,{message:"Are you sure you want to delete this plan?"}),confirm:i(u,{message:"Delete"})})]})}function by(){const n=ly();return g(v.exports.Fragment,{children:[i(pt,{label:i(u,{message:"Sync plans with Stripe & PayPal"}),children:i(R,{color:"primary",variant:"outline",radius:"rounded",size:"sm",disabled:n.isLoading,onClick:()=>{n.mutate()},children:i(oy,{})})}),i(bn,{elementType:le,to:"/admin/plans/new",children:i(u,{message:"Add new plan"})})]})}const Cc=n=>`billing/products/${n}`;function yy(){const{productId:n}=qe();return dn([Cc(n)],()=>vy(n))}function vy(n){return q.get(Cc(n)).then(e=>e.data)}const ci=[{key:"day1",label:S("Daily"),interval:"day",interval_count:1},{key:"week1",label:S("Weekly"),interval:"week",interval_count:1},{key:"month1",label:S("Monthly"),interval:"month",interval_count:1},{key:"month3",label:S("Every 3 months"),interval:"month",interval_count:3},{key:"month6",label:S("Every 6 months"),interval:"month",interval_count:6},{key:"year1",label:S("Yearly"),interval:"year",interval_count:1},{key:"custom",label:S("Custom"),interval:null,interval_count:null}];function xy({index:n,onRemovePrice:e}){const{trans:t}=Q(),r=st(["currencies"]),s=v.exports.useMemo(()=>{var m;return(m=r.data)!=null&&m.currencies?Object.values(r.data.currencies):[]},[r.data]),{watch:a,getValues:o}=_(),l=!a("id"),c=a(`prices.${n}.id`)==null,d=a(`prices.${n}.subscriptions_count`)||0,[h,f]=v.exports.useState(()=>{const m=o(`prices.${n}.interval`),b=o(`prices.${n}.interval_count`),y=ci.find(x=>x.key===`${m}${b}`);return y?y.key:"custom"}),p=l||c||!d;return g(v.exports.Fragment,{children:[!p&&i("p",{className:"text-muted text-sm max-w-500 mb-20",children:i(u,{message:"This price can't modified or deleted, because it has [one 1 subscriber|other :count subscribers]. You can instead add a new price.",values:{count:d}})}),i(w,{required:!0,disabled:!p,label:i(u,{message:"Amount"}),type:"number",min:.1,step:.01,name:`prices.${n}.amount`,className:"mb-20"}),i(se,{required:!0,disabled:!p,label:i(u,{message:"Currency"}),name:`prices.${n}.currency`,items:s,showSearchField:!0,searchPlaceholder:t(S("Search currencies")),selectionMode:"single",className:"mb-20",children:m=>i(C,{value:m.code,children:`${m.code}: ${m.name}`},m.code)}),i(Sy,{disabled:!p,index:n,value:h,onValueChange:f}),h==="custom"&&i(ky,{disabled:!p,index:n}),i("div",{className:"text-right",children:i(E,{size:"xs",variant:"outline",color:"danger",disabled:!p,onClick:()=>{e()},children:i(u,{message:"Delete price"})})})]})}function Sy({index:n,value:e,onValueChange:t,disabled:r}){const{setValue:s}=_();return i(rs,{label:i(u,{message:"Billing period"}),disabled:r,className:"mb-20",selectionMode:"single",selectedValue:e,onSelectionChange:a=>{if(t(a),a!=="custom"){const o=ci.find(l=>l.key===a);o&&(s(`prices.${n}.interval`,o.interval),s(`prices.${n}.interval_count`,o.interval_count))}},children:ci.map(a=>i(C,{value:a.key,children:i(u,{...a.label})},a.key))})}function ky({index:n,disabled:e}){const{watch:t}=_(),r=t(`prices.${n}.interval`);let s;return r==="day"?s=365:r==="week"?s=52:s=12,g("div",{className:"flex border rounded w-min",children:[i("div",{className:"px-18 flex items-center text-sm",children:i(u,{message:"Every"})}),i(w,{inputShadow:"shadow-none",inputBorder:"border-none",className:"border-l border-r w-80",name:`prices.${n}.interval_count`,type:"number",min:1,max:s,disabled:e,required:!0}),g(se,{inputShadow:"shadow-none",inputBorder:"border-none",name:`prices.${n}.interval`,selectionMode:"single",disabled:e,children:[i(C,{value:"day",children:i(u,{message:"Days"})}),i(C,{value:"week",children:i(u,{message:"Weeks"})}),i(C,{value:"month",children:i(u,{message:"Months"})})]})]})}function Nc(){return g(v.exports.Fragment,{children:[i(w,{name:"name",label:i(u,{message:"Name"}),className:"mb-20",required:!0,autoFocus:!0}),i(w,{name:"description",label:i(u,{message:"Description"}),className:"mb-20",inputElementType:"textarea",rows:4}),g(se,{name:"position",selectionMode:"single",label:i(u,{message:"Position in pricing table"}),className:"mb-20",children:[i(C,{value:0,children:i(u,{message:"First"})}),i(C,{value:1,children:i(u,{message:"Second"})}),i(C,{value:2,children:i(u,{message:"Third"})}),i(C,{value:3,children:i(u,{message:"Fourth"})}),i(C,{value:4,children:i(u,{message:"Fifth"})})]}),i(tr,{className:"mb-30",name:"available_space",label:i(u,{message:"Allowed storage space"}),description:i(u,{values:{a:n=>i(le,{className:Bi,target:"_blank",to:"/admin/settings/uploading",children:n})},message:"Total storage space all user uploads are allowed to take up."})}),i(K,{name:"recommended",className:"mb-20",description:i(u,{message:"Plan will be displayed more prominently on pricing page."}),children:i(u,{message:"Recommend"})}),i(K,{name:"hidden",className:"mb-20",description:i(u,{message:"Plan will not be shown on pricing or upgrade pages."}),children:i(u,{message:"Hidden"})}),i(K,{name:"free",className:"mb-20",description:i(u,{message:"Will be assigned to all users, if they are not subscribed already."}),children:i(u,{message:"Free"})}),i(di,{children:i(u,{message:"Feature list"})}),i(wy,{}),i(Cy,{}),i(di,{children:i(u,{message:"Permissions"})}),i(Qi,{name:"permissions"})]})}function di({children:n}){return i("h2",{className:"mt-40 mb-20 text-base font-semibold",children:n})}function wy(){const{fields:n,append:e,remove:t}=Ze({name:"feature_list"});return g("div",{children:[n.map((r,s)=>g("div",{className:"flex gap-10 mb-10",children:[i(w,{name:`feature_list.${s}.value`,size:"sm",className:"flex-auto"}),i(R,{size:"sm",color:"primary",className:"flex-shrink-0",onClick:()=>{t(s)},children:i($t,{})})]},r.id)),i(E,{variant:"text",color:"primary",startIcon:i(Qe,{}),size:"xs",onClick:()=>{e({value:""})},children:i(u,{message:"Add another line"})})]})}function Cy(){var a;const{watch:n,formState:{errors:e}}=_(),{fields:t,append:r,remove:s}=Ze({name:"prices",keyName:"key"});return n("free")?null:g(v.exports.Fragment,{children:[i(di,{children:i(u,{message:"Pricing"})}),((a=e.prices)==null?void 0:a.message)&&i("div",{className:"text-sm text-danger mb-20",children:e.prices.message}),i(Ht,{variant:"outline",className:"mb-10",children:t.map((o,l)=>i(Ge,{label:i(Vi,{price:o}),children:i(xy,{index:l,onRemovePrice:()=>{s(l)}})},o.key))}),i(E,{variant:"text",color:"primary",startIcon:i(Qe,{}),size:"xs",onClick:()=>{r({currency:"USD",amount:1,interval_count:1,interval:"month"})},children:i(u,{message:"Add another price"})})]})}const Mc=n=>`billing/products/${n}`;function Ny(n){const{trans:e}=Q(),t=Fe();return te(r=>My(r),{onSuccess:r=>{ne(e(S("Plan updated"))),G.invalidateQueries([Mc(r.product.id)]),G.invalidateQueries(ce("billing/products")),t("/admin/plans")},onError:r=>He(r,n)})}function My({id:n,...e}){const t={...e,feature_list:e.feature_list.map(r=>r.value)};return q.put(Mc(n),t).then(r=>r.data)}function Ty(){const n=yy();return n.status!=="success"?i(mn,{}):i(Ey,{product:n.data.product})}function Ey({product:n}){const e=ae({defaultValues:{...n,feature_list:n.feature_list.map(r=>({value:r}))}}),t=Ny(e);return i(wr,{form:e,onSubmit:r=>{t.mutate(r)},title:i(u,{message:"Edit \u201C:name\u201C plan",values:{name:n.name}}),isLoading:t.isLoading,children:i(Nc,{})})}const Tc="billing/products";function Oy(n){const{trans:e}=Q(),t=Fe();return te(r=>Ay(r),{onSuccess:()=>{ne(e(S("Plan created"))),G.invalidateQueries([Tc]),G.invalidateQueries(ce("billing/products")),t("/admin/plans")},onError:r=>He(r,n)})}function Ay(n){const e={...n,feature_list:n.feature_list.map(t=>t.value)};return q.post(Tc,e).then(t=>t.data)}function Iy(){const n=ae({defaultValues:{free:!1,recommended:!1}}),e=Oy(n);return i(wr,{form:n,onSubmit:t=>{e.mutate(t)},title:i(u,{message:"Create new plan"}),isLoading:e.isLoading,children:i(Nc,{})})}function Dy(){return g(Ue,{title:i(u,{message:"GDPR"}),description:i(u,{message:"Configure settings related to EU General Data Protection Regulation."}),children:[i(zy,{}),i(St,{}),i(Py,{})]})}function zy(){const{watch:n}=_(),e=n("client.cookie_notice.enable");return g("div",{children:[i(K,{name:"client.cookie_notice.enable",className:"mb-20",description:i(u,{message:"Whether cookie notice should be shown automatically to users from EU until it is accepted."}),children:i(u,{message:"Enable cookie notice"})}),e&&g(v.exports.Fragment,{children:[g("div",{className:"border-b pb-6 mb-20",children:[i("div",{className:"text-sm font-medium border-b pb-10 mb-20",children:i(u,{message:"Information button"})}),i(Tn,{hideRoleAndPermissionFields:!0,formPathPrefix:"client.cookie_notice.button"})]}),g(se,{name:"client.cookie_notice.position",selectionMode:"single",label:i(u,{message:"Cookie notice position"}),className:"mb-20",children:[i(C,{value:"top",children:i(u,{message:"Top"})}),i(C,{value:"bottom",children:i(u,{message:"Bottom"})})]})]})]})}function Py(){const{fields:n,append:e,remove:t}=Ze({name:"client.registration.policies"});return g(v.exports.Fragment,{children:[i("div",{className:"mb-6 text-sm",children:i(u,{message:"Registration policies"})}),i("div",{className:"text-xs text-muted",children:i(u,{message:"Create policies that will be shown on registration page. User will be required to accept them by toggling a checkbox."})}),i(Ht,{className:"mt-16",variant:"outline",children:n.map((r,s)=>i(Ge,{label:r.label,chevronPosition:"left",endAppend:i(R,{radius:"rounded",variant:"text",color:"danger",size:"sm",onClick:()=>{t(s)},children:i($t,{})}),children:i(Tn,{hideRoleAndPermissionFields:!0,formPathPrefix:`client.register_policies.${s}`})},r.id))}),g(W,{type:"modal",onClose:r=>{r&&e(r)},children:[i(E,{className:"mt-12",variant:"link",color:"primary",startIcon:i(Qe,{}),size:"xs",children:i(u,{message:"Add another policy"})}),i(ic,{title:i(u,{message:"Add policy"})})]})]})}const Ry=[];function Fy(n){const{pageId:e}=qe(),t=`${n||"custom-pages"}/${e}`;return te(r=>Ly(r,t),{onError:r=>Oe(r),onSuccess:async()=>{await G.invalidateQueries(["custom-pages"]),await G.invalidateQueries(ce(t)),ne(S("Page updated"))}})}function Ly(n,e){return q.put(`${e}`,n).then(t=>t.data)}function Ec(){const[n,e]=v.exports.useState(!1),{trans:t}=Q(),s=_().watch("title"),a=t({message:"Title"});return n?i(w,{placeholder:a,autoFocus:!0,className:"mb-30",onBlur:()=>{e(!1)},name:"title",required:!0}):g("h1",{tabIndex:0,onClick:()=>{e(!0)},onFocus:()=>{e(!0)},className:P("hover:bg-primary/focus rounded cursor-pointer",!s&&"text-muted"),children:[s||a,i(Ct,{className:"icon-sm mx-8 mt-8 align-top text-muted"})]})}function xe(n){this.content=n}xe.prototype={constructor:xe,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),a=r.content.slice();return s==-1?a.push(t||n,e):(a[s+1]=e,t&&(a[s]=t)),new xe(a)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new xe(t)},addToStart:function(n,e){return new xe([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new xe(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),a=r.find(n);return s.splice(a==-1?s.length:a,0,e,t),new xe(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=xe.from(n),n.size?new xe(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=xe.from(n),n.size?new xe(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=xe.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};xe.from=function(n){if(n instanceof xe)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new xe(e)};function Oc(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),a=e.child(r);if(s==a){t+=s.nodeSize;continue}if(!s.sameMarkup(a))return t;if(s.isText&&s.text!=a.text){for(let o=0;s.text[o]==a.text[o];o++)t++;return t}if(s.content.size||a.content.size){let o=Oc(s.content,a.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function Ac(n,e,t,r){for(let s=n.childCount,a=e.childCount;;){if(s==0||a==0)return s==a?null:{a:t,b:r};let o=n.child(--s),l=e.child(--a),c=o.nodeSize;if(o==l){t-=c,r-=c;continue}if(!o.sameMarkup(l))return{a:t,b:r};if(o.isText&&o.text!=l.text){let d=0,h=Math.min(o.text.length,l.text.length);for(;d<h&&o.text[o.text.length-d-1]==l.text[l.text.length-d-1];)d++,t--,r--;return{a:t,b:r}}if(o.content.size||l.content.size){let d=Ac(o.content,l.content,t-1,r-1);if(d)return d}t-=c,r-=c}}class N{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,a){for(let o=0,l=0;l<t;o++){let c=this.content[o],d=l+c.nodeSize;if(d>e&&r(c,s+l,a||null,o)!==!1&&c.content.size){let h=l+1;c.nodesBetween(Math.max(0,e-h),Math.min(c.content.size,t-h),r,s+h)}l=d}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let a="",o=!0;return this.nodesBetween(e,t,(l,c)=>{l.isText?(a+=l.text.slice(Math.max(e,c)-c,t-c),o=!r):l.isLeaf?(s?a+=typeof s=="function"?s(l):s:l.type.spec.leafText&&(a+=l.type.spec.leafText(l)),o=!r):!o&&l.isBlock&&(a+=r,o=!0)},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),a=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),a=1);a<e.content.length;a++)s.push(e.content[a]);return new N(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let a=0,o=0;o<t;a++){let l=this.content[a],c=o+l.nodeSize;c>e&&((o<e||c>t)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,t-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,t-o-1))),r.push(l),s+=l.nodeSize),o=c}return new N(r,s)}cutByIndex(e,t){return e==t?N.empty:e==0&&t==this.content.length?this:new N(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),a=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new N(s,a)}addToStart(e){return new N([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new N(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return Oc(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Ac(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Ir(0,e);if(e==this.size)return Ir(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,s=0;;r++){let a=this.child(r),o=s+a.nodeSize;if(o>=e)return o==e||t>0?Ir(r+1,o):Ir(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return N.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new N(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return N.empty;let t,r=0;for(let s=0;s<e.length;s++){let a=e[s];r+=a.nodeSize,s&&a.isText&&e[s-1].sameMarkup(a)?(t||(t=e.slice(0,s)),t[t.length-1]=a.withText(t[t.length-1].text+a.text)):t&&t.push(a)}return new N(t||e,r)}static from(e){if(!e)return N.empty;if(e instanceof N)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new N([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}N.empty=new N([],0);const zs={index:0,offset:0};function Ir(n,e){return zs.index=n,zs.offset=e,zs}function Hr(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Hr(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Hr(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class X{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let a=e[s];if(this.eq(a))return e;if(this.type.excludes(a.type))t||(t=e.slice(0,s));else{if(a.type.excludes(this.type))return e;!r&&a.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(a)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Hr(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return X.none;if(e instanceof X)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}}X.none=[];class qr extends Error{}class O{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Dc(this.content,e+this.openStart,t);return r&&new O(r,this.openStart,this.openEnd)}removeBetween(e,t){return new O(Ic(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return O.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new O(N.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let a=e.firstChild;a&&!a.isLeaf&&(t||!a.type.spec.isolating);a=a.firstChild)r++;for(let a=e.lastChild;a&&!a.isLeaf&&(t||!a.type.spec.isolating);a=a.lastChild)s++;return new O(e,r,s)}}O.empty=new O(N.empty,0,0);function Ic(n,e,t){let{index:r,offset:s}=n.findIndex(e),a=n.maybeChild(r),{index:o,offset:l}=n.findIndex(t);if(s==e||a.isText){if(l!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,a.copy(Ic(a.content,e-s-1,t-s-1)))}function Dc(n,e,t,r){let{index:s,offset:a}=n.findIndex(e),o=n.maybeChild(s);if(a==e||o.isText)return r&&!r.canReplace(s,s,t)?null:n.cut(0,e).append(t).append(n.cut(e));let l=Dc(o.content,e-a-1,t);return l&&n.replaceChild(s,o.copy(l))}function _y(n,e,t){if(t.openStart>n.depth)throw new qr("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new qr("Inconsistent open depths");return zc(n,e,t,0)}function zc(n,e,t,r){let s=n.index(r),a=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=zc(n,e,t,r+1);return a.copy(a.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,l=o.content;return tn(o,l.cut(0,n.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=By(t,n);return tn(a,Rc(n,o,l,e,r))}else return tn(a,Ur(n,e,r))}function Pc(n,e){if(!e.type.compatibleContent(n.type))throw new qr("Cannot join "+e.type.name+" onto "+n.type.name)}function ui(n,e,t){let r=n.node(t);return Pc(r,e.node(t)),r}function en(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function nr(n,e,t,r){let s=(e||n).node(t),a=0,o=e?e.index(t):s.childCount;n&&(a=n.index(t),n.depth>t?a++:n.textOffset&&(en(n.nodeAfter,r),a++));for(let l=a;l<o;l++)en(s.child(l),r);e&&e.depth==t&&e.textOffset&&en(e.nodeBefore,r)}function tn(n,e){return n.type.checkContent(e),n.copy(e)}function Rc(n,e,t,r,s){let a=n.depth>s&&ui(n,e,s+1),o=r.depth>s&&ui(t,r,s+1),l=[];return nr(null,n,s,l),a&&o&&e.index(s)==t.index(s)?(Pc(a,o),en(tn(a,Rc(n,e,t,r,s+1)),l)):(a&&en(tn(a,Ur(n,e,s+1)),l),nr(e,t,s,l),o&&en(tn(o,Ur(t,r,s+1)),l)),nr(r,null,s,l),new N(l)}function Ur(n,e,t){let r=[];if(nr(null,n,t,r),n.depth>t){let s=ui(n,e,t+1);en(tn(s,Ur(n,e,t+1)),r)}return nr(e,null,t,r),new N(r)}function By(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let a=t-1;a>=0;a--)s=e.node(a).copy(N.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class ur{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let a=0;a<e;a++)s+=r.child(a).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return X.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let l=r;r=s,s=l}let a=r.marks;for(var o=0;o<a.length;o++)a[o].type.spec.inclusive===!1&&(!s||!a[o].isInSet(s.marks))&&(a=a[o--].removeFromSet(a));return a}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var a=0;a<r.length;a++)r[a].type.spec.inclusive===!1&&(!s||!r[a].isInSet(s.marks))&&(r=r[a--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Wr(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,a=t;for(let o=e;;){let{index:l,offset:c}=o.content.findIndex(a),d=a-c;if(r.push(o,l,s+c),!d||(o=o.child(l),o.isText))break;a=d-1,s+=c+1}return new ur(t,r,a)}static resolveCached(e,t){for(let s=0;s<Ps.length;s++){let a=Ps[s];if(a.pos==t&&a.doc==e)return a}let r=Ps[Rs]=ur.resolve(e,t);return Rs=(Rs+1)%$y,r}}let Ps=[],Rs=0,$y=12;class Wr{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Vy=Object.create(null);class ft{constructor(e,t,r,s=X.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||N.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Hr(this.attrs,t||e.defaultAttrs||Vy)&&X.sameSet(this.marks,r||X.none)}copy(e=null){return e==this.content?this:new ft(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ft(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return O.empty;let s=this.resolve(e),a=this.resolve(t),o=r?0:s.sharedDepth(t),l=s.start(o),d=s.node(o).content.cut(s.pos-l,a.pos-l);return new O(d,s.depth-o,a.depth-o)}replace(e,t,r){return _y(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return ur.resolveCached(this,e)}resolveNoCache(e){return ur.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,a=>(r.isInSet(a.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Fc(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=N.empty,s=0,a=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,a),l=o&&o.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let c=s;c<a;c++)if(!this.type.allowsMarks(r.child(c).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let a=this.contentMatchAt(e).matchType(r),o=a&&a.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=X.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!X.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=N.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,s,r)}}ft.prototype.text=void 0;class jr extends ft{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Fc(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new jr(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new jr(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Fc(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class an{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new Hy(e,t);if(r.next==null)return an.empty;let s=Lc(r);r.next&&r.err("Unexpected trailing text");let a=Gy(Ky(s));return Qy(a,r),a}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let a=t;s&&a<r;a++)s=s.matchType(e.child(a).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function a(o,l){let c=o.matchFragment(e,r);if(c&&(!t||c.validEnd))return N.from(l.map(d=>d.createAndFill()));for(let d=0;d<o.next.length;d++){let{type:h,next:f}=o.next[d];if(!(h.isText||h.hasRequiredAttrs())&&s.indexOf(f)==-1){s.push(f);let p=a(f,l.concat(h));if(p)return p}}return null}return a(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),a=s.match;if(a.matchType(e)){let o=[];for(let l=s;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<a.next.length;o++){let{type:l,next:c}=a.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!s.type||c.validEnd)&&(r.push({match:l.contentMatch,type:l,via:s}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let a=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)a+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return a}).join(`
`)}}an.empty=new an(!0);class Hy{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Lc(n){let e=[];do e.push(qy(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function qy(n){let e=[];do e.push(Uy(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function Uy(n){let e=Jy(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=Wy(n,e);else break;return e}function La(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function Wy(n,e){let t=La(n),r=t;return n.eat(",")&&(n.next!="}"?r=La(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function jy(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let a in t){let o=t[a];o.groups.indexOf(e)>-1&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function Jy(n){if(n.eat("(")){let e=Lc(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=jy(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Ky(n){let e=[[]];return s(a(n,0),t()),e;function t(){return e.push([])-1}function r(o,l,c){let d={term:c,to:l};return e[o].push(d),d}function s(o,l){o.forEach(c=>c.to=l)}function a(o,l){if(o.type=="choice")return o.exprs.reduce((c,d)=>c.concat(a(d,l)),[]);if(o.type=="seq")for(let c=0;;c++){let d=a(o.exprs[c],l);if(c==o.exprs.length-1)return d;s(d,l=t())}else if(o.type=="star"){let c=t();return r(l,c),s(a(o.expr,c),c),[r(c)]}else if(o.type=="plus"){let c=t();return s(a(o.expr,l),c),s(a(o.expr,c),c),[r(c)]}else{if(o.type=="opt")return[r(l)].concat(a(o.expr,l));if(o.type=="range"){let c=l;for(let d=0;d<o.min;d++){let h=t();s(a(o.expr,c),h),c=h}if(o.max==-1)s(a(o.expr,c),c);else for(let d=o.min;d<o.max;d++){let h=t();r(c,h),s(a(o.expr,c),h),c=h}return[r(c)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function _c(n,e){return e-n}function _a(n,e){let t=[];return r(e),t.sort(_c);function r(s){let a=n[s];if(a.length==1&&!a[0].term)return r(a[0].to);t.push(s);for(let o=0;o<a.length;o++){let{term:l,to:c}=a[o];!l&&t.indexOf(c)==-1&&r(c)}}}function Gy(n){let e=Object.create(null);return t(_a(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:l,to:c})=>{if(!l)return;let d;for(let h=0;h<s.length;h++)s[h][0]==l&&(d=s[h][1]);_a(n,c).forEach(h=>{d||s.push([l,d=[]]),d.indexOf(h)==-1&&d.push(h)})})});let a=e[r.join(",")]=new an(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let l=s[o][1].sort(_c);a.next.push({type:s[o][0],next:e[l.join(",")]||t(l)})}return a}}function Qy(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],a=!s.validEnd,o=[];for(let l=0;l<s.next.length;l++){let{type:c,next:d}=s.next[l];o.push(c.name),a&&!(c.isText||c.hasRequiredAttrs())&&(a=!1),r.indexOf(d)==-1&&r.push(d)}a&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Bc(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function $c(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let a=n[r];if(a.hasDefault)s=a.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function Vc(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new Yy(n[t]);return e}class Jr{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Vc(r.attrs),this.defaultAttrs=Bc(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==an.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:$c(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ft(this,this.computeAttrs(e),N.from(t),X.setFrom(r))}createChecked(e=null,t,r){return t=N.from(t),this.checkContent(t),new ft(this,this.computeAttrs(e),t,X.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=N.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),a=s&&s.fillBefore(N.empty,!0);return a?new ft(this,e,t.append(a),X.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:X.none:e}static compile(e,t){let r=Object.create(null);e.forEach((a,o)=>r[a]=new Jr(a,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let a in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class Yy{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class fs{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=Vc(s.attrs),this.excluded=null;let a=Bc(this.attrs);this.instance=a?new X(this,a):null}create(e=null){return!e&&this.instance?this.instance:new X(this,$c(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((a,o)=>r[a]=new fs(a,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class Xy{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=xe.from(e.nodes),t.marks=xe.from(e.marks||{}),this.nodes=Jr.compile(this.spec.nodes,this),this.marks=fs.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let a=this.nodes[s],o=a.spec.content||"",l=a.spec.marks;a.contentMatch=r[o]||(r[o]=an.parse(o,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.markSet=l=="_"?null:l?Ba(this,l.split(" ")):l==""||!a.inlineContent?[]:null}for(let s in this.marks){let a=this.marks[s],o=a.spec.excludes;a.excluded=o==null?[a]:o==""?[]:Ba(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Jr){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new jr(r,r.defaultAttrs,e,X.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return ft.fromJSON(this,e)}markFromJSON(e){return X.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Ba(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],a=n.marks[s],o=a;if(a)t.push(a);else for(let l in n.marks){let c=n.marks[l];(s=="_"||c.spec.group&&c.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=c)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}class zn{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let s=e.nodes[r.node];return s.contentMatch.matchType(s)})}parse(e,t={}){let r=new Va(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Va(this,t,!0);return r.addAll(e,t.from,t.to),O.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let a=this.tags[s];if(t0(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||t.matchesContext(a.context))){if(a.getAttrs){let o=a.getAttrs(e);if(o===!1)continue;a.attrs=o||void 0}return a}}}matchStyle(e,t,r,s){for(let a=s?this.styles.indexOf(s)+1:0;a<this.styles.length;a++){let o=this.styles[a],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(o.getAttrs){let c=o.getAttrs(t);if(c===!1)continue;o.attrs=c||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let a=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let l=t[o];if((l.priority==null?50:l.priority)<a)break}t.splice(o,0,s)}for(let s in e.marks){let a=e.marks[s].spec.parseDOM;a&&a.forEach(o=>{r(o=Ha(o)),o.mark=s})}for(let s in e.nodes){let a=e.nodes[s].spec.parseDOM;a&&a.forEach(o=>{r(o=Ha(o)),o.node=s})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new zn(e,zn.schemaRules(e)))}}const Hc={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Zy={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},qc={ol:!0,ul:!0},Kr=1,Gr=2,rr=4;function $a(n,e,t){return e!=null?(e?Kr:0)|(e==="full"?Gr:0):n&&n.whitespace=="pre"?Kr|Gr:t&~rr}class Dr{constructor(e,t,r,s,a,o,l){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=s,this.solid=a,this.options=l,this.content=[],this.activeMarks=X.none,this.stashMarks=[],this.match=o||(l&rr?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(N.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Kr)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let a=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-s[0].length))}}let t=N.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(N.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let s=r[t];(this.type?this.type.allowsMarkType(s.type):r0(s.type,e))&&!s.isInSet(this.activeMarks)&&(this.activeMarks=s.addToSet(this.activeMarks),this.pendingMarks=s.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Hc.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Va{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let s=t.topNode,a,o=$a(null,t.preserveWhitespace,0)|(r?rr:0);s?a=new Dr(s.type,s.attrs,X.none,X.none,!0,t.topMatch||s.type.contentMatch,o):r?a=new Dr(null,null,X.none,X.none,!0,null,o):a=new Dr(e.schema.topNodeType,null,X.none,X.none,!0,null,o),this.nodes=[a],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(e.nodeType==3)this.addTextNode(e);else if(e.nodeType==1){let t=e.getAttribute("style"),r=t?this.readStyles(n0(t)):null,s=this.top;if(r!=null)for(let a=0;a<r.length;a++)this.addPendingMark(r[a]);if(this.addElement(e),r!=null)for(let a=0;a<r.length;a++)this.removePendingMark(r[a],s)}}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&Gr||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&Kr)r.options&Gr?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let s=r.content[r.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),s;qc.hasOwnProperty(r)&&this.parser.normalizeLists&&e0(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,t));if(a?a.ignore:Zy.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let o,l=this.top,c=this.needsBlock;if(Hc.hasOwnProperty(r))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),o=!0,l.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}this.addAll(e),o&&this.sync(l),this.needsBlock=c}else this.addElementByRule(e,a,a.consuming===!1?s:void 0)}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=X.none;e:for(let r=0;r<e.length;r+=2)for(let s=void 0;;){let a=this.parser.matchStyle(e[r],e[r+1],this,s);if(!a)continue e;if(a.ignore)return null;if(t=this.parser.schema.marks[a.mark].create(a.attrs).addToSet(t),a.consuming===!1)s=a;else break}return t}addElementByRule(e,t,r){let s,a,o;t.node?(a=this.parser.schema.nodes[t.node],a.isLeaf?this.insertNode(a.create(t.attrs))||this.leafFallback(e):s=this.enter(a,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let l=this.top;if(a&&a.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(c=>this.insertNode(c));else{let c=e;typeof t.contentElement=="string"?c=e.querySelector(t.contentElement):typeof t.contentElement=="function"?c=t.contentElement(e):t.contentElement&&(c=t.contentElement),this.findAround(e,c,!0),this.addAll(c)}s&&this.sync(l)&&this.open--,o&&this.removePendingMark(o,l)}addAll(e,t,r){let s=t||0;for(let a=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];a!=o;a=a.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(a);this.findAtPoint(e,s)}findPlace(e){let t,r;for(let s=this.open;s>=0;s--){let a=this.nodes[s],o=a.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=a,!o.length)||a.solid)break}if(!t)return!1;this.sync(r);for(let s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let s=0;s<e.marks.length;s++)(!t.type||t.type.allowsMarkType(e.marks[s].type))&&(r=e.marks[s].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let s=this.findPlace(e.create(t));return s&&this.enterInner(e,t,!0,r),s}enterInner(e,t=null,r=!1,s){this.closeExtra();let a=this.top;a.applyPending(e),a.match=a.match&&a.match.matchType(e);let o=$a(e,s,a.options);a.options&rr&&a.content.length==0&&(o|=rr),this.nodes.push(new Dr(e,t,a.activeMarks,a.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),a=-(r?r.depth+1:0)+(s?0:1),o=(l,c)=>{for(;l>=0;l--){let d=t[l];if(d==""){if(l==t.length-1||l==0)continue;for(;c>=a;c--)if(o(l-1,c))return!0;return!1}else{let h=c>0||c==0&&s?this.nodes[c].type:r&&c>=a?r.node(c-a).type:null;if(!h||h.name!=d&&h.groups.indexOf(d)==-1)return!1;c--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=s0(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let s=this.nodes[r];if(s.pendingMarks.lastIndexOf(e)>-1)s.pendingMarks=e.removeFromSet(s.pendingMarks);else{s.activeMarks=e.removeFromSet(s.activeMarks);let o=s.popFromStashMark(e);o&&s.type&&s.type.allowsMarkType(o.type)&&(s.activeMarks=o.addToSet(s.activeMarks))}if(s==t)break}}}function e0(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&qc.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function t0(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function n0(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function Ha(n){let e={};for(let t in n)e[t]=n[t];return e}function r0(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let a=[],o=l=>{a.push(l);for(let c=0;c<l.edgeCount;c++){let{type:d,next:h}=l.edge(c);if(d==e||a.indexOf(h)<0&&o(h))return!0}};if(o(s.contentMatch))return!0}}function s0(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class dt{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Fs(t).createDocumentFragment());let s=r,a=[];return e.forEach(o=>{if(a.length||o.marks.length){let l=0,c=0;for(;l<a.length&&c<o.marks.length;){let d=o.marks[c];if(!this.marks[d.type.name]){c++;continue}if(!d.eq(a[l][0])||d.type.spec.spanning===!1)break;l++,c++}for(;l<a.length;)s=a.pop()[1];for(;c<o.marks.length;){let d=o.marks[c++],h=this.serializeMark(d,o.isInline,t);h&&(a.push([d,s]),s.appendChild(h.dom),s=h.contentDOM||h.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=dt.renderSpec(Fs(t),this.nodes[e.type.name](e));if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let a=this.serializeMark(e.marks[s],e.isInline,t);a&&((a.contentDOM||a.dom).appendChild(r),r=a.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&dt.renderSpec(Fs(r),s(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let s=t[0],a=s.indexOf(" ");a>0&&(r=s.slice(0,a),s=s.slice(a+1));let o,l=r?e.createElementNS(r,s):e.createElement(s),c=t[1],d=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){d=2;for(let h in c)if(c[h]!=null){let f=h.indexOf(" ");f>0?l.setAttributeNS(h.slice(0,f),h.slice(f+1),c[h]):l.setAttribute(h,c[h])}}for(let h=d;h<t.length;h++){let f=t[h];if(f===0){if(h<t.length-1||h>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:p,contentDOM:m}=dt.renderSpec(e,f,r);if(l.appendChild(p),m){if(o)throw new RangeError("Multiple content holes");o=m}}}return{dom:l,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new dt(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=qa(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return qa(e.marks)}}function qa(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Fs(n){return n.document||window.document}const Uc=65535,Wc=Math.pow(2,16);function i0(n,e){return n+e*Wc}function Ua(n){return n&Uc}function a0(n){return(n-(n&Uc))/Wc}const jc=1,Jc=2,Fr=4,Kc=8;class hi{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Kc)>0}get deletedBefore(){return(this.delInfo&(jc|Fr))>0}get deletedAfter(){return(this.delInfo&(Jc|Fr))>0}get deletedAcross(){return(this.delInfo&Fr)>0}}class Ke{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Ke.empty)return Ke.empty}recover(e){let t=0,r=Ua(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+a0(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,a=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?s:0);if(c>e)break;let d=this.ranges[l+a],h=this.ranges[l+o],f=c+d;if(e<=f){let p=d?e==c?-1:e==f?1:t:t,m=c+s+(p<0?0:h);if(r)return m;let b=e==(t<0?c:f)?null:i0(l/3,e-c),y=e==c?Jc:e==f?jc:Fr;return(t<0?e!=c:e!=f)&&(y|=Kc),new hi(m,y,b)}s+=h-d}return r?e+s:new hi(e+s,0,null)}touches(e,t){let r=0,s=Ua(t),a=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let c=this.ranges[l]-(this.inverted?r:0);if(c>e)break;let d=this.ranges[l+a],h=c+d;if(e<=h&&l==s*3)return!0;r+=this.ranges[l+o]-d}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,a=0;s<this.ranges.length;s+=3){let o=this.ranges[s],l=o-(this.inverted?a:0),c=o+(this.inverted?0:a),d=this.ranges[s+t],h=this.ranges[s+r];e(l,l+d,c,c+h),a+=h-d}}invert(){return new Ke(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ke.empty:new Ke(e<0?[0,-e,0]:[0,0,e])}}Ke.empty=new Ke([]);class sr{constructor(e=[],t,r=0,s=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=s}slice(e=0,t=this.maps.length){return new sr(this.maps,this.mirror,e,t)}copy(){return new sr(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let s=e.getMirror(t);this.appendMap(e.maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e.maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new sr;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let a=this.from;a<this.to;a++){let o=this.maps[a],l=o.mapResult(e,t);if(l.recover!=null){let c=this.getMirror(a);if(c!=null&&c>a&&c<this.to){a=c,e=this.maps[c].recover(l.recover);continue}}s|=l.delInfo,e=l.pos}return r?e:new hi(e,s,null)}}const Ls=Object.create(null);class _e{getMap(){return Ke.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ls[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ls)throw new RangeError("Duplicate use of step JSON ID "+e);return Ls[e]=t,t.prototype.jsonID=e,t}}class fe{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new fe(e,null)}static fail(e){return new fe(null,e)}static fromReplace(e,t,r,s){try{return fe.ok(e.replace(t,r,s))}catch(a){if(a instanceof qr)return fe.fail(a.message);throw a}}}function Zi(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let a=n.child(s);a.content.size&&(a=a.copy(Zi(a.content,e,a))),a.isInline&&(a=e(a,t,s)),r.push(a)}return N.fromArray(r)}class At extends _e{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),a=new O(Zi(t.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return fe.fromReplace(e,this.from,this.to,a)}invert(){return new ut(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new At(t.pos,r.pos,this.mark)}merge(e){return e instanceof At&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new At(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new At(t.from,t.to,e.markFromJSON(t.mark))}}_e.jsonID("addMark",At);class ut extends _e{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new O(Zi(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return fe.fromReplace(e,this.from,this.to,r)}invert(){return new At(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ut(t.pos,r.pos,this.mark)}merge(e){return e instanceof ut&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ut(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ut(t.from,t.to,e.markFromJSON(t.mark))}}_e.jsonID("removeMark",ut);class It extends _e{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return fe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return fe.fromReplace(e,this.pos,this.pos+1,new O(N.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new It(this.pos,t.marks[s]);return new It(this.pos,this.mark)}}return new Pn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new It(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new It(t.pos,e.markFromJSON(t.mark))}}_e.jsonID("addNodeMark",It);class Pn extends _e{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return fe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return fe.fromReplace(e,this.pos,this.pos+1,new O(N.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new It(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Pn(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Pn(t.pos,e.markFromJSON(t.mark))}}_e.jsonID("removeNodeMark",Pn);class Te extends _e{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&fi(e,this.from,this.to)?fe.fail("Structure replace would overwrite content"):fe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ke([this.from,this.to-this.from,this.slice.size])}invert(e){return new Te(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Te(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Te)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?O.empty:new O(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Te(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?O.empty:new O(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Te(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Te(t.from,t.to,O.fromJSON(e,t.slice),!!t.structure)}}_e.jsonID("replace",Te);class be extends _e{constructor(e,t,r,s,a,o,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=a,this.insert=o,this.structure=l}apply(e){if(this.structure&&(fi(e,this.from,this.gapFrom)||fi(e,this.gapTo,this.to)))return fe.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return fe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?fe.fromReplace(e,this.from,this.to,r):fe.fail("Content does not fit in gap")}getMap(){return new Ke([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new be(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=e.map(this.gapFrom,-1),a=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||a>r.pos?null:new be(t.pos,r.pos,s,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new be(t.from,t.to,t.gapFrom,t.gapTo,O.fromJSON(e,t.slice),t.insert,!!t.structure)}}_e.jsonID("replaceAround",be);function fi(n,e,t){let r=n.resolve(e),s=t-e,a=r.depth;for(;s>0&&a>0&&r.indexAfter(a)==r.node(a).childCount;)a--,s--;if(s>0){let o=r.node(a).maybeChild(r.indexAfter(a));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function o0(n,e,t,r){let s=[],a=[],o,l;n.doc.nodesBetween(e,t,(c,d,h)=>{if(!c.isInline)return;let f=c.marks;if(!r.isInSet(f)&&h.type.allowsMarkType(r.type)){let p=Math.max(d,e),m=Math.min(d+c.nodeSize,t),b=r.addToSet(f);for(let y=0;y<f.length;y++)f[y].isInSet(b)||(o&&o.to==p&&o.mark.eq(f[y])?o.to=m:s.push(o=new ut(p,m,f[y])));l&&l.to==p?l.to=m:a.push(l=new At(p,m,r))}}),s.forEach(c=>n.step(c)),a.forEach(c=>n.step(c))}function l0(n,e,t,r){let s=[],a=0;n.doc.nodesBetween(e,t,(o,l)=>{if(!o.isInline)return;a++;let c=null;if(r instanceof fs){let d=o.marks,h;for(;h=r.isInSet(d);)(c||(c=[])).push(h),d=h.removeFromSet(d)}else r?r.isInSet(o.marks)&&(c=[r]):c=o.marks;if(c&&c.length){let d=Math.min(l+o.nodeSize,t);for(let h=0;h<c.length;h++){let f=c[h],p;for(let m=0;m<s.length;m++){let b=s[m];b.step==a-1&&f.eq(s[m].style)&&(p=b)}p?(p.to=d,p.step=a):s.push({style:f,from:Math.max(l,e),to:d,step:a})}}}),s.forEach(o=>n.step(new ut(o.from,o.to,o.style)))}function c0(n,e,t,r=t.contentMatch){let s=n.doc.nodeAt(e),a=[],o=e+1;for(let l=0;l<s.childCount;l++){let c=s.child(l),d=o+c.nodeSize,h=r.matchType(c.type);if(!h)a.push(new Te(o,d,O.empty));else{r=h;for(let f=0;f<c.marks.length;f++)t.allowsMarkType(c.marks[f].type)||n.step(new ut(o,d,c.marks[f]))}o=d}if(!r.validEnd){let l=r.fillBefore(N.empty,!0);n.replace(o,o,new O(l,0,0))}for(let l=a.length-1;l>=0;l--)n.step(a[l])}function d0(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Un(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),a=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(a,o,t))return r;if(r==0||s.type.spec.isolating||!d0(s,a,o))break}return null}function u0(n,e,t){let{$from:r,$to:s,depth:a}=e,o=r.before(a+1),l=s.after(a+1),c=o,d=l,h=N.empty,f=0;for(let b=a,y=!1;b>t;b--)y||r.index(b)>0?(y=!0,h=N.from(r.node(b).copy(h)),f++):c--;let p=N.empty,m=0;for(let b=a,y=!1;b>t;b--)y||s.after(b+1)<s.end(b)?(y=!0,p=N.from(s.node(b).copy(p)),m++):d++;n.step(new be(c,d,o,l,new O(h.append(p),f,m),h.size-f,!0))}function ea(n,e,t=null,r=n){let s=h0(n,e),a=s&&f0(r,e);return a?s.map(Wa).concat({type:e,attrs:t}).concat(a.map(Wa)):null}function Wa(n){return{type:n,attrs:null}}function h0(n,e){let{parent:t,startIndex:r,endIndex:s}=n,a=t.contentMatchAt(r).findWrapping(e);if(!a)return null;let o=a.length?a[0]:e;return t.canReplaceWith(r,s,o)?a:null}function f0(n,e){let{parent:t,startIndex:r,endIndex:s}=n,a=t.child(r),o=e.contentMatch.findWrapping(a.type);if(!o)return null;let c=(o.length?o[o.length-1]:e).contentMatch;for(let d=r;c&&d<s;d++)c=c.matchType(t.child(d).type);return!c||!c.validEnd?null:o}function p0(n,e,t){let r=N.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let l=t[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=N.from(t[o].type.create(t[o].attrs,r))}let s=e.start,a=e.end;n.step(new be(s,a,s,a,new O(r,0,0),t.length,!0))}function m0(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=n.steps.length;n.doc.nodesBetween(e,t,(o,l)=>{if(o.isTextblock&&!o.hasMarkup(r,s)&&g0(n.doc,n.mapping.slice(a).map(l),r)){n.clearIncompatible(n.mapping.slice(a).map(l,1),r);let c=n.mapping.slice(a),d=c.map(l,1),h=c.map(l+o.nodeSize,1);return n.step(new be(d,h,d+1,h-1,new O(N.from(r.create(s,null,o.marks)),0,0),1,!0)),!1}})}function g0(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function b0(n,e,t,r,s){let a=n.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");t||(t=a.type);let o=t.create(r,null,s||a.marks);if(a.isLeaf)return n.replaceWith(e,e+a.nodeSize,o);if(!t.validContent(a.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new be(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new O(N.from(o),0,0),1,!0))}function En(n,e,t=1,r){let s=n.resolve(e),a=s.depth-t,o=r&&r[r.length-1]||s.parent;if(a<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let d=s.depth-1,h=t-2;d>a;d--,h--){let f=s.node(d),p=s.index(d);if(f.type.spec.isolating)return!1;let m=f.content.cutByIndex(p,f.childCount),b=r&&r[h]||f;if(b!=f&&(m=m.replaceChild(0,b.type.create(b.attrs))),!f.canReplace(p+1,f.childCount)||!b.type.validContent(m))return!1}let l=s.indexAfter(a),c=r&&r[0];return s.node(a).canReplaceWith(l,l,c?c.type:s.node(a+1).type)}function y0(n,e,t=1,r){let s=n.doc.resolve(e),a=N.empty,o=N.empty;for(let l=s.depth,c=s.depth-t,d=t-1;l>c;l--,d--){a=N.from(s.node(l).copy(a));let h=r&&r[d];o=N.from(h?h.type.create(h.attrs,o):s.node(l).copy(o))}n.step(new Te(e,e,new O(a.append(o),t,t),!0))}function Wn(n,e){let t=n.resolve(e),r=t.index();return v0(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function v0(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function x0(n,e,t){let r=new Te(e-t,e+t,O.empty,!0);n.step(r)}function S0(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let a=r.index(s);if(r.node(s).canReplaceWith(a,a,t))return r.before(s+1);if(a>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,t))return r.after(s+1);if(a<r.node(s).childCount)return null}return null}function k0(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let a=0;a<t.openStart;a++)s=s.firstChild.content;for(let a=1;a<=(t.openStart==0&&t.size?2:1);a++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,c=r.index(o)+(l>0?1:0),d=r.node(o),h=!1;if(a==1)h=d.canReplace(c,c,s);else{let f=d.contentMatchAt(c).findWrapping(s.firstChild.type);h=f&&d.canReplaceWith(c,c,f[0])}if(h)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function ta(n,e,t=e,r=O.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),a=n.resolve(t);return Gc(s,a,r)?new Te(e,t,r):new w0(s,a,r).fit()}function Gc(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class w0{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=N.empty;for(let s=0;s<=e.depth;s++){let a=e.node(s);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=N.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let a=this.placed,o=r.depth,l=s.depth;for(;o&&l&&a.childCount==1;)a=a.firstChild.content,o--,l--;let c=new O(a,o,l);return e>-1?new be(r.pos,e,this.$to.pos,this.$to.end(),c,t):c.size||r.pos!=this.$to.pos?new Te(r.pos,s.pos,c):null}findFittable(){for(let e=1;e<=2;e++)for(let t=this.unplaced.openStart;t>=0;t--){let r,s=null;t?(s=_s(this.unplaced.content,t-1).firstChild,r=s.content):r=this.unplaced.content;let a=r.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:c}=this.frontier[o],d,h=null;if(e==1&&(a?c.matchType(a.type)||(h=c.fillBefore(N.from(a),!1)):s&&l.compatibleContent(s.type)))return{sliceDepth:t,frontierDepth:o,parent:s,inject:h};if(e==2&&a&&(d=c.findWrapping(a.type)))return{sliceDepth:t,frontierDepth:o,parent:s,wrap:d};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=_s(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new O(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=_s(e,t);if(s.childCount<=1&&t>0){let a=e.size-t<=t+s.size;this.unplaced=new O(Yn(e,t-1,1),t-1,a?t-1:r)}else this.unplaced=new O(Yn(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:a}){for(;this.depth>t;)this.closeFrontierNode();if(a)for(let y=0;y<a.length;y++)this.openFrontierNode(a[y]);let o=this.unplaced,l=r?r.content:o.content,c=o.openStart-e,d=0,h=[],{match:f,type:p}=this.frontier[t];if(s){for(let y=0;y<s.childCount;y++)h.push(s.child(y));f=f.matchFragment(s)}let m=l.size+e-(o.content.size-o.openEnd);for(;d<l.childCount;){let y=l.child(d),x=f.matchType(y.type);if(!x)break;d++,(d>1||c==0||y.content.size)&&(f=x,h.push(Qc(y.mark(p.allowedMarks(y.marks)),d==1?c:0,d==l.childCount?m:-1)))}let b=d==l.childCount;b||(m=-1),this.placed=Xn(this.placed,t,N.from(h)),this.frontier[t].match=f,b&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,x=l;y<m;y++){let k=x.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),x=k.content}this.unplaced=b?e==0?O.empty:new O(Yn(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new O(Yn(o.content,e,d),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Bs(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],a=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Bs(e,t,s,r,a);if(!!o){for(let l=t-1;l>=0;l--){let{match:c,type:d}=this.frontier[l],h=Bs(e,l,d,c,!0);if(!h||h.childCount)continue e}return{depth:t,fit:o,move:a?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Xn(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),a=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,a)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=Xn(this.placed,this.depth,N.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(N.empty,!0);t.childCount&&(this.placed=Xn(this.placed,this.frontier.length,t))}}function Yn(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Yn(n.firstChild.content,e-1,t)))}function Xn(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Xn(n.lastChild.content,e-1,t)))}function _s(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Qc(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Qc(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(N.empty,!0)))),n.copy(r)}function Bs(n,e,t,r,s){let a=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==a.childCount&&!t.compatibleContent(a.type))return null;let l=r.fillBefore(a.content,!0,o);return l&&!C0(t,a.content,o)?l:null}function C0(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function N0(n){return n.spec.defining||n.spec.definingForContent}function M0(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),a=n.doc.resolve(t);if(Gc(s,a,r))return n.step(new Te(e,t,r));let o=Xc(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let l=-(s.depth+1);o.unshift(l);for(let p=s.depth,m=s.pos-1;p>0;p--,m--){let b=s.node(p).type.spec;if(b.defining||b.definingAsContext||b.isolating)break;o.indexOf(p)>-1?l=p:s.before(p)==m&&o.splice(1,0,-p)}let c=o.indexOf(l),d=[],h=r.openStart;for(let p=r.content,m=0;;m++){let b=p.firstChild;if(d.push(b),m==r.openStart)break;p=b.content}for(let p=h-1;p>=0;p--){let m=d[p].type,b=N0(m);if(b&&s.node(c).type!=m)h=p;else if(b||!m.isTextblock)break}for(let p=r.openStart;p>=0;p--){let m=(p+h+1)%(r.openStart+1),b=d[m];if(!!b)for(let y=0;y<o.length;y++){let x=o[(y+c)%o.length],k=!0;x<0&&(k=!1,x=-x);let M=s.node(x-1),T=s.index(x-1);if(M.canReplaceWith(T,T,b.type,b.marks))return n.replace(s.before(x),k?a.after(x):t,new O(Yc(r.content,0,r.openStart,m),m,r.openEnd))}}let f=n.steps.length;for(let p=o.length-1;p>=0&&(n.replace(e,t,r),!(n.steps.length>f));p--){let m=o[p];m<0||(e=s.before(m),t=a.after(m))}}function Yc(n,e,t,r,s){if(e<t){let a=n.firstChild;n=n.replaceChild(0,a.copy(Yc(a.content,e+1,t,r,a)))}if(e>r){let a=s.contentMatchAt(0),o=a.fillBefore(n).append(n);n=o.append(a.matchFragment(o).fillBefore(N.empty,!0))}return n}function T0(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=S0(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new O(N.from(r),0,0))}function E0(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),a=Xc(r,s);for(let o=0;o<a.length;o++){let l=a[o],c=o==a.length-1;if(c&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),s.end(l));if(l>0&&(c||r.node(l-1).canReplace(r.index(l-1),s.indexAfter(l-1))))return n.delete(r.before(l),s.after(l))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function Xc(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let a=n.start(s);if(a<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(a==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==a-1)&&t.push(s)}return t}class On extends _e{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return fe.fail("No node at attribute step's position");let r=Object.create(null);for(let a in t.attrs)r[a]=t.attrs[a];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return fe.fromReplace(e,this.pos,this.pos+1,new O(N.from(s),0,t.isLeaf?0:1))}getMap(){return Ke.empty}invert(e){return new On(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new On(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new On(t.pos,t.attr,t.value)}}_e.jsonID("attr",On);let Rn=class extends Error{};Rn=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Rn.prototype=Object.create(Error.prototype);Rn.prototype.constructor=Rn;Rn.prototype.name="TransformError";class Zc{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new sr}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Rn(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=O.empty){let s=ta(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new O(N.from(r),0,0))}delete(e,t){return this.replace(e,t,O.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return M0(this,e,t,r),this}replaceRangeWith(e,t,r){return T0(this,e,t,r),this}deleteRange(e,t){return E0(this,e,t),this}lift(e,t){return u0(this,e,t),this}join(e,t=1){return x0(this,e,t),this}wrap(e,t){return p0(this,e,t),this}setBlockType(e,t=e,r,s=null){return m0(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s=[]){return b0(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new On(e,t,r)),this}addNodeMark(e,t){return this.step(new It(e,t)),this}removeNodeMark(e,t){if(!(t instanceof X)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Pn(e,t)),this}split(e,t=1,r){return y0(this,e,t,r),this}addMark(e,t,r){return o0(this,e,t,r),this}removeMark(e,t,r){return l0(this,e,t,r),this}clearIncompatible(e,t,r){return c0(this,e,t,r),this}}const $s=Object.create(null);class V{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new O0(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=O.empty){let r=t.content.lastChild,s=null;for(let l=0;l<t.openEnd;l++)s=r,r=r.lastChild;let a=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:c,$to:d}=o[l],h=e.mapping.slice(a);e.replaceRange(h.map(c.pos),h.map(d.pos),l?O.empty:t),l==0&&Ka(e,a,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:o,$to:l}=s[a],c=e.mapping.slice(r),d=c.map(o.pos),h=c.map(l.pos);a?e.deleteRange(d,h):(e.replaceRangeWith(d,h,t),Ka(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new J(e):Sn(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let a=e.depth-1;a>=0;a--){let o=t<0?Sn(e.node(0),e.node(a),e.before(a+1),e.index(a),t,r):Sn(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new tt(e.node(0))}static atStart(e){return Sn(e,e,0,0,1)||new tt(e)}static atEnd(e){return Sn(e,e,e.content.size,e.childCount,-1)||new tt(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=$s[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in $s)throw new RangeError("Duplicate use of selection JSON ID "+e);return $s[e]=t,t.prototype.jsonID=e,t}getBookmark(){return J.between(this.$anchor,this.$head).getBookmark()}}V.prototype.visible=!0;class O0{constructor(e,t){this.$from=e,this.$to=t}}let ja=!1;function Ja(n){!ja&&!n.parent.inlineContent&&(ja=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class J extends V{constructor(e,t=e){Ja(e),Ja(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return V.near(r);let s=e.resolve(t.map(this.anchor));return new J(s.parent.inlineContent?s:r,r)}replace(e,t=O.empty){if(super.replace(e,t),t==O.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof J&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new ps(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new J(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let a=V.findFrom(t,r,!0)||V.findFrom(t,-r,!0);if(a)t=a.$head;else return V.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(V.findFrom(e,-r,!0)||V.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new J(e,t)}}V.jsonID("text",J);class ps{constructor(e,t){this.anchor=e,this.head=t}map(e){return new ps(e.map(this.anchor),e.map(this.head))}resolve(e){return J.between(e.resolve(this.anchor),e.resolve(this.head))}}class L extends V{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),a=e.resolve(s);return r?V.near(a):new L(a)}content(){return new O(N.from(this.node),0,0)}eq(e){return e instanceof L&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new na(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new L(e.resolve(t.anchor))}static create(e,t){return new L(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}L.prototype.visible=!1;V.jsonID("node",L);class na{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new ps(r,r):new na(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&L.isSelectable(r)?new L(t):V.near(t)}}class tt extends V{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=O.empty){if(t==O.empty){e.delete(0,e.doc.content.size);let r=V.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new tt(e)}map(e){return new tt(e)}eq(e){return e instanceof tt}getBookmark(){return A0}}V.jsonID("all",tt);const A0={map(){return this},resolve(n){return new tt(n)}};function Sn(n,e,t,r,s,a=!1){if(e.inlineContent)return J.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let l=e.child(o);if(l.isAtom){if(!a&&L.isSelectable(l))return L.create(n,t-(s<0?l.nodeSize:0))}else{let c=Sn(n,l,t+s,s<0?l.childCount:0,s,a);if(c)return c}t+=l.nodeSize*s}return null}function Ka(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof Te||s instanceof be))return;let a=n.mapping.maps[r],o;a.forEach((l,c,d,h)=>{o==null&&(o=h)}),n.setSelection(V.near(n.doc.resolve(o),t))}const Ga=1,zr=2,Qa=4;class I0 extends Zc{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Ga)&~zr,this.storedMarks=null,this}get selectionSet(){return(this.updated&Ga)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=zr,this}ensureMarks(e){return X.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&zr)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~zr,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||X.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r==null?t:r,!e)return this.deleteRange(t,r);let a=this.storedMarks;if(!a){let o=this.doc.resolve(t);a=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,a)),this.selection.empty||this.setSelection(V.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Qa,this}get scrolledIntoView(){return(this.updated&Qa)>0}}function Ya(n,e){return!e||!n?n:n.bind(e)}class Zn{constructor(e,t,r){this.name=e,this.init=Ya(t.init,r),this.apply=Ya(t.apply,r)}}const D0=[new Zn("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Zn("selection",{init(n,e){return n.selection||V.atStart(e.doc)},apply(n){return n.selection}}),new Zn("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Zn("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Vs{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=D0.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Zn(r.key,r.spec.state,r))})}}class wn{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let a=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let c=s?s[o].n:0,d=s?s[o].state:this,h=c<t.length&&l.spec.appendTransaction.call(l,c?t.slice(c):t,d,r);if(h&&r.filterTransaction(h,o)){if(h.setMeta("appendedTransaction",e),!s){s=[];for(let f=0;f<this.config.plugins.length;f++)s.push(f<o?{state:r,n:t.length}:{state:this,n:0})}t.push(h),r=r.applyInner(h),a=!0}s&&(s[o]={state:r,n:t.length})}}if(!a)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new wn(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let a=r[s];t[a.name]=a.apply(e,this[a.name],this,t)}return t}get tr(){return new I0(this)}static create(e){let t=new Vs(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new wn(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new Vs(this.schema,e.plugins),r=t.fields,s=new wn(t);for(let a=0;a<r.length;a++){let o=r[a].name;s[o]=this.hasOwnProperty(o)?this[o]:r[a].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],a=s.spec.state;a&&a.toJSON&&(t[r]=a.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Vs(e.schema,e.plugins),a=new wn(s);return s.fields.forEach(o=>{if(o.name=="doc")a.doc=ft.fromJSON(e.schema,t.doc);else if(o.name=="selection")a.selection=V.fromJSON(a.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(a.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let c=r[l],d=c.spec.state;if(c.key==o.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){a[o.name]=d.fromJSON.call(c,e,t[l],a);return}}a[o.name]=o.init(e,a)}}),a}}function ed(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=ed(s,e,{})),t[r]=s}return t}class Ut{constructor(e){this.spec=e,this.props={},e.props&&ed(e.props,this,this.props),this.key=e.key?e.key.key:td("plugin")}getState(e){return e[this.key]}}const Hs=Object.create(null);function td(n){return n in Hs?n+"$"+ ++Hs[n]:(Hs[n]=0,n+"$")}class Cr{constructor(e="key"){this.key=td(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const $e=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},hr=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Xa=null;const xt=function(n,e,t){let r=Xa||(Xa=document.createRange());return r.setEnd(n,t==null?n.nodeValue.length:t),r.setStart(n,e||0),r},on=function(n,e,t,r){return t&&(Za(n,e,t,r,-1)||Za(n,e,t,r,1))},z0=/^(img|br|input|textarea|hr)$/i;function Za(n,e,t,r,s){for(;;){if(n==t&&e==r)return!0;if(e==(s<0?0:lt(n))){let a=n.parentNode;if(!a||a.nodeType!=1||R0(n)||z0.test(n.nodeName)||n.contentEditable=="false")return!1;e=$e(n)+(s<0?0:1),n=a}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.contentEditable=="false")return!1;e=s<0?lt(n):0}else return!1}}function lt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function P0(n,e,t){for(let r=e==0,s=e==lt(n);r||s;){if(n==t)return!0;let a=$e(n);if(n=n.parentNode,!n)return!1;r=r&&a==0,s=s&&a==lt(n)}}function R0(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const ms=function(n){return n.focusNode&&on(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Cn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function F0(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}const _t=typeof navigator<"u"?navigator:null,eo=typeof document<"u"?document:null,Wt=_t&&_t.userAgent||"",pi=/Edge\/(\d+)/.exec(Wt),nd=/MSIE \d/.exec(Wt),mi=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Wt),Re=!!(nd||mi||pi),Ft=nd?document.documentMode:mi?+mi[1]:pi?+pi[1]:0,rt=!Re&&/gecko\/(\d+)/i.test(Wt);rt&&+(/Firefox\/(\d+)/.exec(Wt)||[0,0])[1];const gi=!Re&&/Chrome\/(\d+)/.exec(Wt),Pe=!!gi,L0=gi?+gi[1]:0,Ae=!Re&&!!_t&&/Apple Computer/.test(_t.vendor),Fn=Ae&&(/Mobile\/\w+/.test(Wt)||!!_t&&_t.maxTouchPoints>2),Je=Fn||(_t?/Mac/.test(_t.platform):!1),ct=/Android \d/.test(Wt),gs=!!eo&&"webkitFontSmoothing"in eo.documentElement.style,_0=gs?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function B0(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Tt(n,e){return typeof n=="number"?n:n[e]}function $0(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function to(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,a=n.dom.ownerDocument;for(let o=t||n.dom;o;o=hr(o)){if(o.nodeType!=1)continue;let l=o,c=l==a.body,d=c?B0(a):$0(l),h=0,f=0;if(e.top<d.top+Tt(r,"top")?f=-(d.top-e.top+Tt(s,"top")):e.bottom>d.bottom-Tt(r,"bottom")&&(f=e.bottom-d.bottom+Tt(s,"bottom")),e.left<d.left+Tt(r,"left")?h=-(d.left-e.left+Tt(s,"left")):e.right>d.right-Tt(r,"right")&&(h=e.right-d.right+Tt(s,"right")),h||f)if(c)a.defaultView.scrollBy(h,f);else{let p=l.scrollLeft,m=l.scrollTop;f&&(l.scrollTop+=f),h&&(l.scrollLeft+=h);let b=l.scrollLeft-p,y=l.scrollTop-m;e={left:e.left-b,top:e.top-y,right:e.right-b,bottom:e.bottom-y}}if(c)break}}function V0(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let a=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=n.root.elementFromPoint(a,o);if(!l||l==n.dom||!n.dom.contains(l))continue;let c=l.getBoundingClientRect();if(c.top>=t-20){r=l,s=c.top;break}}return{refDOM:r,refTop:s,stack:rd(n.dom)}}function rd(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=hr(r));return e}function H0({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;sd(t,r==0?0:r-e)}function sd(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:a}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=a&&(r.scrollLeft=a)}}let xn=null;function q0(n){if(n.setActive)return n.setActive();if(xn)return n.focus(xn);let e=rd(n);n.focus(xn==null?{get preventScroll(){return xn={preventScroll:!0},!0}}:void 0),xn||(xn=!1,sd(e,0))}function id(n,e){let t,r=2e8,s,a=0,o=e.top,l=e.top;for(let c=n.firstChild,d=0;c;c=c.nextSibling,d++){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=xt(c).getClientRects();else continue;for(let f=0;f<h.length;f++){let p=h[f];if(p.top<=o&&p.bottom>=l){o=Math.max(p.bottom,o),l=Math.min(p.top,l);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=c,r=m,s=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,c.nodeType==1&&m&&(a=d+(e.left>=(p.left+p.right)/2?1:0));continue}}!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(a=d+1)}}return t&&t.nodeType==3?U0(t,s):!t||r&&t.nodeType==1?{node:n,offset:a}:id(t,s)}function U0(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let a=Et(r,1);if(a.top!=a.bottom&&ra(e,a))return{node:n,offset:s+(e.left>=(a.left+a.right)/2?1:0)}}return{node:n,offset:0}}function ra(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function W0(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function j0(n,e,t){let{node:r,offset:s}=id(e,t),a=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();a=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,a)}function J0(n,e,t,r){let s=-1;for(let a=e;a!=n.dom;){let o=n.docView.nearestDesc(a,!0);if(!o)return null;if(o.node.isBlock&&o.parent){let l=o.dom.getBoundingClientRect();if(l.left>r.left||l.top>r.top)s=o.posBefore;else if(l.right<r.left||l.bottom<r.top)s=o.posAfter;else break}a=o.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,1)}function ad(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),a=s;;){let o=n.childNodes[a];if(o.nodeType==1){let l=o.getClientRects();for(let c=0;c<l.length;c++){let d=l[c];if(ra(e,d))return ad(o,e,d)}}if((a=(a+1)%r)==s)break}return n}function K0(n,e){let t=n.dom.ownerDocument,r,s=0;if(t.caretPositionFromPoint)try{let c=t.caretPositionFromPoint(e.left,e.top);c&&({offsetNode:r,offset:s}=c)}catch{}if(!r&&t.caretRangeFromPoint){let c=t.caretRangeFromPoint(e.left,e.top);c&&({startContainer:r,startOffset:s}=c)}let a=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),o;if(!a||!n.dom.contains(a.nodeType!=1?a.parentNode:a)){let c=n.dom.getBoundingClientRect();if(!ra(e,c)||(a=ad(n.dom,e,c),!a))return null}if(Ae)for(let c=a;r&&c;c=hr(c))c.draggable&&(r=void 0);if(a=W0(a,e),r){if(rt&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let c=r.childNodes[s],d;c.nodeName=="IMG"&&(d=c.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&s++}r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?o=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(o=J0(n,r,s,e))}o==null&&(o=j0(n,a,e));let l=n.docView.nearestDesc(a,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function Et(n,e){let t=n.getClientRects();return t.length?t[e<0?0:t.length-1]:n.getBoundingClientRect()}const G0=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function od(n,e,t){let{node:r,offset:s,atom:a}=n.docView.domFromPos(e,t<0?-1:1),o=gs||rt;if(r.nodeType==3)if(o&&(G0.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let c=Et(xt(r,s,s),t);if(rt&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let d=Et(xt(r,s-1,s-1),-1);if(d.top==c.top){let h=Et(xt(r,s,s+1),-1);if(h.top!=c.top)return Qn(h,h.left<d.left)}}return c}else{let c=s,d=s,h=t<0?1:-1;return t<0&&!s?(d++,h=-1):t>=0&&s==r.nodeValue.length?(c--,h=1):t<0?c--:d++,Qn(Et(xt(r,c,d),1),h<0)}if(!n.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&s&&(t<0||s==lt(r))){let c=r.childNodes[s-1];if(c.nodeType==1)return qs(c.getBoundingClientRect(),!1)}if(a==null&&s<lt(r)){let c=r.childNodes[s];if(c.nodeType==1)return qs(c.getBoundingClientRect(),!0)}return qs(r.getBoundingClientRect(),t>=0)}if(a==null&&s&&(t<0||s==lt(r))){let c=r.childNodes[s-1],d=c.nodeType==3?xt(c,lt(c)-(o?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(d)return Qn(Et(d,1),!1)}if(a==null&&s<lt(r)){let c=r.childNodes[s];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let d=c?c.nodeType==3?xt(c,0,o?0:1):c.nodeType==1?c:null:null;if(d)return Qn(Et(d,-1),!0)}return Qn(Et(r.nodeType==3?xt(r):r,-t),t>=0)}function Qn(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function qs(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function ld(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function Q0(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return ld(n,e,()=>{let{node:a}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(a,!0);if(!l)break;if(l.node.isBlock){a=l.dom;break}a=l.dom.parentNode}let o=od(n,s.pos,1);for(let l=a.firstChild;l;l=l.nextSibling){let c;if(l.nodeType==1)c=l.getClientRects();else if(l.nodeType==3)c=xt(l,0,l.nodeValue.length).getClientRects();else continue;for(let d=0;d<c.length;d++){let h=c[d];if(h.bottom>h.top+1&&(t=="up"?o.top-h.top>(h.bottom-o.top)*2:h.bottom-o.bottom>(o.bottom-h.top)*2))return!1}}return!0})}const Y0=/[\u0590-\u08ac]/;function X0(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,a=!s,o=s==r.parent.content.size,l=n.domSelection();return!Y0.test(r.parent.textContent)||!l.modify?t=="left"||t=="backward"?a:o:ld(n,e,()=>{let{focusNode:c,focusOffset:d,anchorNode:h,anchorOffset:f}=n.domSelectionRange(),p=l.caretBidiLevel;l.modify("move",t,"character");let m=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:b,focusOffset:y}=n.domSelectionRange(),x=b&&!m.contains(b.nodeType==1?b:b.parentNode)||c==b&&d==y;try{l.collapse(h,f),c&&(c!=h||d!=f)&&l.extend&&l.extend(c,d)}catch{}return p!=null&&(l.caretBidiLevel=p),x})}let no=null,ro=null,so=!1;function Z0(n,e,t){return no==e&&ro==t?so:(no=e,ro=t,so=t=="up"||t=="down"?Q0(n,e,t):X0(n,e,t))}const nt=0,io=1,Nn=2,gt=3;class Nr{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=nt,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let a,o;if(e==this.contentDOM)a=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((o=a.pmViewDesc)&&o.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(o)+o.size:this.posAtStart}else{let a,o;if(e==this.contentDOM)a=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((o=a.pmViewDesc)&&o.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>$e(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!1;break}if(a.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){s=!0;break}if(a.nextSibling)break}}return(s==null?r>0:s)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let a=this.getDesc(s),o;if(a&&(!t||a.node))if(r&&(o=a.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return a}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let a=this.getDesc(s);if(a)return a.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],a=r+s.size;if(r==e&&a!=r){for(;!s.border&&s.children.length;)s=s.children[0];return s}if(e<a)return s.descAt(e-r-s.border);r=a}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let a=0;r<this.children.length;r++){let o=this.children[r],l=a+o.size;if(l>e||o instanceof dd){s=e-a;break}a=l}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let a;r&&!(a=this.children[r-1]).size&&a instanceof cd&&a.side>=0;r--);if(t<=0){let a,o=!0;for(;a=r?this.children[r-1]:null,!(!a||a.dom.parentNode==this.contentDOM);r--,o=!1);return a&&t&&o&&!a.border&&!a.domAtom?a.domFromPos(a.size,t):{node:this.contentDOM,offset:a?$e(a.dom)+1:0}}else{let a,o=!0;for(;a=r<this.children.length?this.children[r]:null,!(!a||a.dom.parentNode==this.contentDOM);r++,o=!1);return a&&o&&!a.border&&!a.domAtom?a.domFromPos(0,t):{node:this.contentDOM,offset:a?$e(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,a=-1;for(let o=r,l=0;;l++){let c=this.children[l],d=o+c.size;if(s==-1&&e<=d){let h=o+c.border;if(e>=h&&t<=d-c.border&&c.node&&c.contentDOM&&this.contentDOM.contains(c.contentDOM))return c.parseRange(e,t,h);e=o;for(let f=l;f>0;f--){let p=this.children[f-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){s=$e(p.dom)+1;break}e-=p.size}s==-1&&(s=0)}if(s>-1&&(d>t||l==this.children.length-1)){t=d;for(let h=l+1;h<this.children.length;h++){let f=this.children[h];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){a=$e(f.dom);break}t+=f.size}a==-1&&(a=this.contentDOM.childNodes.length);break}o=d}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let a=Math.min(e,t),o=Math.max(e,t);for(let p=0,m=0;p<this.children.length;p++){let b=this.children[p],y=m+b.size;if(a>m&&o<y)return b.setSelection(e-m-b.border,t-m-b.border,r,s);m=y}let l=this.domFromPos(e,e?-1:1),c=t==e?l:this.domFromPos(t,t?-1:1),d=r.getSelection(),h=!1;if((rt||Ae)&&e==t){let{node:p,offset:m}=l;if(p.nodeType==3){if(h=!!(m&&p.nodeValue[m-1]==`
`),h&&m==p.nodeValue.length)for(let b=p,y;b;b=b.parentNode){if(y=b.nextSibling){y.nodeName=="BR"&&(l=c={node:y.parentNode,offset:$e(y)+1});break}let x=b.pmViewDesc;if(x&&x.node&&x.node.isBlock)break}}else{let b=p.childNodes[m-1];h=b&&(b.nodeName=="BR"||b.contentEditable=="false")}}if(rt&&d.focusNode&&d.focusNode!=c.node&&d.focusNode.nodeType==1){let p=d.focusNode.childNodes[d.focusOffset];p&&p.contentEditable=="false"&&(s=!0)}if(!(s||h&&Ae)&&on(l.node,l.offset,d.anchorNode,d.anchorOffset)&&on(c.node,c.offset,d.focusNode,d.focusOffset))return;let f=!1;if((d.extend||e==t)&&!h){d.collapse(l.node,l.offset);try{e!=t&&d.extend(c.node,c.offset),f=!0}catch{}}if(!f){if(e>t){let m=l;l=c,c=m}let p=document.createRange();p.setEnd(c.node,c.offset),p.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let a=this.children[s],o=r+a.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let l=r+a.border,c=o-a.border;if(e>=l&&t<=c){this.dirty=e==r||t==o?Nn:io,e==l&&t==c&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=gt:a.markDirty(e-l,t-l);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Nn:gt}r=o}this.dirty=Nn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Nn:io;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class cd extends Nr{constructor(e,t,r,s){let a,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)})),!t.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,a=this}matchesWidget(e){return this.dirty==nt&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class e1 extends Nr{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class ln extends Nr{constructor(e,t,r,s){super(e,[],r,s),this.mark=t}static create(e,t,r,s){let a=s.nodeViews[t.type.name],o=a&&a(t,s,r);return(!o||!o.dom)&&(o=dt.renderSpec(document,t.type.spec.toDOM(t,r))),new ln(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&gt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(e){return this.dirty!=gt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=nt){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=nt}}slice(e,t,r){let s=ln.create(this.parent,this.mark,!0,r),a=this.children,o=this.size;t<o&&(a=vi(a,t,o,r)),e>0&&(a=vi(a,0,e,r));for(let l=0;l<a.length;l++)a[l].parent=s;return s.children=a,s}}class cn extends Nr{constructor(e,t,r,s,a,o,l,c,d){super(e,[],a,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=l,o&&this.updateChildren(c,d)}static create(e,t,r,s,a,o){let l=a.nodeViews[t.type.name],c,d=l&&l(t,a,()=>{if(!c)return o;if(c.parent)return c.parent.posBeforeChild(c)},r,s),h=d&&d.dom,f=d&&d.contentDOM;if(t.isText){if(!h)h=document.createTextNode(t.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:f}=dt.renderSpec(document,t.type.spec.toDOM(t)));!f&&!t.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),t.type.spec.draggable&&(h.draggable=!0));let p=h;return h=fd(h,r,t),d?c=new t1(e,t,r,s,h,f||null,p,d,a,o+1):t.isText?new bs(e,t,r,s,h,p,a):new cn(e,t,r,s,h,f||null,p,a,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>N.empty)}return e}matchesNode(e,t,r){return this.dirty==nt&&e.eq(this.node)&&yi(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,a=e.composing?this.localCompositionInfo(e,t):null,o=a&&a.pos>-1?a:null,l=a&&a.pos<0,c=new r1(this,o&&o.node,e);a1(this.node,this.innerDeco,(d,h,f)=>{d.spec.marks?c.syncToMarks(d.spec.marks,r,e):d.type.side>=0&&!f&&c.syncToMarks(h==this.node.childCount?X.none:this.node.child(h).marks,r,e),c.placeWidget(d,e,s)},(d,h,f,p)=>{c.syncToMarks(d.marks,r,e);let m;c.findNodeMatch(d,h,f,p)||l&&e.state.selection.from>s&&e.state.selection.to<s+d.nodeSize&&(m=c.findIndexWithChild(a.node))>-1&&c.updateNodeAt(d,h,f,m,e)||c.updateNextNode(d,h,f,e,p)||c.addNode(d,h,f,e,s),s+=d.nodeSize}),c.syncToMarks([],r,e),this.node.isTextblock&&c.addTextblockHacks(),c.destroyRest(),(c.changed||this.dirty==Nn)&&(o&&this.protectLocalComposition(e,o),ud(this.contentDOM,this.children,e),Fn&&o1(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof J)||r<t||s>t+this.node.content.size)return null;let a=e.domSelectionRange(),o=l1(a.focusNode,a.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let l=o.nodeValue,c=c1(this.node.content,l,r-t,s-t);return c<0?null:{node:o,pos:c,text:l}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let a=t;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let o=new e1(this,a,t,s);e.input.compositionNodes.push(o),this.children=vi(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==gt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=nt}updateOuterDeco(e){if(yi(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=hd(this.dom,this.nodeDOM,bi(this.outerDeco,this.node,t),bi(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function ao(n,e,t,r,s){return fd(r,e,n),new cn(void 0,n,e,t,r,r,r,s,0)}class bs extends cn{constructor(e,t,r,s,a,o,l){super(e,t,r,s,a,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==gt||this.dirty!=nt&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=nt||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=nt,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),a=document.createTextNode(s.text);return new bs(this.parent,s,this.outerDeco,this.innerDeco,a,a,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=gt)}get domAtom(){return!1}}class dd extends Nr{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==nt&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class t1 extends cn{constructor(e,t,r,s,a,o,l,c,d,h){super(e,t,r,s,a,o,l,d,h),this.spec=c}update(e,t,r,s){if(this.dirty==gt)return!1;if(this.spec.update){let a=this.spec.update(e,t,r);return a&&this.updateInner(e,t,r,s),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ud(n,e,t){let r=n.firstChild,s=!1;for(let a=0;a<e.length;a++){let o=e[a],l=o.dom;if(l.parentNode==n){for(;l!=r;)r=oo(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(l,r);if(o instanceof ln){let c=r?r.previousSibling:n.lastChild;ud(o.contentDOM,o.children,t),r=c?c.nextSibling:n.firstChild}}for(;r;)r=oo(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const ir=function(n){n&&(this.nodeName=n)};ir.prototype=Object.create(null);const Qt=[new ir];function bi(n,e,t){if(n.length==0)return Qt;let r=t?Qt[0]:new ir,s=[r];for(let a=0;a<n.length;a++){let o=n[a].type.attrs;if(!!o){o.nodeName&&s.push(r=new ir(o.nodeName));for(let l in o){let c=o[l];c!=null&&(t&&s.length==1&&s.push(r=new ir(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+c:l=="style"?r.style=(r.style?r.style+";":"")+c:l!="nodeName"&&(r[l]=c))}}}return s}function hd(n,e,t,r){if(t==Qt&&r==Qt)return e;let s=e;for(let a=0;a<r.length;a++){let o=r[a],l=t[a];if(a){let c;l&&l.nodeName==o.nodeName&&s!=n&&(c=s.parentNode)&&c.nodeName.toLowerCase()==o.nodeName||(c=document.createElement(o.nodeName),c.pmIsDeco=!0,c.appendChild(s),l=Qt[0]),s=c}n1(s,l||Qt[0],o)}return s}function n1(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let a=0;a<r.length;a++)s.indexOf(r[a])==-1&&n.classList.remove(r[a]);for(let a=0;a<s.length;a++)r.indexOf(s[a])==-1&&n.classList.add(s[a]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function fd(n,e,t){return hd(n,n,Qt,bi(e,t,n.nodeType!=1))}function yi(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function oo(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class r1{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=s1(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,a=this.stack.length>>1,o=Math.min(a,e.length);for(;s<o&&(s==a-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<a;)this.destroyRest(),this.top.dirty=nt,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let c=this.index;c<Math.min(this.index+3,this.top.children.length);c++)if(this.top.children[c].matchesMark(e[a])){l=c;break}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let c=ln.create(this.top,e[a],t,r);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,a++}}findNodeMatch(e,t,r,s){let a=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))a=this.top.children.indexOf(o,this.index);else for(let l=this.index,c=Math.min(this.top.children.length,l+5);l<c;l++){let d=this.top.children[l];if(d.matchesNode(e,t,r)&&!this.preMatch.matched.has(d)){a=l;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,t,r,s,a){let o=this.top.children[s];return o.dirty==gt&&o.dom==o.contentDOM&&(o.dirty=Nn),o.update(e,t,r,a)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,a){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof cn){let c=this.preMatch.matched.get(l);if(c!=null&&c!=a)return!1;let d=l.dom;if(!(this.lock&&(d==this.lock||d.nodeType==1&&d.contains(this.lock.parentNode))&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=gt&&yi(t,l.outerDeco)))&&l.update(e,t,r,s))return this.destroyBetween(this.index,o),l.dom!=d&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(e,t,r,s,a){this.top.children.splice(this.index++,0,cn.create(this.top,e,t,r,s,a)),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let a=new cd(this.top,e,t,r);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof ln;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof bs)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ae||Pe)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new dd(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}}function s1(n,e){let t=e,r=t.children.length,s=n.childCount,a=new Map,o=[];e:for(;s>0;){let l;for(;;)if(r){let d=t.children[r-1];if(d instanceof ln)t=d,r=d.children.length;else{l=d,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let c=l.node;if(!!c){if(c!=n.child(s-1))break;--s,a.set(l,s),o.push(l)}}return{index:s,matched:a,matches:o.reverse()}}function i1(n,e){return n.type.side-e.type.side}function a1(n,e,t,r){let s=e.locals(n),a=0;if(s.length==0){for(let d=0;d<n.childCount;d++){let h=n.child(d);r(h,s,e.forChild(a,h),d),a+=h.nodeSize}return}let o=0,l=[],c=null;for(let d=0;;){if(o<s.length&&s[o].to==a){let b=s[o++],y;for(;o<s.length&&s[o].to==a;)(y||(y=[b])).push(s[o++]);if(y){y.sort(i1);for(let x=0;x<y.length;x++)t(y[x],d,!!c)}else t(b,d,!!c)}let h,f;if(c)f=-1,h=c,c=null;else if(d<n.childCount)f=d,h=n.child(d++);else break;for(let b=0;b<l.length;b++)l[b].to<=a&&l.splice(b--,1);for(;o<s.length&&s[o].from<=a&&s[o].to>a;)l.push(s[o++]);let p=a+h.nodeSize;if(h.isText){let b=p;o<s.length&&s[o].from<b&&(b=s[o].from);for(let y=0;y<l.length;y++)l[y].to<b&&(b=l[y].to);b<p&&(c=h.cut(b-a),h=h.cut(0,b-a),p=b,f=-1)}let m=h.isInline&&!h.isLeaf?l.filter(b=>!b.inline):l.slice();r(h,m,e.forChild(a,h),f),a=p}}function o1(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function l1(n,e){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0){if(n.childNodes.length>e&&n.childNodes[e].nodeType==3)return n.childNodes[e];n=n.childNodes[e-1],e=lt(n)}else if(n.nodeType==1&&e<n.childNodes.length)n=n.childNodes[e],e=0;else return null}}function c1(n,e,t,r){for(let s=0,a=0;s<n.childCount&&a<=r;){let o=n.child(s++),l=a;if(a+=o.nodeSize,!o.isText)continue;let c=o.text;for(;s<n.childCount;){let d=n.child(s++);if(a+=d.nodeSize,!d.isText)break;c+=d.text}if(a>=t){let d=l<r?c.lastIndexOf(e,r-l-1):-1;if(d>=0&&d+e.length+l>=t)return l+d;if(t==r&&c.length>=r+e.length-l&&c.slice(r-l,r-l+e.length)==e)return r}}return-1}function vi(n,e,t,r,s){let a=[];for(let o=0,l=0;o<n.length;o++){let c=n[o],d=l,h=l+=c.size;d>=t||h<=e?a.push(c):(d<e&&a.push(c.slice(0,e-d,r)),s&&(a.push(s),s=void 0),h>t&&a.push(c.slice(t-d,c.size,r)))}return a}function sa(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),a=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let l=r.resolve(o),c,d;if(ms(t)){for(c=l;s&&!s.node;)s=s.parent;let h=s.node;if(s&&h.isAtom&&L.isSelectable(h)&&s.parent&&!(h.isInline&&P0(t.focusNode,t.focusOffset,s.dom))){let f=s.posBefore;d=new L(o==f?l:r.resolve(f))}}else{let h=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(h<0)return null;c=r.resolve(h)}if(!d){let h=e=="pointer"||n.state.selection.head<l.pos&&!a?1:-1;d=ia(n,c,l,h)}return d}function pd(n){return n.editable?n.hasFocus():gd(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function kt(n,e=!1){let t=n.state.selection;if(md(n,t),!!pd(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Pe){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&on(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)u1(n);else{let{anchor:r,head:s}=t,a,o;lo&&!(t instanceof J)&&(t.$from.parent.inlineContent||(a=co(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=co(n,t.to))),n.docView.setSelection(r,s,n.root,e),lo&&(a&&uo(a),o&&uo(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&d1(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const lo=Ae||Pe&&L0<63;function co(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,a=r?t.childNodes[r-1]:null;if(Ae&&s&&s.contentEditable=="false")return Us(s);if((!s||s.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(s)return Us(s);if(a)return Us(a)}}function Us(n){return n.contentEditable="true",Ae&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function uo(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function d1(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!pd(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function u1(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setEnd(r.parentNode,$e(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&Re&&Ft<=11&&(r.disabled=!0,r.disabled=!1)}function md(n,e){if(e instanceof L){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(ho(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else ho(n)}function ho(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function ia(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||J.between(e,t,r)}function fo(n){return n.editable&&!n.hasFocus()?!1:gd(n)}function gd(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function h1(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return on(e.node,e.offset,t.anchorNode,t.anchorOffset)}function xi(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),a=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return a&&V.findFrom(a,e)}function Gt(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function po(n,e,t){let r=n.state.selection;if(r instanceof J){if(!r.empty||t.indexOf("s")>-1)return!1;if(n.endOfTextblock(e>0?"right":"left")){let s=xi(n.state,e);return s&&s instanceof L?Gt(n,s):!1}else if(!(Je&&t.indexOf("m")>-1)){let s=r.$head,a=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!a||a.isText)return!1;let l=e<0?s.pos-a.nodeSize:s.pos;return a.isAtom||(o=n.docView.descAt(l))&&!o.contentDOM?L.isSelectable(a)?Gt(n,new L(e<0?n.state.doc.resolve(s.pos-a.nodeSize):s)):gs?Gt(n,new J(n.state.doc.resolve(e<0?l:l+a.nodeSize))):!1:!1}}else{if(r instanceof L&&r.node.isInline)return Gt(n,new J(e>0?r.$to:r.$from));{let s=xi(n.state,e);return s?Gt(n,s):!1}}}function Qr(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ar(n){let e=n.pmViewDesc;return e&&e.size==0&&(n.nextSibling||n.nodeName!="BR")}function Ws(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,a,o=!1;for(rt&&t.nodeType==1&&r<Qr(t)&&ar(t.childNodes[r])&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(ar(l))s=t,a=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(bd(t))break;{let l=t.previousSibling;for(;l&&ar(l);)s=t.parentNode,a=$e(l),l=l.previousSibling;if(l)t=l,r=Qr(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Si(n,t,r):s&&Si(n,s,a)}function js(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=Qr(t),a,o;for(;;)if(r<s){if(t.nodeType!=1)break;let l=t.childNodes[r];if(ar(l))a=t,o=++r;else break}else{if(bd(t))break;{let l=t.nextSibling;for(;l&&ar(l);)a=l.parentNode,o=$e(l)+1,l=l.nextSibling;if(l)t=l,r=0,s=Qr(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}a&&Si(n,a,o)}function bd(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Si(n,e,t){let r=n.domSelection();if(ms(r)){let a=document.createRange();a.setEnd(e,t),a.setStart(e,t),r.removeAllRanges(),r.addRange(a)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&kt(n)},50)}function mo(n,e,t){let r=n.state.selection;if(r instanceof J&&!r.empty||t.indexOf("s")>-1||Je&&t.indexOf("m")>-1)return!1;let{$from:s,$to:a}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=xi(n.state,e);if(o&&o instanceof L)return Gt(n,o)}if(!s.parent.inlineContent){let o=e<0?s:a,l=r instanceof tt?V.near(o,e):V.findFrom(o,e);return l?Gt(n,l):!1}return!1}function go(n,e){if(!(n.state.selection instanceof J))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(a&&!a.isText){let o=n.state.tr;return e<0?o.delete(t.pos-a.nodeSize,t.pos):o.delete(t.pos,t.pos+a.nodeSize),n.dispatch(o),!0}return!1}function bo(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function f1(n){if(!Ae||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;bo(n,r,"true"),setTimeout(()=>bo(n,r,"false"),20)}return!1}function p1(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function m1(n,e){let t=e.keyCode,r=p1(e);return t==8||Je&&t==72&&r=="c"?go(n,-1)||Ws(n):t==46||Je&&t==68&&r=="c"?go(n,1)||js(n):t==13||t==27?!0:t==37||Je&&t==66&&r=="c"?po(n,-1,r)||Ws(n):t==39||Je&&t==70&&r=="c"?po(n,1,r)||js(n):t==38||Je&&t==80&&r=="c"?mo(n,-1,r)||Ws(n):t==40||Je&&t==78&&r=="c"?f1(n)||mo(n,1,r)||js(n):r==(Je?"m":"c")&&(t==66||t==73||t==89||t==90)}function yd(n,e){n.someProp("transformCopied",m=>{e=m(e,n)});let t=[],{content:r,openStart:s,openEnd:a}=e;for(;s>1&&a>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,a--;let m=r.firstChild;t.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=n.someProp("clipboardSerializer")||dt.fromSchema(n.state.schema),l=Cd(),c=l.createElement("div");c.appendChild(o.serializeFragment(r,{document:l}));let d=c.firstChild,h,f=0;for(;d&&d.nodeType==1&&(h=wd[d.nodeName.toLowerCase()]);){for(let m=h.length-1;m>=0;m--){let b=l.createElement(h[m]);for(;c.firstChild;)b.appendChild(c.firstChild);c.appendChild(b),f++}d=c.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${s} ${a}${f?` -${f}`:""} ${JSON.stringify(t)}`);let p=n.someProp("clipboardTextSerializer",m=>m(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:c,text:p}}function vd(n,e,t,r,s){let a=s.parent.type.spec.code,o,l;if(!t&&!e)return null;let c=e&&(r||a||!t);if(c){if(n.someProp("transformPastedText",p=>{e=p(e,a||r,n)}),a)return e?new O(N.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):O.empty;let f=n.someProp("clipboardTextParser",p=>p(e,s,r,n));if(f)l=f;else{let p=s.marks(),{schema:m}=n.state,b=dt.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let x=o.appendChild(document.createElement("p"));y&&x.appendChild(b.serializeNode(m.text(y,p)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),o=y1(t),gs&&v1(o);let d=o&&o.querySelector("[data-pm-slice]"),h=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let f=+h[3];f>0;f--){let p=o.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;o=p}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||zn.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(c||h),context:s,ruleFromNode(p){return p.nodeName=="BR"&&!p.nextSibling&&p.parentNode&&!g1.test(p.parentNode.nodeName)?{ignore:!0}:null}})),h)l=x1(yo(l,+h[1],+h[2]),h[4]);else if(l=O.maxOpen(b1(l.content,s),!0),l.openStart||l.openEnd){let f=0,p=0;for(let m=l.content.firstChild;f<l.openStart&&!m.type.spec.isolating;f++,m=m.firstChild);for(let m=l.content.lastChild;p<l.openEnd&&!m.type.spec.isolating;p++,m=m.lastChild);l=yo(l,f,p)}return n.someProp("transformPasted",f=>{l=f(l,n)}),l}const g1=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function b1(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),a,o=[];if(n.forEach(l=>{if(!o)return;let c=s.findWrapping(l.type),d;if(!c)return o=null;if(d=o.length&&a.length&&Sd(c,a,l,o[o.length-1],0))o[o.length-1]=d;else{o.length&&(o[o.length-1]=kd(o[o.length-1],a.length));let h=xd(l,c);o.push(h),s=s.matchType(h.type),a=c}}),o)return N.from(o)}return n}function xd(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,N.from(n));return n}function Sd(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let a=Sd(n,e,t,r.lastChild,s+1);if(a)return r.copy(r.content.replaceChild(r.childCount-1,a));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(N.from(xd(t,n,s+1))))}}function kd(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,kd(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(N.empty,!0);return n.copy(t.append(r))}function ki(n,e,t,r,s,a){let o=e<0?n.firstChild:n.lastChild,l=o.content;return s<r-1&&(l=ki(l,e,t,r,s+1,a)),s>=t&&(l=e<0?o.contentMatchAt(0).fillBefore(l,n.childCount>1||a<=s).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(N.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(l))}function yo(n,e,t){return e<n.openStart&&(n=new O(ki(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new O(ki(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const wd={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let vo=null;function Cd(){return vo||(vo=document.implementation.createHTMLDocument("title"))}function y1(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Cd().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&wd[r[1].toLowerCase()])&&(n=s.map(a=>"<"+a+">").join("")+n+s.map(a=>"</"+a+">").reverse().join("")),t.innerHTML=n,s)for(let a=0;a<s.length;a++)t=t.querySelector(s[a])||t;return t}function v1(n){let e=n.querySelectorAll(Pe?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent=="\xA0"&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function x1(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:a,openEnd:o}=n;for(let l=r.length-2;l>=0;l-=2){let c=t.nodes[r[l]];if(!c||c.hasRequiredAttrs())break;s=N.from(c.create(r[l+1],s)),a++,o++}return new O(s,a,o)}const Ie={},De={},S1={touchstart:!0,touchmove:!0};class k1{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function w1(n){for(let e in Ie){let t=Ie[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{N1(n,r)&&!aa(n,r)&&(n.editable||!(r.type in De))&&t(n,r)},S1[e]?{passive:!0}:void 0)}Ae&&n.dom.addEventListener("input",()=>null),wi(n)}function Dt(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function C1(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function wi(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>aa(n,r))})}function aa(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function N1(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function M1(n,e){!aa(n,e)&&Ie[e.type]&&(n.editable||!(e.type in De))&&Ie[e.type](n,e)}De.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Md(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(ct&&Pe&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Fn&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,Cn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||m1(n,t)?t.preventDefault():Dt(n,"key")};De.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};De.keypress=(n,e)=>{let t=e;if(Md(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Je&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof J)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode);n.someProp("handleTextInput",a=>a(n,r.$from.pos,r.$to.pos,s))||n.dispatch(n.state.tr.insertText(s).scrollIntoView()),t.preventDefault()}};function ys(n){return{left:n.clientX,top:n.clientY}}function T1(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function oa(n,e,t,r,s){if(r==-1)return!1;let a=n.state.doc.resolve(r);for(let o=a.depth+1;o>0;o--)if(n.someProp(e,l=>o>a.depth?l(n,t,a.nodeAfter,a.before(o),s,!0):l(n,t,a.node(o),a.before(o),s,!1)))return!0;return!1}function An(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function E1(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&L.isSelectable(r)?(An(n,new L(t),"pointer"),!0):!1}function O1(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof L&&(r=t.node);let a=n.state.doc.resolve(e);for(let o=a.depth+1;o>0;o--){let l=o>a.depth?a.nodeAfter:a.node(o);if(L.isSelectable(l)){r&&t.$from.depth>0&&o>=t.$from.depth&&a.before(t.$from.depth+1)==t.$from.pos?s=a.before(t.$from.depth):s=a.before(o);break}}return s!=null?(An(n,L.create(n.state.doc,s),"pointer"),!0):!1}function A1(n,e,t,r,s){return oa(n,"handleClickOn",e,t,r)||n.someProp("handleClick",a=>a(n,e,r))||(s?O1(n,t):E1(n,t))}function I1(n,e,t,r){return oa(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function D1(n,e,t,r){return oa(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||z1(n,t,r)}function z1(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(An(n,J.create(r,0,r.content.size),"pointer"),!0):!1;let s=r.resolve(e);for(let a=s.depth+1;a>0;a--){let o=a>s.depth?s.nodeAfter:s.node(a),l=s.before(a);if(o.inlineContent)An(n,J.create(r,l+1,l+1+o.content.size),"pointer");else if(L.isSelectable(o))An(n,L.create(r,l),"pointer");else continue;return!0}}function la(n){return Yr(n)}const Nd=Je?"metaKey":"ctrlKey";Ie.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=la(n),s=Date.now(),a="singleClick";s-n.input.lastClick.time<500&&T1(t,n.input.lastClick)&&!t[Nd]&&(n.input.lastClick.type=="singleClick"?a="doubleClick":n.input.lastClick.type=="doubleClick"&&(a="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:a};let o=n.posAtCoords(ys(t));!o||(a=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new P1(n,o,t,!!r)):(a=="doubleClick"?I1:D1)(n,o.pos,o.inside,t)?t.preventDefault():Dt(n,"pointer"))};class P1{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Nd],this.allowDefault=r.shiftKey;let a,o;if(t.inside>-1)a=e.state.doc.nodeAt(t.inside),o=t.inside;else{let h=e.state.doc.resolve(t.pos);a=h.parent,o=h.depth?h.before():0}const l=s?null:r.target,c=l?e.docView.nearestDesc(l,!0):null;this.target=c?c.dom:null;let{selection:d}=e.state;(r.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||d instanceof L&&d.from<=o&&d.to>o)&&(this.mightDrag={node:a,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&rt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Dt(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>kt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(ys(e))),this.updateAllowDefault(e),this.allowDefault||!t?Dt(this.view,"pointer"):A1(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ae&&this.mightDrag&&!this.mightDrag.node.isAtom||Pe&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(An(this.view,V.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):Dt(this.view,"pointer")}move(e){this.updateAllowDefault(e),Dt(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ie.touchstart=n=>{n.input.lastTouch=Date.now(),la(n),Dt(n,"pointer")};Ie.touchmove=n=>{n.input.lastTouch=Date.now(),Dt(n,"pointer")};Ie.contextmenu=n=>la(n);function Md(n,e){return n.composing?!0:Ae&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const R1=ct?5e3:-1;De.compositionstart=De.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Yr(n,!0),n.markCursor=null;else if(Yr(n),rt&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,a=r.focusOffset;s&&s.nodeType==1&&a!=0;){let o=a<0?s.lastChild:s.childNodes[a-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else s=o,a=-1}}n.input.composing=!0}Td(n,R1)};De.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,Td(n,20))};function Td(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Yr(n),e))}function Ed(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=F1());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function F1(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Yr(n,e=!1){if(!(ct&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Ed(n),e||n.docView&&n.docView.dirty){let t=sa(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function L1(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ln=Re&&Ft<15||Fn&&_0<604;Ie.copy=De.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let a=Ln?null:t.clipboardData,o=r.content(),{dom:l,text:c}=yd(n,o);a?(t.preventDefault(),a.clearData(),a.setData("text/html",l.innerHTML),a.setData("text/plain",c)):L1(n,l),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function _1(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function B1(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Ci(n,r.value,null,e):Ci(n,r.textContent,r.innerHTML,e)},50)}function Ci(n,e,t,r){let s=vd(n,e,t,n.input.shiftKey,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,r,s||O.empty)))return!0;if(!s)return!1;let a=_1(s),o=a?n.state.tr.replaceSelectionWith(a,n.input.shiftKey):n.state.tr.replaceSelection(s);return n.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}De.paste=(n,e)=>{let t=e;if(n.composing&&!ct)return;let r=Ln?null:t.clipboardData;r&&Ci(n,r.getData("text/plain"),r.getData("text/html"),t)?t.preventDefault():B1(n,t)};class $1{constructor(e,t){this.slice=e,this.move=t}}const Od=Je?"altKey":"ctrlKey";Ie.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,a=s.empty?null:n.posAtCoords(ys(t));if(!(a&&a.pos>=s.from&&a.pos<=(s instanceof L?s.to-1:s.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(L.create(n.state.doc,r.mightDrag.pos)));else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&n.dispatch(n.state.tr.setSelection(L.create(n.state.doc,d.posBefore)))}}let o=n.state.selection.content(),{dom:l,text:c}=yd(n,o);t.dataTransfer.clearData(),t.dataTransfer.setData(Ln?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ln||t.dataTransfer.setData("text/plain",c),n.dragging=new $1(o,!t[Od])};Ie.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};De.dragover=De.dragenter=(n,e)=>e.preventDefault();De.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(ys(t));if(!s)return;let a=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",b=>{o=b(o,n)}):o=vd(n,t.dataTransfer.getData(Ln?"Text":"text/plain"),Ln?null:t.dataTransfer.getData("text/html"),!1,a);let l=!!(r&&!t[Od]);if(n.someProp("handleDrop",b=>b(n,t,o||O.empty,l))){t.preventDefault();return}if(!o)return;t.preventDefault();let c=o?k0(n.state.doc,a.pos,o):a.pos;c==null&&(c=a.pos);let d=n.state.tr;l&&d.deleteSelection();let h=d.mapping.map(c),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,p=d.doc;if(f?d.replaceRangeWith(h,h,o.content.firstChild):d.replaceRange(h,h,o),d.doc.eq(p))return;let m=d.doc.resolve(h);if(f&&L.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))d.setSelection(new L(m));else{let b=d.mapping.map(c);d.mapping.maps[d.mapping.maps.length-1].forEach((y,x,k,M)=>b=M),d.setSelection(ia(n,m,d.doc.resolve(b)))}n.focus(),n.dispatch(d.setMeta("uiEvent","drop"))};Ie.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&kt(n)},20))};Ie.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Ie.beforeinput=(n,e)=>{if(Pe&&ct&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",a=>a(n,Cn(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in De)Ie[n]=De[n];function fr(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class ca{constructor(e,t){this.toDOM=e,this.spec=t||nn,this.side=this.spec.side||0}map(e,t,r,s){let{pos:a,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new et(a-r,a-r,this)}valid(){return!0}eq(e){return this==e||e instanceof ca&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&fr(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Lt{constructor(e,t){this.attrs=e,this.spec=t||nn}map(e,t,r,s){let a=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return a>=o?null:new et(a,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Lt&&fr(this.attrs,e.attrs)&&fr(this.spec,e.spec)}static is(e){return e.type instanceof Lt}destroy(){}}class da{constructor(e,t){this.attrs=e,this.spec=t||nn}map(e,t,r,s){let a=e.mapResult(t.from+s,1);if(a.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=a.pos?null:new et(a.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),a;return s==t.from&&!(a=e.child(r)).isText&&s+a.nodeSize==t.to}eq(e){return this==e||e instanceof da&&fr(this.attrs,e.attrs)&&fr(this.spec,e.spec)}destroy(){}}class et{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new et(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new et(e,e,new ca(t,r))}static inline(e,t,r,s){return new et(e,t,new Lt(r,s))}static node(e,t,r,s){return new et(e,t,new da(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Lt}}const kn=[],nn={};class ge{constructor(e,t){this.local=e.length?e:kn,this.children=t.length?t:kn}static create(e,t){return t.length?Xr(t,e,0,nn):Ne}find(e,t,r){let s=[];return this.findInner(e==null?0:e,t==null?1e9:t,s,0,r),s}findInner(e,t,r,s,a){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=t&&l.to>=e&&(!a||a(l.spec))&&r.push(l.copy(l.from+s,l.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,t-l,r,s+l,a)}}map(e,t,r){return this==Ne||e.maps.length==0?this:this.mapInner(e,t,0,0,r||nn)}mapInner(e,t,r,s,a){let o;for(let l=0;l<this.local.length;l++){let c=this.local[l].map(e,r,s);c&&c.type.valid(t,c)?(o||(o=[])).push(c):a.onRemove&&a.onRemove(this.local[l].spec)}return this.children.length?V1(this.children,o||[],e,t,r,s,a):o?new ge(o.sort(rn),kn):Ne}add(e,t){return t.length?this==Ne?ge.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,a=0;e.forEach((l,c)=>{let d=c+r,h;if(!!(h=Id(t,l,d))){for(s||(s=this.children.slice());a<s.length&&s[a]<c;)a+=3;s[a]==c?s[a+2]=s[a+2].addInner(l,h,d+1):s.splice(a,0,c,c+l.nodeSize,Xr(h,l,d+1,nn)),a+=3}});let o=Ad(a?Dd(t):t,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new ge(o.length?this.local.concat(o).sort(rn):this.local,s||this.children)}remove(e){return e.length==0||this==Ne?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let a=0;a<r.length;a+=3){let o,l=r[a]+t,c=r[a+1]+t;for(let h=0,f;h<e.length;h++)(f=e[h])&&f.from>l&&f.to<c&&(e[h]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let d=r[a+2].removeInner(o,l+1);d!=Ne?r[a+2]=d:(r.splice(a,3),a-=3)}if(s.length){for(let a=0,o;a<e.length;a++)if(o=e[a])for(let l=0;l<s.length;l++)s[l].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(l--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new ge(s,r):Ne}forChild(e,t){if(this==Ne)return this;if(t.isLeaf)return ge.empty;let r,s;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let a=e+1,o=a+t.content.size;for(let l=0;l<this.local.length;l++){let c=this.local[l];if(c.from<o&&c.to>a&&c.type instanceof Lt){let d=Math.max(a,c.from)-a,h=Math.min(o,c.to)-a;d<h&&(s||(s=[])).push(c.copy(d,h))}}if(s){let l=new ge(s.sort(rn),kn);return r?new Ot([l,r]):l}return r||Ne}eq(e){if(this==e)return!0;if(!(e instanceof ge)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return ua(this.localsInner(e))}localsInner(e){if(this==Ne)return kn;if(e.inlineContent||!this.local.some(Lt.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Lt||t.push(this.local[r]);return t}}ge.empty=new ge([],[]);ge.removeOverlap=ua;const Ne=ge.empty;class Ot{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,nn));return Ot.from(r)}forChild(e,t){if(t.isLeaf)return ge.empty;let r=[];for(let s=0;s<this.members.length;s++){let a=this.members[s].forChild(e,t);a!=Ne&&(a instanceof Ot?r=r.concat(a.members):r.push(a))}return Ot.from(r)}eq(e){if(!(e instanceof Ot)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let a=this.members[s].localsInner(e);if(!!a.length)if(!t)t=a;else{r&&(t=t.slice(),r=!1);for(let o=0;o<a.length;o++)t.push(a[o])}}return t?ua(r?t:t.sort(rn)):kn}static from(e){switch(e.length){case 0:return Ne;case 1:return e[0];default:return new Ot(e.every(t=>t instanceof ge)?e:e.reduce((t,r)=>t.concat(r instanceof ge?r:r.members),[]))}}}function V1(n,e,t,r,s,a,o){let l=n.slice();for(let d=0,h=a;d<t.maps.length;d++){let f=0;t.maps[d].forEach((p,m,b,y)=>{let x=y-b-(m-p);for(let k=0;k<l.length;k+=3){let M=l[k+1];if(M<0||p>M+h-f)continue;let T=l[k]+h-f;m>=T?l[k+1]=p<=T?-2:-1:b>=s&&x&&(l[k]+=x,l[k+1]+=x)}f+=x}),h=t.maps[d].map(h,-1)}let c=!1;for(let d=0;d<l.length;d+=3)if(l[d+1]<0){if(l[d+1]==-2){c=!0,l[d+1]=-1;continue}let h=t.map(n[d]+a),f=h-s;if(f<0||f>=r.content.size){c=!0;continue}let p=t.map(n[d+1]+a,-1),m=p-s,{index:b,offset:y}=r.content.findIndex(f),x=r.maybeChild(b);if(x&&y==f&&y+x.nodeSize==m){let k=l[d+2].mapInner(t,x,h+1,n[d]+a+1,o);k!=Ne?(l[d]=f,l[d+1]=m,l[d+2]=k):(l[d+1]=-2,c=!0)}else c=!0}if(c){let d=H1(l,n,e,t,s,a,o),h=Xr(d,r,0,o);e=h.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,p=0;f<h.children.length;f+=3){let m=h.children[f];for(;p<l.length&&l[p]<m;)p+=3;l.splice(p,0,h.children[f],h.children[f+1],h.children[f+2])}}return new ge(e.sort(rn),l)}function Ad(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new et(s.from+e,s.to+e,s.type))}return t}function H1(n,e,t,r,s,a,o){function l(c,d){for(let h=0;h<c.local.length;h++){let f=c.local[h].map(r,s,d);f?t.push(f):o.onRemove&&o.onRemove(c.local[h].spec)}for(let h=0;h<c.children.length;h+=3)l(c.children[h+2],c.children[h]+d+1)}for(let c=0;c<n.length;c+=3)n[c+1]==-1&&l(n[c+2],e[c]+a+1);return t}function Id(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let a=0,o;a<n.length;a++)(o=n[a])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[a]=null);return s}function Dd(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Xr(n,e,t,r){let s=[],a=!1;e.forEach((l,c)=>{let d=Id(n,l,c+t);if(d){a=!0;let h=Xr(d,l,t+c+1,r);h!=Ne&&s.push(c,c+l.nodeSize,h)}});let o=Ad(a?Dd(n):n,-t).sort(rn);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||s.length?new ge(o,s):Ne}function rn(n,e){return n.from-e.from||n.to-e.to}function ua(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let a=e[s];if(a.from==r.from){a.to!=r.to&&(e==n&&(e=n.slice()),e[s]=a.copy(a.from,r.to),xo(e,s+1,a.copy(r.to,a.to)));continue}else{a.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,a.from),xo(e,s,r.copy(a.from,r.to)));break}}}return e}function xo(n,e,t){for(;e<n.length&&rn(t,n[e])>0;)e++;n.splice(e,0,t)}function Js(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Ne&&e.push(r)}),n.cursorWrapper&&e.push(ge.create(n.state.doc,[n.cursorWrapper.deco])),Ot.from(e)}const q1={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},U1=Re&&Ft<=11;class W1{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class j1{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new W1,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Re&&Ft<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),U1&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,q1)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(!!fo(this.view)){if(this.suppressingSelectionUpdates)return kt(this.view);if(Re&&Ft<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&on(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let a=e.focusNode;a;a=hr(a))t.add(a);for(let a=e.anchorNode;a;a=hr(a))if(t.has(a)){r=a;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&fo(e)&&!this.ignoreSelectionChange(r),a=-1,o=-1,l=!1,c=[];if(e.editable)for(let h=0;h<t.length;h++){let f=this.registerMutation(t[h],c);f&&(a=a<0?f.from:Math.min(f.from,a),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(l=!0))}if(rt&&c.length>1){let h=c.filter(f=>f.nodeName=="BR");if(h.length==2){let f=h[0],p=h[1];f.parentNode&&f.parentNode.parentNode==p.parentNode?p.remove():f.remove()}}let d=null;a<0&&s&&e.input.lastFocus>Date.now()-200&&e.input.lastTouch<Date.now()-300&&ms(r)&&(d=sa(e))&&d.eq(V.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,kt(e),this.currentSelection.set(r),e.scrollToSelection()):(a>-1||s)&&(a>-1&&(e.docView.markDirty(a,o),J1(e)),this.handleDOMChange(a,o,l,c),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||kt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let h=0;h<e.addedNodes.length;h++)t.push(e.addedNodes[h]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,a=e.nextSibling;if(Re&&Ft<=11&&e.addedNodes.length)for(let h=0;h<e.addedNodes.length;h++){let{previousSibling:f,nextSibling:p}=e.addedNodes[h];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f),(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(a=p)}let o=s&&s.parentNode==e.target?$e(s)+1:0,l=r.localPosFromDOM(e.target,o,-1),c=a&&a.parentNode==e.target?$e(a):e.target.childNodes.length,d=r.localPosFromDOM(e.target,c,1);return{from:l,to:d}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let So=new WeakMap,ko=!1;function J1(n){if(!So.has(n)&&(So.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=rt,ko)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),ko=!0}}function K1(n){let e;function t(c){c.preventDefault(),c.stopImmediatePropagation(),e=c.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,s=e.startOffset,a=e.endContainer,o=e.endOffset,l=n.domAtPos(n.state.selection.anchor);return on(l.node,l.offset,a,o)&&([r,s,a,o]=[a,o,r,s]),{anchorNode:r,anchorOffset:s,focusNode:a,focusOffset:o}}function G1(n,e,t){let{node:r,fromOffset:s,toOffset:a,from:o,to:l}=n.docView.parseRange(e,t),c=n.domSelectionRange(),d,h=c.anchorNode;if(h&&n.dom.contains(h.nodeType==1?h:h.parentNode)&&(d=[{node:h,offset:c.anchorOffset}],ms(c)||d.push({node:c.focusNode,offset:c.focusOffset})),Pe&&n.input.lastKeyCode===8)for(let x=a;x>s;x--){let k=r.childNodes[x-1],M=k.pmViewDesc;if(k.nodeName=="BR"&&!M){a=x;break}if(!M||M.size)break}let f=n.state.doc,p=n.someProp("domParser")||zn.fromSchema(n.state.schema),m=f.resolve(o),b=null,y=p.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:a,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:Q1,context:m});if(d&&d[0].pos!=null){let x=d[0].pos,k=d[1]&&d[1].pos;k==null&&(k=x),b={anchor:x+o,head:k+o}}return{doc:y,sel:b,from:o,to:l}}function Q1(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Ae&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Ae&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function Y1(n,e,t,r,s){if(e<0){let D=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,Y=sa(n,D);if(Y&&!n.state.selection.eq(Y)){let me=n.state.tr.setSelection(Y);D=="pointer"?me.setMeta("pointer",!0):D=="key"&&me.scrollIntoView(),n.dispatch(me)}return}let a=n.state.doc.resolve(e),o=a.sharedDepth(t);e=a.before(o+1),t=n.state.doc.resolve(t).after(o+1);let l=n.state.selection,c=G1(n,e,t),d=n.state.doc,h=d.slice(c.from,c.to),f,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,p="end"):(f=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let m=ev(h.content,c.doc.content,c.from,f,p);if((Fn&&n.input.lastIOSEnter>Date.now()-225||ct)&&s.some(D=>D.nodeName=="DIV"||D.nodeName=="P"||D.nodeName=="LI")&&(!m||m.endA>=m.endB)&&n.someProp("handleKeyDown",D=>D(n,Cn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!m)if(r&&l instanceof J&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))m={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let D=wo(n,n.state.doc,c.sel);D&&!D.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(D))}return}if(Pe&&n.cursorWrapper&&c.sel&&c.sel.anchor==n.cursorWrapper.deco.from&&c.sel.head==c.sel.anchor){let D=m.endB-m.start;c.sel={anchor:c.sel.anchor+D,head:c.sel.anchor+D}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&m.start==m.endB&&n.state.selection instanceof J&&(m.start>n.state.selection.from&&m.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?m.start=n.state.selection.from:m.endA<n.state.selection.to&&m.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(m.endB+=n.state.selection.to-m.endA,m.endA=n.state.selection.to)),Re&&Ft<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>c.from&&c.doc.textBetween(m.start-c.from-1,m.start-c.from+1)==" \xA0"&&(m.start--,m.endA--,m.endB--);let b=c.doc.resolveNoCache(m.start-c.from),y=c.doc.resolveNoCache(m.endB-c.from),x=d.resolve(m.start),k=b.sameParent(y)&&b.parent.inlineContent&&x.end()>=m.endA,M;if((Fn&&n.input.lastIOSEnter>Date.now()-225&&(!k||s.some(D=>D.nodeName=="DIV"||D.nodeName=="P"))||!k&&b.pos<c.doc.content.size&&(M=V.findFrom(c.doc.resolve(b.pos+1),1,!0))&&M.head==y.pos)&&n.someProp("handleKeyDown",D=>D(n,Cn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>m.start&&Z1(d,m.start,m.endA,b,y)&&n.someProp("handleKeyDown",D=>D(n,Cn(8,"Backspace")))){ct&&Pe&&n.domObserver.suppressSelectionUpdates();return}Pe&&ct&&m.endB==m.start&&(n.input.lastAndroidDelete=Date.now()),ct&&!k&&b.start()!=y.start()&&y.parentOffset==0&&b.depth==y.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==m.endA&&(m.endB-=2,y=c.doc.resolveNoCache(m.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(D){return D(n,Cn(13,"Enter"))})},20));let T=m.start,B=m.endA,A,H,j;if(k){if(b.pos==y.pos)Re&&Ft<=11&&b.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>kt(n),20)),A=n.state.tr.delete(T,B),H=d.resolve(m.start).marksAcross(d.resolve(m.endA));else if(m.endA==m.endB&&(j=X1(b.parent.content.cut(b.parentOffset,y.parentOffset),x.parent.content.cut(x.parentOffset,m.endA-x.start()))))A=n.state.tr,j.type=="add"?A.addMark(T,B,j.mark):A.removeMark(T,B,j.mark);else if(b.parent.child(b.index()).isText&&b.index()==y.index()-(y.textOffset?0:1)){let D=b.parent.textBetween(b.parentOffset,y.parentOffset);if(n.someProp("handleTextInput",Y=>Y(n,T,B,D)))return;A=n.state.tr.insertText(D,T,B)}}if(A||(A=n.state.tr.replace(T,B,c.doc.slice(m.start-c.from,m.endB-c.from))),c.sel){let D=wo(n,A.doc,c.sel);D&&!(Pe&&ct&&n.composing&&D.empty&&(m.start!=m.endB||n.input.lastAndroidDelete<Date.now()-100)&&(D.head==T||D.head==A.mapping.map(B)-1)||Re&&D.empty&&D.head==T)&&A.setSelection(D)}H&&A.ensureMarks(H),n.dispatch(A.scrollIntoView())}function wo(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:ia(n,e.resolve(t.anchor),e.resolve(t.head))}function X1(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,a=r,o,l,c;for(let h=0;h<r.length;h++)s=r[h].removeFromSet(s);for(let h=0;h<t.length;h++)a=t[h].removeFromSet(a);if(s.length==1&&a.length==0)l=s[0],o="add",c=h=>h.mark(l.addToSet(h.marks));else if(s.length==0&&a.length==1)l=a[0],o="remove",c=h=>h.mark(l.removeFromSet(h.marks));else return null;let d=[];for(let h=0;h<e.childCount;h++)d.push(c(e.child(h)));if(N.from(d).eq(n))return{mark:l,type:o}}function Z1(n,e,t,r,s){if(!r.parent.isTextblock||t-e<=s.pos-r.pos||Ks(r,!0,!1)<s.pos)return!1;let a=n.resolve(e);if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let o=n.resolve(Ks(a,!0,!0));return!o.parent.isTextblock||o.pos>t||Ks(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Ks(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let a=n.node(r).maybeChild(n.indexAfter(r));for(;a&&!a.isLeaf;)a=a.firstChild,s++}return s}function ev(n,e,t,r,s){let a=n.findDiffStart(e,t);if(a==null)return null;let{a:o,b:l}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let c=Math.max(0,a-Math.min(o,l));r-=o+c-a}if(o<a&&n.size<e.size){let c=r<=a&&r>=o?a-r:0;a-=c,l=a+(l-o),o=a}else if(l<a){let c=r<=a&&r>=l?a-r:0;a-=c,o=a+(o-l),l=a}return{start:a,endA:o,endB:l}}class tv{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new k1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Eo),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Mo(this),No(this),this.nodeViews=To(this),this.docView=ao(this.state.doc,Co(this),Js(this),this.dom,this),this.domObserver=new j1(this,(r,s,a,o)=>Y1(this,r,s,a,o)),this.domObserver.start(),w1(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&wi(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Eo),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){let r=this.state,s=!1,a=!1;e.storedMarks&&this.composing&&(Ed(this),a=!0),this.state=e;let o=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=To(this);rv(p,this.nodeViews)&&(this.nodeViews=p,s=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&wi(this),this.editable=Mo(this),No(this);let l=Js(this),c=Co(this),d=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",h=s||!this.docView.matchesNode(e.doc,c,l);(h||!e.selection.eq(r.selection))&&(a=!0);let f=d=="preserve"&&a&&this.dom.style.overflowAnchor==null&&V0(this);if(a){this.domObserver.stop();let p=h&&(Re||Pe)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&nv(r.selection,e.selection);if(h){let m=Pe?this.trackWrites=this.domSelectionRange().focusNode:null;(s||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=ao(e.doc,c,l,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&h1(this))?kt(this,p):(md(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():f&&H0(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof L){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&to(this,t.getBoundingClientRect(),e)}else to(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(s=t?t(l):l))return s}let a=this.state.plugins;if(a)for(let o=0;o<a.length;o++){let l=a[o].props[e];if(l!=null&&(s=t?t(l):l))return s}}hasFocus(){if(Re){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&q0(this.dom),kt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}posAtCoords(e){return K0(this,e)}coordsAtPos(e,t=1){return od(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return Z0(this,t||this.state,e)}destroy(){!this.docView||(C1(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Js(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return M1(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Ae&&this.root.nodeType===11&&F0(this.dom.ownerDocument)==this.dom?K1(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function Co(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),e.translate="no",n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"&&(e.class+=" "+t[r]),r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),[et.node(0,n.state.doc.content.size,e)]}function No(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:et.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Mo(n){return!n.someProp("editable",e=>e(n.state)===!1)}function nv(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function To(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function rv(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function Eo(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Bt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Zr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Oo=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent);var sv=typeof navigator<"u"&&/Mac/.test(navigator.platform),iv=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),av=sv||Oo&&+Oo[1]<57;for(var ke=0;ke<10;ke++)Bt[48+ke]=Bt[96+ke]=String(ke);for(var ke=1;ke<=24;ke++)Bt[ke+111]="F"+ke;for(var ke=65;ke<=90;ke++)Bt[ke]=String.fromCharCode(ke+32),Zr[ke]=String.fromCharCode(ke);for(var Gs in Bt)Zr.hasOwnProperty(Gs)||(Zr[Gs]=Bt[Gs]);function ov(n){var e=av&&(n.ctrlKey||n.altKey||n.metaKey)||iv&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Zr:Bt)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const lv=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function cv(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,a,o;for(let l=0;l<e.length-1;l++){let c=e[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))lv?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+c)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),a&&(t="Shift-"+t),t}function dv(n){let e=Object.create(null);for(let t in n)e[cv(t)]=n[t];return e}function Qs(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}function uv(n){return new Ut({props:{handleKeyDown:hv(n)}})}function hv(n){let e=dv(n);return function(t,r){let s=ov(r),a=s.length==1&&s!=" ",o,l=e[Qs(s,r,!a)];if(l&&l(t.state,t.dispatch,t))return!0;if(a&&(r.shiftKey||r.altKey||r.metaKey||s.charCodeAt(0)>127)&&(o=Bt[r.keyCode])&&o!=s){let c=e[Qs(o,r,!0)];if(c&&c(t.state,t.dispatch,t))return!0}else if(a&&r.shiftKey){let c=e[Qs(s,r,!0)];if(c&&c(t.state,t.dispatch,t))return!0}return!1}}const fv=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0),pv=(n,e,t)=>{let{$cursor:r}=n.selection;if(!r||(t?!t.endOfTextblock("backward",n):r.parentOffset>0))return!1;let s=zd(r);if(!s){let o=r.blockRange(),l=o&&Un(o);return l==null?!1:(e&&e(n.tr.lift(o,l).scrollIntoView()),!0)}let a=s.nodeBefore;if(!a.type.spec.isolating&&Fd(n,s,e))return!0;if(r.parent.content.size==0&&(_n(a,"end")||L.isSelectable(a))){let o=ta(n.doc,r.before(),r.after(),O.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=n.tr.step(o);l.setSelection(_n(a,"end")?V.findFrom(l.doc.resolve(l.mapping.map(s.pos,-1)),-1):L.create(l.doc,s.pos-a.nodeSize)),e(l.scrollIntoView())}return!0}}return a.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-a.nodeSize,s.pos).scrollIntoView()),!0):!1};function _n(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const mv=(n,e,t)=>{let{$head:r,empty:s}=n.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;a=zd(r)}let o=a&&a.nodeBefore;return!o||!L.isSelectable(o)?!1:(e&&e(n.tr.setSelection(L.create(n.doc,a.pos-o.nodeSize)).scrollIntoView()),!0)};function zd(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}const gv=(n,e,t)=>{let{$cursor:r}=n.selection;if(!r||(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size))return!1;let s=Pd(r);if(!s)return!1;let a=s.nodeAfter;if(Fd(n,s,e))return!0;if(r.parent.content.size==0&&(_n(a,"start")||L.isSelectable(a))){let o=ta(n.doc,r.before(),r.after(),O.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=n.tr.step(o);l.setSelection(_n(a,"start")?V.findFrom(l.doc.resolve(l.mapping.map(s.pos)),1):L.create(l.doc,l.mapping.map(s.pos))),e(l.scrollIntoView())}return!0}}return a.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0):!1},bv=(n,e,t)=>{let{$head:r,empty:s}=n.selection,a=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;a=Pd(r)}let o=a&&a.nodeAfter;return!o||!L.isSelectable(o)?!1:(e&&e(n.tr.setSelection(L.create(n.doc,a.pos)).scrollIntoView()),!0)};function Pd(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const yv=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),a=s&&Un(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)},vv=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Rd(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const xv=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),a=t.indexAfter(-1),o=Rd(s.contentMatchAt(a));if(!o||!s.canReplaceWith(a,a,o))return!1;if(e){let l=t.after(),c=n.tr.replaceWith(l,l,o.createAndFill());c.setSelection(V.near(c.doc.resolve(l),1)),e(c.scrollIntoView())}return!0},Sv=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof tt||r.parent.inlineContent||s.parent.inlineContent)return!1;let a=Rd(s.parent.contentMatchAt(s.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,l=n.tr.insert(o,a.createAndFill());l.setSelection(J.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},kv=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let a=t.before();if(En(n.doc,a))return e&&e(n.tr.split(a).scrollIntoView()),!0}let r=t.blockRange(),s=r&&Un(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)},wv=(n,e)=>{let{$from:t,to:r}=n.selection,s,a=t.sharedDepth(r);return a==0?!1:(s=t.before(a),e&&e(n.tr.setSelection(L.create(n.doc,s))),!0)};function Cv(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,a=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(a-1,a)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(s.isTextblock||Wn(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function Fd(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,a,o;if(r.type.spec.isolating||s.type.spec.isolating)return!1;if(Cv(n,e,t))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(a=(o=r.contentMatchAt(r.childCount)).findWrapping(s.type))&&o.matchType(a[0]||s.type).validEnd){if(t){let f=e.pos+s.nodeSize,p=N.empty;for(let y=a.length-1;y>=0;y--)p=N.from(a[y].create(null,p));p=N.from(r.copy(p));let m=n.tr.step(new be(e.pos-1,f,e.pos,f,new O(p,1,0),a.length,!0)),b=f+2*a.length;Wn(m.doc,b)&&m.join(b),t(m.scrollIntoView())}return!0}let c=V.findFrom(e,1),d=c&&c.$from.blockRange(c.$to),h=d&&Un(d);if(h!=null&&h>=e.depth)return t&&t(n.tr.lift(d,h).scrollIntoView()),!0;if(l&&_n(s,"start",!0)&&_n(r,"end")){let f=r,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let m=s,b=1;for(;!m.isTextblock;m=m.firstChild)b++;if(f.canReplace(f.childCount,f.childCount,m.content)){if(t){let y=N.empty;for(let k=p.length-1;k>=0;k--)y=N.from(p[k].copy(y));let x=n.tr.step(new be(e.pos-p.length,e.pos+s.nodeSize,e.pos+b,e.pos+s.nodeSize-b,new O(y,p.length,0),0,!0));t(x.scrollIntoView())}return!0}}return!1}function Ld(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,a=s.depth;for(;s.node(a).isInline;){if(!a)return!1;a--}return s.node(a).isTextblock?(t&&t(e.tr.setSelection(J.create(e.doc,n<0?s.start(a):s.end(a)))),!0):!1}}const Nv=Ld(-1),Mv=Ld(1);function Tv(n,e=null){return function(t,r){let{$from:s,$to:a}=t.selection,o=s.blockRange(a),l=o&&ea(o,n,e);return l?(r&&r(t.tr.wrap(o,l).scrollIntoView()),!0):!1}}function Ao(n,e=null){return function(t,r){let{from:s,to:a}=t.selection,o=!1;return t.doc.nodesBetween(s,a,(l,c)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)o=!0;else{let d=t.doc.resolve(c),h=d.index();o=d.parent.canReplaceWith(h,h+1,n)}}),o?(r&&r(t.tr.setBlockType(s,a,n,e).scrollIntoView()),!0):!1}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Ev(n,e=null){return function(t,r){let{$from:s,$to:a}=t.selection,o=s.blockRange(a),l=!1,c=o;if(!o)return!1;if(o.depth>=2&&s.node(o.depth-1).type.compatibleContent(n)&&o.startIndex==0){if(s.index(o.depth-1)==0)return!1;let h=t.doc.resolve(o.start-2);c=new Wr(h,h,o.depth),o.endIndex<o.parent.childCount&&(o=new Wr(s,t.doc.resolve(a.end(o.depth)),o.depth)),l=!0}let d=ea(c,n,e,o);return d?(r&&r(Ov(t.tr,o,d,l,n).scrollIntoView()),!0):!1}}function Ov(n,e,t,r,s){let a=N.empty;for(let h=t.length-1;h>=0;h--)a=N.from(t[h].type.create(t[h].attrs,a));n.step(new be(e.start-(r?2:0),e.end,e.start,e.end,new O(a,0,0),t.length,!0));let o=0;for(let h=0;h<t.length;h++)t[h].type==s&&(o=h+1);let l=t.length-o,c=e.start+t.length-(r?2:0),d=e.parent;for(let h=e.startIndex,f=e.endIndex,p=!0;h<f;h++,p=!1)!p&&En(n.doc,c,l)&&(n.split(c,l),c+=2*l),c+=d.child(h).nodeSize;return n}function Av(n){return function(e,t){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return a?t?r.node(a.depth-1).type==n?Iv(e,t,n,a):Dv(e,t,a):!0:!1}}function Iv(n,e,t,r){let s=n.tr,a=r.end,o=r.$to.end(r.depth);a<o&&(s.step(new be(a-1,o,a,o,new O(N.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Wr(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const l=Un(r);if(l==null)return!1;s.lift(r,l);let c=s.mapping.map(a,-1)-1;return Wn(s.doc,c)&&s.join(c),e(s.scrollIntoView()),!0}function Dv(n,e,t){let r=n.tr,s=t.parent;for(let m=t.end,b=t.endIndex-1,y=t.startIndex;b>y;b--)m-=s.child(b).nodeSize,r.delete(m-1,m+1);let a=r.doc.resolve(t.start),o=a.nodeAfter;if(r.mapping.map(t.end)!=t.start+a.nodeAfter.nodeSize)return!1;let l=t.startIndex==0,c=t.endIndex==s.childCount,d=a.node(-1),h=a.index(-1);if(!d.canReplace(h+(l?0:1),h+1,o.content.append(c?N.empty:N.from(s))))return!1;let f=a.pos,p=f+o.nodeSize;return r.step(new be(f-(l?1:0),p+(c?1:0),f+1,p-1,new O((l?N.empty:N.from(s.copy(N.empty))).append(c?N.empty:N.from(s.copy(N.empty))),l?0:1,c?0:1),l?0:1)),e(r.scrollIntoView()),!0}function zv(n){return function(e,t){let{$from:r,$to:s}=e.selection,a=r.blockRange(s,d=>d.childCount>0&&d.firstChild.type==n);if(!a)return!1;let o=a.startIndex;if(o==0)return!1;let l=a.parent,c=l.child(o-1);if(c.type!=n)return!1;if(t){let d=c.lastChild&&c.lastChild.type==l.type,h=N.from(d?n.create():null),f=new O(N.from(n.create(null,N.from(l.type.create(null,h)))),d?3:1,0),p=a.start,m=a.end;t(e.tr.step(new be(p-(d?3:1),m,p,m,f,1,!0)).scrollIntoView())}return!0}}function vs(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:a}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,a=t.storedMarks,t}}}class xs{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:a}=r,o=this.buildProps(a);return Object.fromEntries(Object.entries(e).map(([l,c])=>[l,(...h)=>{const f=c(...h)(o);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(a),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:a}=this,{view:o}=s,l=[],c=!!e,d=e||a.tr,h=()=>(!c&&t&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(d),l.every(p=>p===!0)),f={...Object.fromEntries(Object.entries(r).map(([p,m])=>[p,(...y)=>{const x=this.buildProps(d,t),k=m(...y)(x);return l.push(k),f}])),run:h};return f}createCan(e){const{rawCommands:t,state:r}=this,s=!1,a=e||r.tr,o=this.buildProps(a,s);return{...Object.fromEntries(Object.entries(t).map(([c,d])=>[c,(...h)=>d(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(a,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:a}=this,{view:o}=s;a.storedMarks&&e.setStoredMarks(a.storedMarks);const l={tr:e,editor:s,view:o,state:vs({state:a,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([c,d])=>[c,(...h)=>d(...h)(l)]))}};return l}}class Pv{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function I(n,e,t){return n.config[e]===void 0&&n.parent?I(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?I(n.parent,e,t):null}):n.config[e]}function Ss(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function _d(n){const e=[],{nodeExtensions:t,markExtensions:r}=Ss(n),s=[...t,...r],a={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},c=I(o,"addGlobalAttributes",l);if(!c)return;c().forEach(h=>{h.types.forEach(f=>{Object.entries(h.attributes).forEach(([p,m])=>{e.push({type:f,name:p,attribute:{...a,...m}})})})})}),s.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},c=I(o,"addAttributes",l);if(!c)return;const d=c();Object.entries(d).forEach(([h,f])=>{const p={...a,...f};(f==null?void 0:f.isRequired)&&(f==null?void 0:f.default)===void 0&&delete p.default,e.push({type:o.name,name:h,attribute:p})})}),e}function ye(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function Rv(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,a])=>{if(!r[s]){r[s]=a;return}s==="class"?r[s]=[r[s],a].join(" "):s==="style"?r[s]=[r[s],a].join("; "):r[s]=a}),r},{})}function Ni(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>Rv(t,r),{})}function Bd(n){return typeof n=="function"}function $(n,e=void 0,...t){return Bd(n)?e?n.bind(e)(...t):n(...t):n}function Fv(n={}){return Object.keys(n).length===0&&n.constructor===Object}function Lv(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function Io(n,e){return n.style?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((a,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(t):Lv(t.getAttribute(o.name));return l==null?a:{...a,[o.name]:l}},{});return{...r,...s}}}}function Do(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&Fv(t)?!1:t!=null))}function _v(n){var e;const t=_d(n),{nodeExtensions:r,markExtensions:s}=Ss(n),a=(e=r.find(c=>I(c,"topNode")))===null||e===void 0?void 0:e.name,o=Object.fromEntries(r.map(c=>{const d=t.filter(x=>x.type===c.name),h={name:c.name,options:c.options,storage:c.storage},f=n.reduce((x,k)=>{const M=I(k,"extendNodeSchema",h);return{...x,...M?M(c):{}}},{}),p=Do({...f,content:$(I(c,"content",h)),marks:$(I(c,"marks",h)),group:$(I(c,"group",h)),inline:$(I(c,"inline",h)),atom:$(I(c,"atom",h)),selectable:$(I(c,"selectable",h)),draggable:$(I(c,"draggable",h)),code:$(I(c,"code",h)),defining:$(I(c,"defining",h)),isolating:$(I(c,"isolating",h)),attrs:Object.fromEntries(d.map(x=>{var k;return[x.name,{default:(k=x==null?void 0:x.attribute)===null||k===void 0?void 0:k.default}]}))}),m=$(I(c,"parseHTML",h));m&&(p.parseDOM=m.map(x=>Io(x,d)));const b=I(c,"renderHTML",h);b&&(p.toDOM=x=>b({node:x,HTMLAttributes:Ni(x,d)}));const y=I(c,"renderText",h);return y&&(p.toText=y),[c.name,p]})),l=Object.fromEntries(s.map(c=>{const d=t.filter(y=>y.type===c.name),h={name:c.name,options:c.options,storage:c.storage},f=n.reduce((y,x)=>{const k=I(x,"extendMarkSchema",h);return{...y,...k?k(c):{}}},{}),p=Do({...f,inclusive:$(I(c,"inclusive",h)),excludes:$(I(c,"excludes",h)),group:$(I(c,"group",h)),spanning:$(I(c,"spanning",h)),code:$(I(c,"code",h)),attrs:Object.fromEntries(d.map(y=>{var x;return[y.name,{default:(x=y==null?void 0:y.attribute)===null||x===void 0?void 0:x.default}]}))}),m=$(I(c,"parseHTML",h));m&&(p.parseDOM=m.map(y=>Io(y,d)));const b=I(c,"renderHTML",h);return b&&(p.toDOM=y=>b({mark:y,HTMLAttributes:Ni(y,d)})),[c.name,p]}));return new Xy({topNode:a,nodes:o,marks:l})}function Ys(n,e){return e.nodes[n]||e.marks[n]||null}function zo(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const Bv=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,a,o,l)=>{var c,d;const h=((d=(c=s.type.spec).toText)===null||d===void 0?void 0:d.call(c,{node:s,pos:a,parent:o,index:l}))||s.textContent||"%leaf%";t+=h.slice(0,Math.max(0,r-a))}),t};function ha(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class ks{constructor(e){this.find=e.find,this.handler=e.handler}}const $v=(n,e)=>{if(ha(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[];return r.push(t.text),r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Xs(n){var e;const{editor:t,from:r,to:s,text:a,rules:o,plugin:l}=n,{view:c}=t;if(c.composing)return!1;const d=c.state.doc.resolve(r);if(d.parent.type.spec.code||!!(!((e=d.nodeBefore||d.nodeAfter)===null||e===void 0)&&e.marks.find(p=>p.type.spec.code)))return!1;let h=!1;const f=Bv(d)+a;return o.forEach(p=>{if(h)return;const m=$v(f,p.find);if(!m)return;const b=c.state.tr,y=vs({state:c.state,transaction:b}),x={from:r-(m[0].length-a.length),to:s},{commands:k,chain:M,can:T}=new xs({editor:t,state:y});p.handler({state:y,range:x,match:m,commands:k,chain:M,can:T})===null||!b.steps.length||(b.setMeta(l,{transform:b,from:r,to:s,text:a}),c.dispatch(b),h=!0)}),h}function Vv(n){const{editor:e,rules:t}=n,r=new Ut({state:{init(){return null},apply(s,a){const o=s.getMeta(r);return o||(s.selectionSet||s.docChanged?null:a)}},props:{handleTextInput(s,a,o,l){return Xs({editor:e,from:a,to:o,text:l,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:a}=s.state.selection;a&&Xs({editor:e,from:a.pos,to:a.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,a){if(a.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?Xs({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function Hv(n){return typeof n=="number"}class qv{constructor(e){this.find=e.find,this.handler=e.handler}}const Uv=(n,e)=>{if(ha(e))return[...n.matchAll(e)];const t=e(n);return t?t.map(r=>{const s=[];return s.push(r.text),s.index=r.index,s.input=n,s.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(r.replaceWith)),s}):[]};function Wv(n){const{editor:e,state:t,from:r,to:s,rule:a}=n,{commands:o,chain:l,can:c}=new xs({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,s,(f,p)=>{if(!f.isTextblock||f.type.spec.code)return;const m=Math.max(r,p),b=Math.min(s,p+f.content.size),y=f.textBetween(m-p,b-p,void 0,"\uFFFC");Uv(y,a.find).forEach(k=>{if(k.index===void 0)return;const M=m+k.index+1,T=M+k[0].length,B={from:t.tr.mapping.map(M),to:t.tr.mapping.map(T)},A=a.handler({state:t,range:B,match:k,commands:o,chain:l,can:c});d.push(A)})}),d.every(f=>f!==null)}function jv(n){const{editor:e,rules:t}=n;let r=null,s=!1,a=!1;return t.map(l=>new Ut({view(c){const d=h=>{var f;r=!((f=c.dom.parentElement)===null||f===void 0)&&f.contains(h.target)?c.dom.parentElement:null};return window.addEventListener("dragstart",d),{destroy(){window.removeEventListener("dragstart",d)}}},props:{handleDOMEvents:{drop:c=>(a=r===c.dom.parentElement,!1),paste:(c,d)=>{var h;const f=(h=d.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return s=!!(f!=null&&f.includes("data-pm-slice")),!1}}},appendTransaction:(c,d,h)=>{const f=c[0],p=f.getMeta("uiEvent")==="paste"&&!s,m=f.getMeta("uiEvent")==="drop"&&!a;if(!p&&!m)return;const b=d.doc.content.findDiffStart(h.doc.content),y=d.doc.content.findDiffEnd(h.doc.content);if(!Hv(b)||!y||b===y.b)return;const x=h.tr,k=vs({state:h,transaction:x});if(!(!Wv({editor:e,state:k,from:Math.max(b-1,0),to:y.b-1,rule:l})||!x.steps.length))return x}}))}function Jv(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class Mn{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Mn.resolve(e),this.schema=_v(this.extensions),this.extensions.forEach(r=>{var s;this.editor.extensionStorage[r.name]=r.storage;const a={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:Ys(r.name,this.schema)};r.type==="mark"&&((s=$(I(r,"keepOnSplit",a)))!==null&&s!==void 0?s:!0)&&this.splittableMarks.push(r.name);const o=I(r,"onBeforeCreate",a);o&&this.editor.on("beforeCreate",o);const l=I(r,"onCreate",a);l&&this.editor.on("create",l);const c=I(r,"onUpdate",a);c&&this.editor.on("update",c);const d=I(r,"onSelectionUpdate",a);d&&this.editor.on("selectionUpdate",d);const h=I(r,"onTransaction",a);h&&this.editor.on("transaction",h);const f=I(r,"onFocus",a);f&&this.editor.on("focus",f);const p=I(r,"onBlur",a);p&&this.editor.on("blur",p);const m=I(r,"onDestroy",a);m&&this.editor.on("destroy",m)})}static resolve(e){const t=Mn.sort(Mn.flatten(e)),r=Jv(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=I(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const a=I(r,"priority")||100,o=I(s,"priority")||100;return a>o?-1:a<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Ys(t.name,this.schema)},s=I(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=Mn.sort([...this.extensions].reverse()),r=[],s=[],a=t.map(o=>{const l={name:o.name,options:o.options,storage:o.storage,editor:e,type:Ys(o.name,this.schema)},c=[],d=I(o,"addKeyboardShortcuts",l);let h={};if(o.type==="mark"&&o.config.exitable&&(h.ArrowRight=()=>ns.handleExit({editor:e,mark:o})),d){const y=Object.fromEntries(Object.entries(d()).map(([x,k])=>[x,()=>k({editor:e})]));h={...h,...y}}const f=uv(h);c.push(f);const p=I(o,"addInputRules",l);zo(o,e.options.enableInputRules)&&p&&r.push(...p());const m=I(o,"addPasteRules",l);zo(o,e.options.enablePasteRules)&&m&&s.push(...m());const b=I(o,"addProseMirrorPlugins",l);if(b){const y=b();c.push(...y)}return c}).flat();return[Vv({editor:e,rules:r}),...jv({editor:e,rules:s}),...a]}get attributes(){return _d(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Ss(this.extensions);return Object.fromEntries(t.filter(r=>!!I(r,"addNodeView")).map(r=>{const s=this.attributes.filter(c=>c.type===r.name),a={name:r.name,options:r.options,storage:r.storage,editor:e,type:ye(r.name,this.schema)},o=I(r,"addNodeView",a);if(!o)return[];const l=(c,d,h,f)=>{const p=Ni(c,s);return o()({editor:e,node:c,getPos:h,decorations:f,HTMLAttributes:p,extension:r})};return[r.name,l]}))}}function Kv(n){return Object.prototype.toString.call(n).slice(8,-1)}function Zs(n){return Kv(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function ws(n,e){const t={...n};return Zs(n)&&Zs(e)&&Object.keys(e).forEach(r=>{Zs(e[r])?r in n?t[r]=ws(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class wt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=$(I(this,"addOptions",{name:this.name}))),this.storage=$(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new wt(e)}configure(e={}){const t=this.extend();return t.options=ws(this.options,e),t.storage=$(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new wt(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=$(I(t,"addOptions",{name:t.name})),t.storage=$(I(t,"addStorage",{name:t.name,options:t.options})),t}}function $d(n,e,t){const{from:r,to:s}=e,{blockSeparator:a=`

`,textSerializers:o={}}=t||{};let l="",c=!0;return n.nodesBetween(r,s,(d,h,f,p)=>{var m;const b=o==null?void 0:o[d.type.name];b?(d.isBlock&&!c&&(l+=a,c=!0),f&&(l+=b({node:d,pos:h,parent:f,index:p,range:e}))):d.isText?(l+=(m=d==null?void 0:d.text)===null||m===void 0?void 0:m.slice(Math.max(r,h)-h,s-h),c=!1):d.isBlock&&!c&&(l+=a,c=!0)}),l}function Vd(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const Gv=wt.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Ut({key:new Cr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:a}=s,o=Math.min(...a.map(h=>h.$from.pos)),l=Math.max(...a.map(h=>h.$to.pos)),c=Vd(t);return $d(r,{from:o,to:l},{textSerializers:c})}}})]}}),Qv=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),Yv=(n=!1)=>({commands:e})=>e.setContent("",n),Xv=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:a,$to:o})=>{n.doc.nodesBetween(a.pos,o.pos,(l,c)=>{if(l.type.isText)return;const{doc:d,mapping:h}=e,f=d.resolve(h.map(c)),p=d.resolve(h.map(c+l.nodeSize)),m=f.blockRange(p);if(!m)return;const b=Un(m);if(l.type.isTextblock){const{defaultType:y}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(m.start,y)}(b||b===0)&&e.lift(m,b)})}),!0},Zv=n=>e=>n(e),ex=()=>({state:n,dispatch:e})=>Sv(n,e),tx=n=>({tr:e,state:t,dispatch:r})=>{const s=ye(n,t.schema),a=e.selection.$anchor;for(let o=a.depth;o>0;o-=1)if(a.node(o).type===s){if(r){const c=a.before(o),d=a.after(o);e.delete(c,d).scrollIntoView()}return!0}return!1},nx=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},rx=()=>({state:n,dispatch:e})=>fv(n,e),sx=()=>({commands:n})=>n.keyboardShortcut("Enter"),ix=()=>({state:n,dispatch:e})=>xv(n,e);function es(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:ha(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function Mi(n,e,t={}){return n.find(r=>r.type===e&&es(r.attrs,t))}function ax(n,e,t={}){return!!Mi(n,e,t)}function fa(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const s=Mi([...r.node.marks],e,t);if(!s)return;let a=r.index,o=n.start()+r.offset,l=a+1,c=o+r.node.nodeSize;for(Mi([...r.node.marks],e,t);a>0&&s.isInSet(n.parent.child(a-1).marks);)a-=1,o-=n.parent.child(a).nodeSize;for(;l<n.parent.childCount&&ax([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:o,to:c}}function jt(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const ox=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const a=jt(n,r.schema),{doc:o,selection:l}=t,{$from:c,from:d,to:h}=l;if(s){const f=fa(c,a,e);if(f&&f.from<=d&&f.to>=h){const p=J.create(o,f.from,f.to);t.setSelection(p)}}return!0},lx=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Hd(n){return n instanceof J}function Yt(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function qd(n,e=null){if(!e)return null;const t=V.atStart(n),r=V.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,a=r.to;return e==="all"?J.create(n,Yt(0,s,a),Yt(n.content.size,s,a)):J.create(n,Yt(e,s,a),Yt(e,s,a))}function pa(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const cx=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:a})=>{e={scrollIntoView:!0,...e};const o=()=>{pa()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(a&&n===null&&!Hd(t.state.selection))return o(),!0;const l=qd(s.doc,n)||t.state.selection,c=t.state.selection.eq(l);return a&&(c||s.setSelection(l),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},dx=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),ux=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e);function Po(n){const e=`<body>${n}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function ts(n,e,t){if(t={slice:!0,parseOptions:{},...t},typeof n=="object"&&n!==null)try{return Array.isArray(n)?N.fromArray(n.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),ts("",e,t)}if(typeof n=="string"){const r=zn.fromSchema(e);return t.slice?r.parseSlice(Po(n),t.parseOptions).content:r.parse(Po(n),t.parseOptions)}return ts("",e,t)}function hx(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof Te||s instanceof be))return;const a=n.mapping.maps[r];let o=0;a.forEach((l,c,d,h)=>{o===0&&(o=h)}),n.setSelection(V.near(n.doc.resolve(o),t))}const fx=n=>n.toString().startsWith("<"),px=(n,e,t)=>({tr:r,dispatch:s,editor:a})=>{if(s){t={parseOptions:{},updateSelection:!0,...t};const o=ts(e,a.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(o.toString()==="<>")return!0;let{from:l,to:c}=typeof n=="number"?{from:n,to:n}:n,d=!0,h=!0;if((fx(o)?o:[o]).forEach(p=>{p.check(),d=d?p.isText&&p.marks.length===0:!1,h=h?p.isBlock:!1}),l===c&&h){const{parent:p}=r.doc.resolve(l);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(l-=1,c+=1)}d?r.insertText(e,l,c):r.replaceWith(l,c,o),t.updateSelection&&hx(r,r.steps.length-1,-1)}return!0},mx=()=>({state:n,dispatch:e})=>pv(n,e),gx=()=>({state:n,dispatch:e})=>gv(n,e);function Ud(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function bx(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,a,o;for(let l=0;l<e.length-1;l+=1){const c=e[l];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))a=!0;else if(/^mod$/i.test(c))pa()||Ud()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),a&&(t=`Shift-${t}`),t}const yx=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const a=bx(n).split(/-(?!$)/),o=a.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction(()=>{t.someProp("handleKeyDown",d=>d(t,l))});return c==null||c.steps.forEach(d=>{const h=d.map(r.mapping);h&&s&&r.maybeStep(h)}),!0};function pr(n,e,t={}){const{from:r,to:s,empty:a}=n.selection,o=e?ye(e,n.schema):null,l=[];n.doc.nodesBetween(r,s,(f,p)=>{if(f.isText)return;const m=Math.max(r,p),b=Math.min(s,p+f.nodeSize);l.push({node:f,from:m,to:b})});const c=s-r,d=l.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>es(f.node.attrs,t,{strict:!1}));return a?!!d.length:d.reduce((f,p)=>f+p.to-p.from,0)>=c}const vx=(n,e={})=>({state:t,dispatch:r})=>{const s=ye(n,t.schema);return pr(t,s,e)?yv(t,r):!1},xx=()=>({state:n,dispatch:e})=>kv(n,e),Sx=n=>({state:e,dispatch:t})=>{const r=ye(n,e.schema);return Av(r)(e,t)},kx=()=>({state:n,dispatch:e})=>vv(n,e);function Cs(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function Ro(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const wx=(n,e)=>({tr:t,state:r,dispatch:s})=>{let a=null,o=null;const l=Cs(typeof n=="string"?n:n.name,r.schema);return l?(l==="node"&&(a=ye(n,r.schema)),l==="mark"&&(o=jt(n,r.schema)),s&&t.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(d,h)=>{a&&a===d.type&&t.setNodeMarkup(h,void 0,Ro(d.attrs,e)),o&&d.marks.length&&d.marks.forEach(f=>{o===f.type&&t.addMark(h,h+d.nodeSize,o.create(Ro(f.attrs,e)))})})}),!0):!1},Cx=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),Nx=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),Mx=()=>({state:n,dispatch:e})=>mv(n,e),Tx=()=>({state:n,dispatch:e})=>bv(n,e),Ex=()=>({state:n,dispatch:e})=>wv(n,e),Ox=()=>({state:n,dispatch:e})=>Mv(n,e),Ax=()=>({state:n,dispatch:e})=>Nv(n,e);function Wd(n,e,t={}){return ts(n,e,{slice:!1,parseOptions:t})}const Ix=(n,e=!1,t={})=>({tr:r,editor:s,dispatch:a})=>{const{doc:o}=r,l=Wd(n,s.schema,t);return a&&r.replaceWith(0,o.content.size,l).setMeta("preventUpdate",!e),!0};function Tk(n,e){const t=new Zc(n);return e.forEach(r=>{r.steps.forEach(s=>{t.step(s)})}),t}function Dx(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function Ek(n,e){const t=[];return n.descendants((r,s)=>{e(r)&&t.push({node:r,pos:s})}),t}function Ok(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(s,a)=>{t(s)&&r.push({node:s,pos:a})}),r}function zx(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function ma(n){return e=>zx(e.$from,n)}function Px(n,e){const t=dt.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}function Rx(n,e){const t={from:0,to:n.content.size};return $d(n,t,e)}function jd(n,e){const t=jt(e,n.schema),{from:r,to:s,empty:a}=n.selection,o=[];a?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,c=>{o.push(...c.marks)});const l=o.find(c=>c.type.name===t.name);return l?{...l.attrs}:{}}function Fx(n,e){const t=ye(e,n.schema),{from:r,to:s}=n.selection,a=[];n.doc.nodesBetween(r,s,l=>{a.push(l)});const o=a.reverse().find(l=>l.type.name===t.name);return o?{...o.attrs}:{}}function Lx(n,e){const t=Cs(typeof e=="string"?e:e.name,n.schema);return t==="node"?Fx(n,e):t==="mark"?jd(n,e):{}}function _x(n,e=JSON.stringify){const t={};return n.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(t,s)?!1:t[s]=!0})}function Bx(n){const e=_x(n);return e.length===1?e:e.filter((t,r)=>!e.filter((a,o)=>o!==r).some(a=>t.oldRange.from>=a.oldRange.from&&t.oldRange.to<=a.oldRange.to&&t.newRange.from>=a.newRange.from&&t.newRange.to<=a.newRange.to))}function Ak(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((s,a)=>{const o=[];if(s.ranges.length)s.forEach((l,c)=>{o.push({from:l,to:c})});else{const{from:l,to:c}=t[a];if(l===void 0||c===void 0)return;o.push({from:l,to:c})}o.forEach(({from:l,to:c})=>{const d=e.slice(a).map(l,-1),h=e.slice(a).map(c),f=e.invert().map(d,-1),p=e.invert().map(h);r.push({oldRange:{from:f,to:p},newRange:{from:d,to:h}})})}),Bx(r)}function Jd(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const a=t.resolve(n-1),o=fa(a,s.type);!o||r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,a)=>{r.push(...s.marks.map(o=>({from:a,to:a+s.nodeSize,mark:o})))}),r}function Ti(n,e,t={}){const{empty:r,ranges:s}=n.selection,a=e?jt(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(f=>a?a.name===f.type.name:!0).find(f=>es(f.attrs,t,{strict:!1}));let o=0;const l=[];if(s.forEach(({$from:f,$to:p})=>{const m=f.pos,b=p.pos;n.doc.nodesBetween(m,b,(y,x)=>{if(!y.isText&&!y.marks.length)return;const k=Math.max(m,x),M=Math.min(b,x+y.nodeSize),T=M-k;o+=T,l.push(...y.marks.map(B=>({mark:B,from:k,to:M})))})}),o===0)return!1;const c=l.filter(f=>a?a.name===f.mark.type.name:!0).filter(f=>es(f.mark.attrs,t,{strict:!1})).reduce((f,p)=>f+p.to-p.from,0),d=l.filter(f=>a?f.mark.type!==a&&f.mark.type.excludes(a):!0).reduce((f,p)=>f+p.to-p.from,0);return(c>0?c+d:c)>=o}function $x(n,e,t={}){if(!e)return pr(n,null,t)||Ti(n,null,t);const r=Cs(e,n.schema);return r==="node"?pr(n,e,t):r==="mark"?Ti(n,e,t):!1}function Fo(n,e){const{nodeExtensions:t}=Ss(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},a=$(I(r,"group",s));return typeof a!="string"?!1:a.split(" ").includes("list")}function Vx(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function Hx(n,e,t){var r;const{selection:s}=e;let a=null;if(Hd(s)&&(a=s.$cursor),a){const l=(r=n.storedMarks)!==null&&r!==void 0?r:a.marks();return!!t.isInSet(l)||!l.some(c=>c.type.excludes(t))}const{ranges:o}=s;return o.some(({$from:l,$to:c})=>{let d=l.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(l.pos,c.pos,(h,f,p)=>{if(d)return!1;if(h.isInline){const m=!p||p.type.allowsMarkType(t),b=!!t.isInSet(h.marks)||!h.marks.some(y=>y.type.excludes(t));d=m&&b}return!d}),d})}const qx=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:a}=t,{empty:o,ranges:l}=a,c=jt(n,r.schema);if(s)if(o){const d=jd(r,c);t.addStoredMark(c.create({...d,...e}))}else l.forEach(d=>{const h=d.$from.pos,f=d.$to.pos;r.doc.nodesBetween(h,f,(p,m)=>{const b=Math.max(m,h),y=Math.min(m+p.nodeSize,f);p.marks.find(k=>k.type===c)?p.marks.forEach(k=>{c===k.type&&t.addMark(b,y,c.create({...k.attrs,...e}))}):t.addMark(b,y,c.create(e))})});return Hx(r,t,c)},Ux=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),Wx=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const a=ye(n,t.schema);return a.isTextblock?s().command(({commands:o})=>Ao(a,e)(t)?!0:o.clearNodes()).command(({state:o})=>Ao(a,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},jx=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=Yt(n,0,r.content.size),a=L.create(r,s);e.setSelection(a)}return!0},Jx=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:a}=typeof n=="number"?{from:n,to:n}:n,o=J.atStart(r).from,l=J.atEnd(r).to,c=Yt(s,o,l),d=Yt(a,o,l),h=J.create(r,c,d);e.setSelection(h)}return!0},Kx=n=>({state:e,dispatch:t})=>{const r=ye(n,e.schema);return zv(r)(e,t)};function Lr(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(a=>a.type===e&&a.name===r);return s?s.attribute.keepOnSplit:!1}))}function Lo(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e==null?void 0:e.includes(s.type.name));n.tr.ensureMarks(r)}}const Gx=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:a,doc:o}=e,{$from:l,$to:c}=a,d=s.extensionManager.attributes,h=Lr(d,l.node().type.name,l.node().attrs);if(a instanceof L&&a.node.isBlock)return!l.parentOffset||!En(o,l.pos)?!1:(r&&(n&&Lo(t,s.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;if(r){const f=c.parentOffset===c.parent.content.size;a instanceof J&&e.deleteSelection();const p=l.depth===0?void 0:Dx(l.node(-1).contentMatchAt(l.indexAfter(-1)));let m=f&&p?[{type:p,attrs:h}]:void 0,b=En(e.doc,e.mapping.map(l.pos),1,m);if(!m&&!b&&En(e.doc,e.mapping.map(l.pos),1,p?[{type:p}]:void 0)&&(b=!0,m=p?[{type:p,attrs:h}]:void 0),b&&(e.split(e.mapping.map(l.pos),1,m),p&&!f&&!l.parentOffset&&l.parent.type!==p)){const y=e.mapping.map(l.before()),x=e.doc.resolve(y);l.node(-1).canReplaceWith(x.index(),x.index()+1,p)&&e.setNodeMarkup(e.mapping.map(l.before()),p)}n&&Lo(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return!0},Qx=n=>({tr:e,state:t,dispatch:r,editor:s})=>{var a;const o=ye(n,t.schema),{$from:l,$to:c}=t.selection,d=t.selection.node;if(d&&d.isBlock||l.depth<2||!l.sameParent(c))return!1;const h=l.node(-1);if(h.type!==o)return!1;const f=s.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let x=N.empty;const k=l.index(-1)?1:l.index(-2)?2:3;for(let j=l.depth-k;j>=l.depth-3;j-=1)x=N.from(l.node(j).copy(x));const M=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,T=Lr(f,l.node().type.name,l.node().attrs),B=((a=o.contentMatch.defaultType)===null||a===void 0?void 0:a.createAndFill(T))||void 0;x=x.append(N.from(o.createAndFill(null,B)||void 0));const A=l.before(l.depth-(k-1));e.replace(A,l.after(-M),new O(x,4-k,0));let H=-1;e.doc.nodesBetween(A,e.doc.content.size,(j,D)=>{if(H>-1)return!1;j.isTextblock&&j.content.size===0&&(H=D+1)}),H>-1&&e.setSelection(J.near(e.doc.resolve(H))),e.scrollIntoView()}return!0}const p=c.pos===l.end()?h.contentMatchAt(0).defaultType:null,m=Lr(f,h.type.name,h.attrs),b=Lr(f,l.node().type.name,l.node().attrs);e.delete(l.pos,c.pos);const y=p?[{type:o,attrs:m},{type:p,attrs:b}]:[{type:o,attrs:m}];return En(e.doc,l.pos,2)?(r&&e.split(l.pos,2,y).scrollIntoView(),!0):!1},_o=(n,e)=>{const t=ma(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Wn(n.doc,t.pos)&&n.join(t.pos),!0},Bo=(n,e)=>{const t=ma(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Wn(n.doc,r)&&n.join(r),!0},Yx=(n,e)=>({editor:t,tr:r,state:s,dispatch:a,chain:o,commands:l,can:c})=>{const{extensions:d}=t.extensionManager,h=ye(n,s.schema),f=ye(e,s.schema),{selection:p}=s,{$from:m,$to:b}=p,y=m.blockRange(b);if(!y)return!1;const x=ma(k=>Fo(k.type.name,d))(p);if(y.depth>=1&&x&&y.depth-x.depth<=1){if(x.node.type===h)return l.liftListItem(f);if(Fo(x.node.type.name,d)&&h.validContent(x.node.content)&&a)return o().command(()=>(r.setNodeMarkup(x.pos,h),!0)).command(()=>_o(r,h)).command(()=>Bo(r,h)).run()}return o().command(()=>c().wrapInList(h)?!0:l.clearNodes()).wrapInList(h).command(()=>_o(r,h)).command(()=>Bo(r,h)).run()},Xx=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:a=!1}=t,o=jt(n,r.schema);return Ti(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:a}):s.setMark(o,e)},Zx=(n,e,t={})=>({state:r,commands:s})=>{const a=ye(n,r.schema),o=ye(e,r.schema);return pr(r,a,t)?s.setNode(o):s.setNode(a,t)},eS=(n,e={})=>({state:t,commands:r})=>{const s=ye(n,t.schema);return pr(t,s,e)?r.lift(s):r.wrapIn(s,e)},tS=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let a;if(s.spec.isInputRules&&(a=s.getState(n))){if(e){const o=n.tr,l=a.transform;for(let c=l.steps.length-1;c>=0;c-=1)o.step(l.steps[c].invert(l.docs[c]));if(a.text){const c=o.doc.resolve(a.from).marks();o.replaceWith(a.from,a.to,n.schema.text(a.text,c))}else o.delete(a.from,a.to)}return!0}}return!1},nS=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(a=>{n.removeMark(a.$from.pos,a.$to.pos)}),!0},rS=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var a;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=t,c=jt(n,r.schema),{$from:d,empty:h,ranges:f}=l;if(!s)return!0;if(h&&o){let{from:p,to:m}=l;const b=(a=d.marks().find(x=>x.type===c))===null||a===void 0?void 0:a.attrs,y=fa(d,c,b);y&&(p=y.from,m=y.to),t.removeMark(p,m,c)}else f.forEach(p=>{t.removeMark(p.$from.pos,p.$to.pos,c)});return t.removeStoredMark(c),!0},sS=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let a=null,o=null;const l=Cs(typeof n=="string"?n:n.name,r.schema);return l?(l==="node"&&(a=ye(n,r.schema)),l==="mark"&&(o=jt(n,r.schema)),s&&t.selection.ranges.forEach(c=>{const d=c.$from.pos,h=c.$to.pos;r.doc.nodesBetween(d,h,(f,p)=>{a&&a===f.type&&t.setNodeMarkup(p,void 0,{...f.attrs,...e}),o&&f.marks.length&&f.marks.forEach(m=>{if(o===m.type){const b=Math.max(p,d),y=Math.min(p+f.nodeSize,h);t.addMark(b,y,o.create({...m.attrs,...e}))}})})}),!0):!1},iS=(n,e={})=>({state:t,dispatch:r})=>{const s=ye(n,t.schema);return Tv(s,e)(t,r)},aS=(n,e={})=>({state:t,dispatch:r})=>{const s=ye(n,t.schema);return Ev(s,e)(t,r)};var oS=Object.freeze({__proto__:null,blur:Qv,clearContent:Yv,clearNodes:Xv,command:Zv,createParagraphNear:ex,deleteNode:tx,deleteRange:nx,deleteSelection:rx,enter:sx,exitCode:ix,extendMarkRange:ox,first:lx,focus:cx,forEach:dx,insertContent:ux,insertContentAt:px,joinBackward:mx,joinForward:gx,keyboardShortcut:yx,lift:vx,liftEmptyBlock:xx,liftListItem:Sx,newlineInCode:kx,resetAttributes:wx,scrollIntoView:Cx,selectAll:Nx,selectNodeBackward:Mx,selectNodeForward:Tx,selectParentNode:Ex,selectTextblockEnd:Ox,selectTextblockStart:Ax,setContent:Ix,setMark:qx,setMeta:Ux,setNode:Wx,setNodeSelection:jx,setTextSelection:Jx,sinkListItem:Kx,splitBlock:Gx,splitListItem:Qx,toggleList:Yx,toggleMark:Xx,toggleNode:Zx,toggleWrap:eS,undoInputRule:tS,unsetAllMarks:nS,unsetMark:rS,updateAttributes:sS,wrapIn:iS,wrapInList:aS});const lS=wt.create({name:"commands",addCommands(){return{...oS}}}),cS=wt.create({name:"editable",addProseMirrorPlugins(){return[new Ut({key:new Cr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),dS=wt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Ut({key:new Cr("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),uS=wt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:c,doc:d}=l,{empty:h,$anchor:f}=c,{pos:p,parent:m}=f,b=V.atStart(d).from===p;return!h||!b||!m.type.isTextblock||m.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},a={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return pa()||Ud()?a:s},addProseMirrorPlugins(){return[new Ut({key:new Cr("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(b=>b.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:s,from:a,to:o}=e.selection,l=V.atStart(e.doc).from,c=V.atEnd(e.doc).to,d=a===l&&o===c,h=t.doc.textBetween(0,t.doc.content.size," "," ").length===0;if(s||!d||!h)return;const f=t.tr,p=vs({state:t,transaction:f}),{commands:m}=new xs({editor:this.editor,state:p});if(m.clearNodes(),!!f.steps.length)return f}})]}}),hS=wt.create({name:"tabindex",addProseMirrorPlugins(){return[new Ut({key:new Cr("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var fS=Object.freeze({__proto__:null,ClipboardTextSerializer:Gv,Commands:lS,Editable:cS,FocusEvents:dS,Keymap:uS,Tabindex:hS});const pS=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function mS(n,e){const t=document.querySelector("style[data-tiptap-style]");if(t!==null)return t;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(r),r}class gS extends Pv{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=mS(pS,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){this.setOptions({editable:e}),this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Bd(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});this.view.updateState(s)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(s=>!s.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(fS):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new Mn(t,this)}createCommandManager(){this.commandManager=new xs({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=Wd(this.options.content,this.schema,this.options.parseOptions),t=qd(e,this.options.autofocus);this.view=new tv(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:wn.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),a=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),a&&this.emit("blur",{editor:this,event:a.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Lx(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return $x(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Px(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return Rx(this.state.doc,{blockSeparator:t,textSerializers:{...r,...Vd(this.schema)}})}get isEmpty(){return Vx(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}}function Ik(n){return new ks({find:n.find,handler:({state:e,range:t,match:r})=>{const s=$(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:a}=e,o=r[r.length-1],l=r[0];let c=t.to;if(o){const d=l.search(/\S/),h=t.from+l.indexOf(o),f=h+o.length;if(Jd(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(y=>y===n.type&&y!==m.mark.type)).filter(m=>m.to>h).length)return null;f<t.to&&a.delete(f,t.to),h>t.from&&a.delete(t.from+d,h),c=t.from+d+o.length,a.addMark(t.from+d,c,n.type.create(s||{})),a.removeStoredMark(n.type)}}})}function Dk(n){return new ks({find:n.find,handler:({state:e,range:t,match:r})=>{const s=$(n.getAttributes,void 0,r)||{},{tr:a}=e,o=t.from;let l=t.to;if(r[1]){const c=r[0].lastIndexOf(r[1]);let d=o+c;d>l?d=l:l=d+r[1].length;const h=r[0][r[0].length-1];a.insertText(h,o+r[0].length-1),a.replaceWith(d,l,n.type.create(s))}else r[0]&&a.replaceWith(o,l,n.type.create(s))}})}function zk(n){return new ks({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),a=$(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,a)}})}function Pk(n){return new ks({find:n.find,handler:({state:e,range:t,match:r})=>{const s=$(n.getAttributes,void 0,r)||{},a=e.tr.delete(t.from,t.to),l=a.doc.resolve(t.from).blockRange(),c=l&&ea(l,n.type,s);if(!c)return null;a.wrap(l,c);const d=a.doc.resolve(t.from-1).nodeBefore;d&&d.type===n.type&&Wn(a.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,d))&&a.join(t.from-1)}})}class ns{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=$(I(this,"addOptions",{name:this.name}))),this.storage=$(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ns(e)}configure(e={}){const t=this.extend();return t.options=ws(this.options,e),t.storage=$(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new ns(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=$(I(t,"addOptions",{name:t.name})),t.storage=$(I(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(d=>(d==null?void 0:d.type.name)===t.name))return!1;const c=o.find(d=>(d==null?void 0:d.type.name)===t.name);return c&&r.removeStoredMark(c),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}class Ei{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=$(I(this,"addOptions",{name:this.name}))),this.storage=$(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ei(e)}configure(e={}){const t=this.extend();return t.options=ws(this.options,e),t.storage=$(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Ei(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=$(I(t,"addOptions",{name:t.name})),t.storage=$(I(t,"addStorage",{name:t.name,options:t.options})),t}}function Rk(n){return new qv({find:n.find,handler:({state:e,range:t,match:r})=>{const s=$(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:a}=e,o=r[r.length-1],l=r[0];let c=t.to;if(o){const d=l.search(/\S/),h=t.from+l.indexOf(o),f=h+o.length;if(Jd(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(y=>y===n.type&&y!==m.mark.type)).filter(m=>m.to>h).length)return null;f<t.to&&a.delete(f,t.to),h>t.from&&a.delete(t.from+d,h),c=t.from+d+o.length,a.addMark(t.from+d,c,n.type.create(s||{})),a.removeStoredMark(n.type)}}})}class bS extends gS{constructor(){super(...arguments),this.contentComponent=null}}const yS=({renderers:n})=>i(re,{children:Object.entries(n).map(([e,t])=>Iu.createPortal(t.reactElement,t.element,e))});class vS extends Z.Component{constructor(e){super(e),this.editorContentRef=Z.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:e}=this.props;if(e&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=this,e.createNodeViews(),this.initialized=!0}}maybeFlushSync(e){this.initialized?Au.exports.flushSync(e):e()}setRenderer(e,t){this.maybeFlushSync(()=>{this.setState(({renderers:r})=>({renderers:{...r,[e]:t}}))})}removeRenderer(e){this.maybeFlushSync(()=>{this.setState(({renderers:t})=>{const r={...t};return delete r[e],{renderers:r}})})}componentWillUnmount(){const{editor:e}=this.props;if(!e||(e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,...t}=this.props;return g(re,{children:[i("div",{ref:this.editorContentRef,...t}),i(yS,{renderers:this.state.renderers})]})}}const Kd=Z.memo(vS),xS=v.exports.createContext({onDragStart:void 0}),SS=()=>v.exports.useContext(xS);Z.forwardRef((n,e)=>{const{onDragStart:t}=SS(),r=n.as||"div";return i(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});function kS(){const[,n]=v.exports.useState(0);return()=>n(e=>e+1)}const Fk=(n={},e=[])=>{const[t,r]=v.exports.useState(null),s=kS();return v.exports.useEffect(()=>{let a=!0;const o=new bS(n);return r(o),o.on("transaction",()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{a&&s()})})}),()=>{o.destroy(),a=!1}},e),t};var Gd={exports:{}};(function(n,e){(function(t,r,s){n.exports=s(),n.exports.default=s()})("slugify",Du,function(){var t=JSON.parse(`{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","\xA2":"cent","\xA3":"pound","\xA4":"currency","\xA5":"yen","\xA9":"(c)","\xAA":"a","\xAE":"(r)","\xBA":"o","\xC0":"A","\xC1":"A","\xC2":"A","\xC3":"A","\xC4":"A","\xC5":"A","\xC6":"AE","\xC7":"C","\xC8":"E","\xC9":"E","\xCA":"E","\xCB":"E","\xCC":"I","\xCD":"I","\xCE":"I","\xCF":"I","\xD0":"D","\xD1":"N","\xD2":"O","\xD3":"O","\xD4":"O","\xD5":"O","\xD6":"O","\xD8":"O","\xD9":"U","\xDA":"U","\xDB":"U","\xDC":"U","\xDD":"Y","\xDE":"TH","\xDF":"ss","\xE0":"a","\xE1":"a","\xE2":"a","\xE3":"a","\xE4":"a","\xE5":"a","\xE6":"ae","\xE7":"c","\xE8":"e","\xE9":"e","\xEA":"e","\xEB":"e","\xEC":"i","\xED":"i","\xEE":"i","\xEF":"i","\xF0":"d","\xF1":"n","\xF2":"o","\xF3":"o","\xF4":"o","\xF5":"o","\xF6":"o","\xF8":"o","\xF9":"u","\xFA":"u","\xFB":"u","\xFC":"u","\xFD":"y","\xFE":"th","\xFF":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010C":"C","\u010D":"c","\u010E":"D","\u010F":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011A":"E","\u011B":"e","\u011E":"G","\u011F":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012A":"i","\u012B":"i","\u012E":"I","\u012F":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013B":"L","\u013C":"l","\u013D":"L","\u013E":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014C":"O","\u014D":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0154":"R","\u0155":"r","\u0158":"R","\u0159":"r","\u015A":"S","\u015B":"s","\u015E":"S","\u015F":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016A":"u","\u016B":"u","\u016E":"U","\u016F":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017A":"z","\u017B":"Z","\u017C":"z","\u017D":"Z","\u017E":"z","\u018F":"E","\u0192":"f","\u01A0":"O","\u01A1":"o","\u01AF":"U","\u01B0":"u","\u01C8":"LJ","\u01C9":"lj","\u01CB":"NJ","\u01CC":"nj","\u0218":"S","\u0219":"s","\u021A":"T","\u021B":"t","\u0259":"e","\u02DA":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038A":"I","\u038C":"O","\u038E":"Y","\u038F":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039A":"K","\u039B":"L","\u039C":"M","\u039D":"N","\u039E":"3","\u039F":"O","\u03A0":"P","\u03A1":"R","\u03A3":"S","\u03A4":"T","\u03A5":"Y","\u03A6":"F","\u03A7":"X","\u03A8":"PS","\u03A9":"W","\u03AA":"I","\u03AB":"Y","\u03AC":"a","\u03AD":"e","\u03AE":"h","\u03AF":"i","\u03B0":"y","\u03B1":"a","\u03B2":"b","\u03B3":"g","\u03B4":"d","\u03B5":"e","\u03B6":"z","\u03B7":"h","\u03B8":"8","\u03B9":"i","\u03BA":"k","\u03BB":"l","\u03BC":"m","\u03BD":"n","\u03BE":"3","\u03BF":"o","\u03C0":"p","\u03C1":"r","\u03C2":"s","\u03C3":"s","\u03C4":"t","\u03C5":"y","\u03C6":"f","\u03C7":"x","\u03C8":"ps","\u03C9":"w","\u03CA":"i","\u03CB":"y","\u03CC":"o","\u03CD":"y","\u03CE":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040A":"NJ","\u040B":"C","\u040F":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041A":"K","\u041B":"L","\u041C":"M","\u041D":"N","\u041E":"O","\u041F":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042A":"U","\u042B":"Y","\u042C":"","\u042D":"E","\u042E":"Yu","\u042F":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043A":"k","\u043B":"l","\u043C":"m","\u043D":"n","\u043E":"o","\u043F":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044A":"u","\u044B":"y","\u044C":"","\u044D":"e","\u044E":"yu","\u044F":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045A":"nj","\u045B":"c","\u045D":"u","\u045F":"dz","\u0490":"G","\u0491":"g","\u0492":"GH","\u0493":"gh","\u049A":"KH","\u049B":"kh","\u04A2":"NG","\u04A3":"ng","\u04AE":"UE","\u04AF":"ue","\u04B0":"U","\u04B1":"u","\u04BA":"H","\u04BB":"h","\u04D8":"AE","\u04D9":"ae","\u04E8":"OE","\u04E9":"oe","\u0531":"A","\u0532":"B","\u0533":"G","\u0534":"D","\u0535":"E","\u0536":"Z","\u0537":"E'","\u0538":"Y'","\u0539":"T'","\u053A":"JH","\u053B":"I","\u053C":"L","\u053D":"X","\u053E":"C'","\u053F":"K","\u0540":"H","\u0541":"D'","\u0542":"GH","\u0543":"TW","\u0544":"M","\u0545":"Y","\u0546":"N","\u0547":"SH","\u0549":"CH","\u054A":"P","\u054B":"J","\u054C":"R'","\u054D":"S","\u054E":"V","\u054F":"T","\u0550":"R","\u0551":"C","\u0553":"P'","\u0554":"Q'","\u0555":"O''","\u0556":"F","\u0587":"EV","\u0621":"a","\u0622":"aa","\u0623":"a","\u0624":"u","\u0625":"i","\u0626":"e","\u0627":"a","\u0628":"b","\u0629":"h","\u062A":"t","\u062B":"th","\u062C":"j","\u062D":"h","\u062E":"kh","\u062F":"d","\u0630":"th","\u0631":"r","\u0632":"z","\u0633":"s","\u0634":"sh","\u0635":"s","\u0636":"dh","\u0637":"t","\u0638":"z","\u0639":"a","\u063A":"gh","\u0641":"f","\u0642":"q","\u0643":"k","\u0644":"l","\u0645":"m","\u0646":"n","\u0647":"h","\u0648":"w","\u0649":"a","\u064A":"y","\u064B":"an","\u064C":"on","\u064D":"en","\u064E":"a","\u064F":"u","\u0650":"e","\u0652":"","\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u067E":"p","\u0686":"ch","\u0698":"zh","\u06A9":"k","\u06AF":"g","\u06CC":"y","\u06F0":"0","\u06F1":"1","\u06F2":"2","\u06F3":"3","\u06F4":"4","\u06F5":"5","\u06F6":"6","\u06F7":"7","\u06F8":"8","\u06F9":"9","\u0E3F":"baht","\u10D0":"a","\u10D1":"b","\u10D2":"g","\u10D3":"d","\u10D4":"e","\u10D5":"v","\u10D6":"z","\u10D7":"t","\u10D8":"i","\u10D9":"k","\u10DA":"l","\u10DB":"m","\u10DC":"n","\u10DD":"o","\u10DE":"p","\u10DF":"zh","\u10E0":"r","\u10E1":"s","\u10E2":"t","\u10E3":"u","\u10E4":"f","\u10E5":"k","\u10E6":"gh","\u10E7":"q","\u10E8":"sh","\u10E9":"ch","\u10EA":"ts","\u10EB":"dz","\u10EC":"ts","\u10ED":"ch","\u10EE":"kh","\u10EF":"j","\u10F0":"h","\u1E62":"S","\u1E63":"s","\u1E80":"W","\u1E81":"w","\u1E82":"W","\u1E83":"w","\u1E84":"W","\u1E85":"w","\u1E9E":"SS","\u1EA0":"A","\u1EA1":"a","\u1EA2":"A","\u1EA3":"a","\u1EA4":"A","\u1EA5":"a","\u1EA6":"A","\u1EA7":"a","\u1EA8":"A","\u1EA9":"a","\u1EAA":"A","\u1EAB":"a","\u1EAC":"A","\u1EAD":"a","\u1EAE":"A","\u1EAF":"a","\u1EB0":"A","\u1EB1":"a","\u1EB2":"A","\u1EB3":"a","\u1EB4":"A","\u1EB5":"a","\u1EB6":"A","\u1EB7":"a","\u1EB8":"E","\u1EB9":"e","\u1EBA":"E","\u1EBB":"e","\u1EBC":"E","\u1EBD":"e","\u1EBE":"E","\u1EBF":"e","\u1EC0":"E","\u1EC1":"e","\u1EC2":"E","\u1EC3":"e","\u1EC4":"E","\u1EC5":"e","\u1EC6":"E","\u1EC7":"e","\u1EC8":"I","\u1EC9":"i","\u1ECA":"I","\u1ECB":"i","\u1ECC":"O","\u1ECD":"o","\u1ECE":"O","\u1ECF":"o","\u1ED0":"O","\u1ED1":"o","\u1ED2":"O","\u1ED3":"o","\u1ED4":"O","\u1ED5":"o","\u1ED6":"O","\u1ED7":"o","\u1ED8":"O","\u1ED9":"o","\u1EDA":"O","\u1EDB":"o","\u1EDC":"O","\u1EDD":"o","\u1EDE":"O","\u1EDF":"o","\u1EE0":"O","\u1EE1":"o","\u1EE2":"O","\u1EE3":"o","\u1EE4":"U","\u1EE5":"u","\u1EE6":"U","\u1EE7":"u","\u1EE8":"U","\u1EE9":"u","\u1EEA":"U","\u1EEB":"u","\u1EEC":"U","\u1EED":"u","\u1EEE":"U","\u1EEF":"u","\u1EF0":"U","\u1EF1":"u","\u1EF2":"Y","\u1EF3":"y","\u1EF4":"Y","\u1EF5":"y","\u1EF6":"Y","\u1EF7":"y","\u1EF8":"Y","\u1EF9":"y","\u2013":"-","\u2018":"'","\u2019":"'","\u201C":"\\"","\u201D":"\\"","\u201E":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20A0":"ecu","\u20A2":"cruzeiro","\u20A3":"french franc","\u20A4":"lira","\u20A5":"mill","\u20A6":"naira","\u20A7":"peseta","\u20A8":"rupee","\u20A9":"won","\u20AA":"new shequel","\u20AB":"dong","\u20AC":"euro","\u20AD":"kip","\u20AE":"tugrik","\u20AF":"drachma","\u20B0":"penny","\u20B1":"peso","\u20B2":"guarani","\u20B3":"austral","\u20B4":"hryvnia","\u20B5":"cedi","\u20B8":"kazakhstani tenge","\u20B9":"indian rupee","\u20BA":"turkish lira","\u20BD":"russian ruble","\u20BF":"bitcoin","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221E":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\uFDFC":"rial","\uFEF5":"laa","\uFEF7":"laa","\uFEF9":"lai","\uFEFB":"la"}`),r=JSON.parse('{"bg":{"\u0419":"Y","\u0426":"Ts","\u0429":"Sht","\u042A":"A","\u042C":"Y","\u0439":"y","\u0446":"ts","\u0449":"sht","\u044A":"a","\u044C":"y"},"de":{"\xC4":"AE","\xE4":"ae","\xD6":"OE","\xF6":"oe","\xDC":"UE","\xFC":"ue","\xDF":"ss","%":"prozent","&":"und","|":"oder","\u2211":"summe","\u221E":"unendlich","\u2665":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","\xA2":"centavos","\xA3":"libras","\xA4":"moneda","\u20A3":"francos","\u2211":"suma","\u221E":"infinito","\u2665":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","\xA2":"centime","\xA3":"livre","\xA4":"devise","\u20A3":"franc","\u2211":"somme","\u221E":"infini","\u2665":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","\xA2":"centavo","\u2211":"soma","\xA3":"libra","\u221E":"infinito","\u2665":"amor"},"uk":{"\u0418":"Y","\u0438":"y","\u0419":"Y","\u0439":"y","\u0426":"Ts","\u0446":"ts","\u0425":"Kh","\u0445":"kh","\u0429":"Shch","\u0449":"shch","\u0413":"H","\u0433":"h"},"vi":{"\u0110":"D","\u0111":"d"},"da":{"\xD8":"OE","\xF8":"oe","\xC5":"AA","\xE5":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"st\xF8rre end"},"nb":{"&":"og","\xC5":"AA","\xC6":"AE","\xD8":"OE","\xE5":"aa","\xE6":"ae","\xF8":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","\xC5":"AA","\xC4":"AE","\xD6":"OE","\xE5":"aa","\xE4":"ae","\xF6":"oe"}}');function s(a,o){if(typeof a!="string")throw new Error("slugify: string argument expected");o=typeof o=="string"?{replacement:o}:o||{};var l=r[o.locale]||{},c=o.replacement===void 0?"-":o.replacement,d=o.trim===void 0?!0:o.trim,h=a.normalize().split("").reduce(function(f,p){var m=l[p]||t[p]||p;return m===c&&(m=" "),f+m.replace(o.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")},"");return o.strict&&(h=h.replace(/[^A-Za-z0-9\s]/g,"")),d&&(h=h.trim()),h=h.replace(/\s+/g,c),o.lower&&(h=h.toLowerCase()),h}return s.extend=function(a){Object.assign(t,a)},s})})(Gd);const wS=Gd.exports;function CS(n,e="-",t=!1){if(!n)return n;let r=wS(n,{lower:!0,replacement:e,strict:t,remove:/[*+~.()'"!:@?\|/\\]/g});return r||(r=n.replace(/\s+/g,"-").toLowerCase()),r}function NS({host:n,value:e="",placeholder:t,onChange:r,className:s,inputRef:a,onInputBlur:o,showLinkIcon:l=!0,pattern:c,minLength:d,maxLength:h,hideButton:f,...p}){const{base_url:m}=Ye(),b=p.prefix?`/${p.prefix}`:"",y=p.suffix?`/${p.suffix}`:"",[x,k]=v.exports.useState(!1),[M,T]=v.exports.useState(e);n=n||m,v.exports.useEffect(()=>{T(e)},[e]);const B=()=>{x?(k(!1),M&&(r==null||r(M))):k(!0)};let A="";return M?A=M:t&&(A=CS(t)),g("div",{className:P("flex items-center",s),children:[l&&i(Wi,{className:"icon-md text-muted"}),g("div",{className:"text-primary ml-6 mr-14",children:[n,b,!x&&A&&g(v.exports.Fragment,{children:[i("span",{children:"/"}),i("span",{className:"font-medium",children:A})]}),x?null:y]}),x&&i(un,{pattern:c,minLength:d,maxLength:h,onKeyDown:H=>{H.key==="Enter"&&B()},ref:a,"aria-label":"slug",autoFocus:!0,className:"mr-14",size:"2xs",value:M,onBlur:o,onChange:H=>{T(H.target.value)}}),!f&&i(E,{type:"button",color:"chip",variant:"outline",size:"2xs",onClick:()=>{B()},children:x?i(u,{message:"Save"}):i(u,{message:"Edit"})})]})}const MS=U(i("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"}),"UndoOutlined"),TS=U(i("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}),"RedoOutlined");function ES({editor:n}){return g("span",{children:[i(R,{size:"md",radius:"rounded",disabled:!n.can().undo(),onClick:()=>{n.commands.focus(),n.commands.undo()},children:i(MS,{})}),i(R,{size:"md",radius:"rounded",disabled:!n.can().redo(),onClick:()=>{n.commands.focus(),n.commands.redo()},children:i(TS,{})})]})}const Qd=U(i("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"}),"CodeOutlined");function OS({editor:n}){return g(W,{type:"modal",onClose:e=>{e!=null&&(n==null||n.commands.setContent(e))},children:[i(E,{variant:"text",startIcon:i(Qd,{}),children:i(u,{message:"Source code"})}),i(ac,{title:i(u,{message:"Source code"}),defaultValue:n.getHTML()})]})}function In(){return i("div",{className:"self-stretch mx-4 w-1 bg-divider flex-shrink-0"})}const AS=U(i("path",{d:"M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"}),"FormatBoldOutlined"),IS=U(i("path",{d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z"}),"FormatItalicOutlined"),DS=U(i("path",{d:"M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"}),"FormatUnderlinedOutlined");function zS({editor:n,size:e}){return g("span",{className:P("flex-shrink-0 whitespace-nowrap"),children:[i(R,{size:e,radius:"rounded",color:n.isActive("bold")?"primary":null,onClick:()=>{n.commands.focus(),n.commands.toggleBold()},children:i(AS,{})}),i(R,{size:e,radius:"rounded",color:n.isActive("italic")?"primary":null,onClick:()=>{n.commands.focus(),n.commands.toggleItalic()},children:i(IS,{})}),i(R,{size:e,radius:"rounded",color:n.isActive("underline")?"primary":null,onClick:()=>{n.commands.focus(),n.commands.toggleUnderline()},children:i(DS,{})})]})}const PS=U(i("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"}),"FormatListBulletedOutlined"),RS=U(i("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"}),"FormatListNumberedOutlined");function FS({editor:n,size:e}){const t=n.isActive("bulletList"),r=n.isActive("orderedList");return g("span",{className:P("flex-shrink-0","whitespace-nowrap"),children:[i(R,{size:e,radius:"rounded",color:t?"primary":null,onClick:()=>{n.commands.focus(),n.commands.toggleBulletList()},children:i(PS,{})}),i(R,{size:e,radius:"rounded",color:r?"primary":null,onClick:()=>{n.commands.focus(),n.commands.toggleOrderedList()},children:i(RS,{})})]})}function LS({editor:n,size:e}){return g(W,{type:"modal",children:[i(R,{size:e,radius:"rounded",className:P("flex-shrink-0"),children:i(Wi,{})}),i(_S,{editor:n})]})}function _S({editor:n}){const e=n.getAttributes("link").href,t=n.state.doc.textBetween(n.state.selection.from,n.state.selection.to,""),r=ae({defaultValues:{href:e,text:t}}),{formId:s,close:a}=oe();return g(ue,{children:[i(ve,{children:i(u,{message:"Insert link"})}),i(pe,{children:g(Ee,{form:r,id:s,onSubmit:o=>{n.state.selection.empty&&o.text?n.commands.insertContent(`<a href="${o.href}" target="${o.target}">${o.text}</a>`):n.state.selection.empty||(o.href?n.chain().focus().extendMarkRange("link").setLink({href:o.href,target:o.target}).run():n.chain().focus().extendMarkRange("link").unsetLink().run()),a()},children:[i(w,{name:"href",label:i(u,{message:"URL"}),autoFocus:!0,type:"url",className:"mb-20"}),i(w,{name:"text",label:i(u,{message:"Text to display"}),className:"mb-20"}),g(se,{selectionMode:"single",name:"target",label:i(u,{message:"Open link in..."}),children:[i(C,{value:"_self",children:i(u,{message:"Current window"})}),i(C,{value:"_blank",children:i(u,{message:"New window"})})]})]})}),g(ze,{children:[i(E,{onClick:a,variant:"text",children:i(u,{message:"Cancel"})}),i(E,{type:"submit",form:s,variant:"flat",color:"primary",children:i(u,{message:"Save"})})]})]})}const BS=U(i("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86-3 3.87L9 13.14 6 17h12l-3.86-5.14z"}),"ImageOutlined"),$S=2097152;function VS({editor:n,size:e}){const{selectAndUploadFile:t}=zu();return i(R,{size:e,radius:"rounded",onClick:()=>{t({showToastOnRestrictionFail:!0,restrictions:{allowedFileTypes:[Pu.image],maxFileSize:$S},metadata:{diskPrefix:"page_media",disk:Ru.public},onSuccess:s=>{n.commands.focus(),n.commands.setImage({src:s.url})}})},className:P("flex-shrink-0"),children:i(BS,{})})}const HS=U(i("path",{d:"M20 8V5H6.39l3 3h1.83l-.55 1.28 2.09 2.1L14.21 8zM3.41 4.86 2 6.27l6.97 6.97L6.5 19h3l1.57-3.66L16.73 21l1.41-1.41z"}),"FormatClearOutlined");function qS({editor:n,size:e}){return i(R,{className:P("flex-shrink-0"),size:e,radius:"rounded",onClick:()=>{n.chain().focus().clearNodes().unsetAllMarks().run()},children:i(HS,{})})}const US=U(i("path",{fillRule:"evenodd",d:"M4 11h16v2H4z"}),"HorizontalRuleOutlined"),WS=U([i("circle",{cx:"12",cy:"19",r:"2"},"0"),i("path",{d:"M10 3h4v12h-4z"},"1")],"PriorityHighOutlined"),jS=U(i("path",{d:"M16 4H4c-1.1 0-2 .9-2 2v12.01c0 1.1.9 1.99 2 1.99h16c1.1 0 2-.9 2-2v-8l-6-6zM4 18.01V6h11v5h5v7.01H4z"}),"NoteOutlined"),JS=U([i("path",{d:"M9.5 7.5v9l7-4.5z"},"0"),i("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14.01H4V5.99h16v12.02z"},"1")],"SmartDisplayOutlined");function KS({editor:n,size:e}){const[t,r]=v.exports.useState(!1);return g(re,{children:[g(yr,{onItemSelected:s=>{s==="hr"?(n.commands.focus(),n.commands.setHorizontalRule()):s==="embed"?r("embed"):(n.commands.focus(),n.commands.addInfo({type:s}))},children:[i(R,{variant:"text",size:e,radius:"rounded",className:P("flex-shrink-0"),children:i(ol,{})}),g(vr,{children:[i(C,{value:"hr",startIcon:i(US,{}),children:i(u,{message:"Horizontal rule"})}),i(C,{value:"embed",startIcon:i(JS,{}),children:i(u,{message:"Embed"})}),i(C,{value:"important",startIcon:i(WS,{}),children:i(u,{message:"Important"})}),i(C,{value:"warning",startIcon:i(Fu,{}),children:i(u,{message:"Warning"})}),i(C,{value:"success",startIcon:i(jS,{}),children:i(u,{message:"Note"})})]})]}),i(W,{type:"modal",isOpen:!!t,onClose:()=>{r(!1)},children:i(GS,{editor:n})})]})}function GS({editor:n}){const e=n.getAttributes("embed").src,t=ae({defaultValues:{src:e}}),{formId:r,close:s}=oe();return g(ue,{children:[i(ve,{children:i(u,{message:"Insert link"})}),i(pe,{children:i(Ee,{form:t,id:r,onSubmit:a=>{n.commands.setEmbed(a),s()},children:i(w,{name:"src",label:i(u,{message:"Embed URL"}),autoFocus:!0,type:"url",required:!0})})}),g(ze,{children:[i(E,{onClick:s,variant:"text",children:i(u,{message:"Cancel"})}),i(E,{type:"submit",form:r,disabled:!t.formState.isValid,variant:"flat",color:"primary",children:i(u,{message:"Add"})})]})]})}function ot({children:n,modifier:e,separator:t="+"}){const r=Lu()?i("span",{className:"text-base align-middle",children:"\u2318"}):"Ctrl";return g("kbd",{className:"text-xs text-muted",children:[e&&g(re,{children:[r,t]}),n]})}function QS({editor:n,size:e}){return g(yr,{floatingMinWidth:"w-256",onItemSelected:t=>{n.commands.focus(),typeof t=="string"&&t.startsWith("h")?n.commands.toggleHeading({level:parseInt(t.replace("h",""))}):t==="code"?n.commands.toggleCode():t==="strike"?n.commands.toggleStrike():t==="super"?n.commands.toggleSuperscript():t==="sub"?n.commands.toggleSubscript():t==="blockquote"?n.commands.toggleBlockquote():t==="paragraph"&&n.commands.setParagraph()},children:[i(E,{className:P("flex-shrink-0"),variant:"text",size:e,endIcon:i(Wo,{}),children:i(u,{message:"Format"})}),g(vr,{children:[i(C,{value:"h1",endSection:i(ot,{modifier:!0,children:"Alt+1"}),children:i(u,{message:"Heading :number",values:{number:1}})}),i(C,{value:"h2",endSection:i(ot,{modifier:!0,children:"Alt+2"}),children:i(u,{message:"Heading :number",values:{number:2}})}),i(C,{value:"h3",endSection:i(ot,{modifier:!0,children:"Alt+3"}),children:i(u,{message:"Heading :number",values:{number:3}})}),i(C,{value:"h4",endSection:i(ot,{modifier:!0,children:"Alt+4"}),children:i(u,{message:"Heading :number",values:{number:4}})}),i(C,{value:"code",endSection:i(ot,{modifier:!0,children:"E"}),children:i(u,{message:"Code"})}),i(C,{value:"strike",endSection:i(ot,{modifier:!0,children:"Shift+X"}),children:i(u,{message:"Strikethrough"})}),i(C,{value:"super",endSection:i(ot,{modifier:!0,separator:" ",children:"."}),children:i(u,{message:"Superscript"})}),i(C,{value:"sub",endSection:i(ot,{modifier:!0,separator:" ",children:","}),children:i(u,{message:"Subscript"})}),i(C,{value:"blockquote",endSection:i(ot,{modifier:!0,children:"Shift+B"}),children:i(u,{message:"Blockquote"})}),i(C,{value:"paragraph",endSection:i(ot,{modifier:!0,children:"Alt+0"}),children:i(u,{message:"Paragraph"})})]})]})}const YS=U(i("path",{d:"M2 20h20v4H2v-4zm3.49-3h2.42l1.27-3.58h5.65L16.09 17h2.42L13.25 3h-2.5L5.49 17zm4.42-5.61 2.03-5.79h.12l2.03 5.79H9.91z"}),"FormatColorTextOutlined"),XS=U(i("path",{d:"M16.56 8.94 7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10 10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5zM2 20h20v4H2v-4z"}),"FormatColorFillOutlined");function ZS({editor:n,size:e}){const[t,r]=v.exports.useState(!1),s=n.getAttributes("textStyle").color,a=n.getAttributes("textStyle").backgroundColor;return g(v.exports.Fragment,{children:[g("span",{className:P("flex-shrink-0 whitespace-nowrap"),children:[i(R,{size:e,radius:"rounded",color:s?"primary":null,onClick:()=>{r("text")},children:i(YS,{})}),i(R,{size:e,radius:"rounded",color:a?"primary":null,onClick:()=>{r("bg")},children:i(XS,{})})]}),i(W,{currentValue:t==="text"?"#000000":"#FFFFFF",type:"modal",isOpen:!!t,onClose:o=>{o&&(t==="text"?n.commands.setColor(o):n.commands.setBackgroundColor(o)),r(!1)},children:i(Gi,{defaultValue:t==="text"?"#000000":"#FFFFFF"})})]})}const ek=U(i("path",{d:"M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"}),"FormatAlignLeftOutlined"),tk=U(i("path",{d:"M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"}),"FormatAlignCenterOutlined"),nk=U(i("path",{d:"M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"}),"FormatAlignRightOutlined"),rk=U(i("path",{d:"M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z"}),"FormatAlignJustifyOutlined"),Pr={left:{icon:ek,label:S("Align left")},center:{icon:tk,label:S("Align center")},right:{icon:nk,label:S("Align right")},justify:{icon:rk,label:S("Justify")}};function sk({editor:n,size:e}){const t=Object.keys(Pr).find(s=>n.isActive({textAlign:s}))||"left",r=t?Pr[t].icon:Pr.left.icon;return g(yr,{floatingWidth:"auto",selectionMode:"single",selectedValue:t,onSelectionChange:s=>{n.commands.focus(),n.commands.setTextAlign(s)},children:[i(R,{size:e,color:t?"primary":null,radius:"rounded",className:P("flex-shrink-0"),children:i(r,{})}),i(vr,{children:Object.entries(Pr).map(([s,a])=>{const o=a.icon;return i(C,{value:s,startIcon:i(o,{size:"md"}),capitalizeFirst:!0,children:i(u,{message:a.label.message})},s)})})]})}const ik=U(i("path",{d:"M11 17h10v-2H11v2zm-8-5 4 4V8l-4 4zm0 9h18v-2H3v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"}),"FormatIndentDecreaseOutlined"),ak=U(i("path",{d:"M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"}),"FormatIndentIncreaseOutlined");function ok({editor:n,size:e}){return g("span",{className:P("flex-shrink-0","whitespace-nowrap"),children:[i(R,{size:e,radius:"rounded",onClick:()=>{n.commands.focus(),n.commands.outdent()},children:i(ik,{})}),i(R,{size:e,radius:"rounded",onClick:()=>{n.commands.focus(),n.commands.indent()},children:i(ak,{})})]})}function lk({editor:n,size:e}){const t=n.getAttributes("codeBlock").language||"";return g(yr,{selectionMode:"single",selectedValue:t,onSelectionChange:r=>{n.commands.toggleCodeBlock({language:r})},children:[i(R,{className:P("flex-shrink-0"),size:e,color:t?"primary":null,radius:"rounded",children:i(Qd,{})}),g(vr,{children:[i(C,{value:"html",children:"HTML"}),i(C,{value:"javascript",children:"JavaScript"}),i(C,{value:"css",children:"CSS"}),i(C,{value:"php",children:"PHP"}),i(C,{value:"shell",children:"Shell"}),i(C,{value:"bash",children:"Bash"}),i(C,{value:"ruby",children:"Ruby"}),i(C,{value:"python",children:"Python"}),i(C,{value:"java",children:"Java"}),i(C,{value:"c++",children:"C++"})]})]})}const ck=U(i("path",{d:"M7.41 18.59 8.83 20 12 16.83 15.17 20l1.41-1.41L12 14l-4.59 4.59zm9.18-13.18L15.17 4 12 7.17 8.83 4 7.41 5.41 12 10l4.59-4.59z"}),"UnfoldLessOutlined"),$o="flex items-center justify-center px-4 h-42 text-muted border-b overflow-hidden";function dk({editor:n,size:e="md"}){const t=Xe(),[r,s]=v.exports.useState(!1);return g("div",{className:P(r?"h-84":"h-42"),children:[g("div",{className:P($o,"relative z-20"),children:[i(QS,{editor:n,size:e}),i(In,{}),i(zS,{editor:n,size:e}),i(In,{}),i(sk,{editor:n,size:e}),i(ok,{editor:n,size:e}),i(In,{}),t?i(R,{className:"flex-shrink-0",color:r?"primary":null,size:e,radius:"rounded",onClick:()=>{s(!r)},children:r?i(ck,{}):i(gh,{})}):i(Vo,{editor:n,size:e})]}),i(or,{children:r&&i(Dn.div,{className:P($o,"absolute w-full h-full flex"),initial:{y:"-100%"},animate:{y:0},exit:{y:"-100%"},children:i(Vo,{editor:n,size:e})})})]})}function Vo({editor:n,size:e="md"}){return g(v.exports.Fragment,{children:[i(FS,{editor:n,size:e}),i(In,{}),i(LS,{editor:n,size:e}),i(VS,{editor:n,size:e}),i(KS,{editor:n,size:e}),i(In,{}),i(ZS,{editor:n,size:e}),i(In,{}),i(lk,{editor:n,size:e}),i(qS,{editor:n,size:e})]})}function Yd({editor:n,allowSlugEditing:e=!0,onSave:t,isLoading:r,backLink:s}){const{isSticky:a,sentinelRef:o}=hc(),l=Xe();return g(v.exports.Fragment,{children:[i("div",{ref:o}),g("div",{className:P("sticky top-0 z-10 mb-20 bg-paper",a&&"shadow"),children:[g("div",{className:"px-20 py-10 flex items-center justify-between sm:justify-start gap-20 border-b text-muted",children:[!l&&g(v.exports.Fragment,{children:[i(E,{variant:"text",size:"sm",elementType:le,to:s,relative:"path",startIcon:i(bh,{}),children:i(u,{message:"Back"})}),i("div",{className:"mr-auto",children:e&&i(hk,{name:"slug",showLinkIcon:!1,prefix:"pages"})})]}),n&&i(ES,{editor:n}),!l&&i(OS,{editor:n}),i(uk,{onSave:()=>{t(n.getHTML())},isLoading:r})]}),i(dk,{editor:n,size:"sm"})]})]})}function uk({onSave:n,isLoading:e}){const r=_().watch("title");return i(E,{variant:"flat",size:"sm",color:"primary",className:"min-w-90",disabled:e||!r,onClick:()=>n(),children:i(u,{message:"Save"})})}function hk({name:n,...e}){const{field:{onChange:t,onBlur:r,value:s="",ref:a}}=Bn({name:n}),o=v.exports.useRef(!1),{watch:l,setValue:c}=_();return v.exports.useEffect(()=>{const d=l((h,{name:f})=>{f==="title"&&!o.current&&c("slug",h.title)});return()=>d.unsubscribe()},[l,c]),i(NS,{className:P(!s&&"invisible"),onChange:d=>{o.current=!0,t(d)},onInputBlur:r,value:s,inputRef:a,...e})}const fk=Z.lazy(()=>gr(()=>import("./article-body-editor.939d5c08.js"),["./article-body-editor.939d5c08.js","./main.2bd0a4cf.js","./main.21a886d7.css","./format.eba72cc5.js","./UnfoldMore.ea196e44.js","./Edit.da0e054a.js","./use-resume-subscription.20c77bdf.js","./article-body-editor.b603c7db.css"],import.meta.url));function pk(){const n=_u();return n.data?g(v.exports.Fragment,{children:[i(Bu,{query:n}),i(mk,{page:n.data.page})]}):i("div",{className:"relative w-full h-full",children:i($u,{query:n})})}function mk({page:n}){const e=Fe(),t=Fy(),r=ae({defaultValues:{title:n.title,slug:n.slug,body:n.body}}),s=a=>{t.mutate({...r.getValues(),body:a},{onSuccess:()=>e("../..",{relative:"path"})})};return i(v.exports.Suspense,{fallback:i(mn,{}),children:i(fk,{initialContent:n.body,children:a=>i(br,{children:g(il,{...r,children:[i(Yd,{editor:a,backLink:"../..",isLoading:t.isLoading,onSave:s}),i("div",{className:"mx-20",children:g("div",{className:"prose dark:prose-invert mx-auto flex-auto",children:[i(Ec,{}),i(Kd,{editor:a})]})})]})})})})}function gk(n){const e=n||"custom-pages";return te(t=>bk(t,e),{onError:t=>Oe(t),onSuccess:async()=>{await G.invalidateQueries(["custom-pages"]),await G.invalidateQueries(ce(e)),ne(S("Page created"))}})}function bk(n,e){return q.post(`${e}`,n).then(t=>t.data)}const yk=Z.lazy(()=>gr(()=>import("./article-body-editor.939d5c08.js"),["./article-body-editor.939d5c08.js","./main.2bd0a4cf.js","./main.21a886d7.css","./format.eba72cc5.js","./UnfoldMore.ea196e44.js","./Edit.da0e054a.js","./use-resume-subscription.20c77bdf.js","./article-body-editor.b603c7db.css"],import.meta.url));function vk(){const n=Fe(),e=gk(),t=ae(),r=s=>{e.mutate({...t.getValues(),body:s},{onSuccess:()=>n("../",{relative:"path"})})};return i(v.exports.Suspense,{fallback:i(mn,{}),children:i(yk,{children:s=>i(br,{children:g(il,{...t,children:[i(Yd,{editor:s,isLoading:e.isLoading,onSave:r,backLink:"../"}),i("div",{className:"mx-20",children:g("div",{className:"prose dark:prose-invert mx-auto flex-auto",children:[i(Ec,{}),i(Kd,{editor:s})]})})]})})})})}const xk=Z.lazy(()=>gr(()=>import("./admin-report-page.0c643472.js"),["./admin-report-page.0c643472.js","./main.2bd0a4cf.js","./main.21a886d7.css","./TrendingUp.a8209b48.js","./UnfoldMore.ea196e44.js","./Edit.da0e054a.js","./use-resume-subscription.20c77bdf.js"],import.meta.url)),Sk=[{path:"appearance",element:i(he,{permission:"appearance.update",children:i(bp,{})}),children:[{index:!0,element:i(rb,{})},{path:"general",element:i(Bp,{})},{path:"seo-settings",element:i(Up,{})},{path:"custom-code",element:i(Jp,{})},{path:"themes",element:i(qp,{})},{path:"themes/:themeIndex",element:i(km,{})},{path:"menus",element:i(Sp,{})},{path:"menus/:menuIndex",element:i(Ip,{})},{path:"menus/:menuIndex/items/:menuItemIndex",element:i(Fp,{})},...Object.values(rc.sections).flatMap(n=>n.routes||[])]},{path:"/",element:i(Sh,{}),children:[...Ry,{path:"/",element:i(Z.Suspense,{fallback:i(mn,{screen:!0}),children:i(xk,{})})},{path:"users",element:i(he,{permission:"users.update",children:i(Gh,{})})},{path:"users/new",element:i(he,{permission:"users.update",children:i(Rg,{})})},{path:"users/:userId/edit",element:i(he,{permission:"users.update",children:i(Ig,{})})},{path:"roles",element:i(he,{permission:"roles.update",children:i(ab,{})})},{path:"roles/new",element:i(he,{permission:"roles.update",children:i(Eb,{})})},{path:"roles/:roleId/edit",element:i(he,{permission:"roles.update",children:i(wb,{})})},{path:"subscriptions",element:i(he,{permission:"subscriptions.update",children:i(ty,{})})},{path:"plans",element:i(he,{permission:"plans.update",children:i(my,{})})},{path:"plans/new",element:i(he,{permission:"plans.update",children:i(Iy,{})})},{path:"plans/:productId/edit",element:i(he,{permission:"plans.update",children:i(Ty,{})})},{path:"custom-pages",element:i(he,{permission:"custom_pages.update",children:i(Yp,{})})},{path:"custom-pages/new",element:i(he,{permission:"custom_pages.update",children:i(vk,{})})},{path:"custom-pages/:pageId/edit",element:i(he,{permission:"custom_pages.update",children:i(pk,{})})},{path:"tags",element:i(he,{permission:"tags.update",children:i(Lb,{})})},{path:"localizations",element:i(he,{permission:"localizations.update",children:i(jg,{})})},{path:"localizations/:localeId/translate",element:i(Gg,{})},{path:"files",element:i(he,{permission:"files.update",children:i(qb,{})})},{path:"ads",element:i(he,{permission:"settings.update",children:i(eb,{})})},{path:"settings",element:i(he,{permission:"settings.update",children:i(em,{})}),children:[{index:!0,element:i(tl,{to:"general",replace:!0})},{path:"general",element:i(dm,{})},{path:"subscriptions",element:i(Em,{})},{path:"localization",element:i(Im,{})},{path:"authentication",element:i(Dm,{})},{path:"uploading",element:i(Gm,{})},{path:"mail",element:i(ug,{})},{path:"cache",element:i(mg,{})},{path:"analytics",element:i(Tg,{})},{path:"logging",element:i(yg,{})},{path:"queue",element:i(xg,{})},{path:"recaptcha",element:i(wg,{})},{path:"gdpr",element:i(Dy,{})},...Nm]}]},{path:"*",element:i(Hu,{})}];function kk(){return Vu(Sk)}const Lk=Object.freeze(Object.defineProperty({__proto__:null,default:kk},Symbol.toStringTag,{value:"Module"}));export{jS as $,tt as A,Oh as B,Qd as C,ge as D,wt as E,Bb as F,tk as G,rk as H,ek as I,nk as J,AS as K,HS as L,ns as M,Ei as N,XS as O,Ut as P,YS as Q,ik as R,V as S,J as T,ak as U,IS as V,PS as W,RS as X,DS as Y,US as Z,BS as _,Ik as a,Xb as a0,fl as a1,Zb as a2,WS as a3,TS as a4,xm as a5,JS as a6,oy as a7,Fg as a8,bm as a9,MS as aa,ck as ab,$b as ac,Os as ad,Lk as ae,Rk as b,zk as c,Cr as d,k0 as e,L as f,N as g,O as h,et as i,$ as j,hv as k,I as l,Rv as m,sr as n,Dk as o,Tk as p,Ak as q,Jd as r,Ok as s,gm as t,Lx as u,jd as v,Pk as w,Ek as x,Fk as y,wp as z};
//# sourceMappingURL=admin-routes.25102cc6.js.map

import{c4 as Ss,c5 as Tt,c6 as ks,c7 as Is,c8 as Es,c9 as Ds,H as A,at as en,au as tn,bk as Be,bl as rt,aE as it,ca as nn,d as P,G as M,L as z,m as f,J as F,cb as K,j as m,a as t,aM as oe,g as L,K as sn,aN as le,I as T,T as d,e as Ie,a1 as ie,B as C,bn as Ps,b1 as Ee,v as W,r as h,Q as De,cc as Ns,w as He,R as Cs,c as N,cd as Fs,bo as rn,ce as Ms,b as ce,aU as ge,cf as Z,cg as j,u as Ye,c0 as _t,ch as Ue,aT as As,a0 as We,s as an,aB as Ls,av as on,aA as ve,ci as ot,A as q,l as B,y as lt,t as de,af as ct,aq as zt,az as ln,N as Ge,bi as cn,cj as Rs,ck as Q,V as Pe,q as Ne,n as X,D as J,o as ee,p as Y,F as Ce,W as Fe,U as ye,cl as dt,M as xe,ai as dn,cm as un,Z as we,cn as ut,co as Ts,aa as mn,Y as _s,b6 as $t,k as zs,a8 as Ve,$ as Ot,i as $s,aF as te,a5 as Ze,cp as Os,C as Bs,X as pn,bT as Xe,bP as Us,x as Je,cq as Ws,bj as Vs,cr as fn,aw as Oe,cs as Ks,ba as Qs,ct as js,aJ as qs,cu as Hs,bq as Ys,bp as Gs,cv as Zs,ak as Xs,al as Js,E as er,bg as tr,bh as re}from"./main.2bd0a4cf.js";import{V as hn,k as Ke,l as Qe,W as mt,L as nr,x as pt,X as ft,M as ht,T as gn,J as vn,D as bn,a as yn,c as xn,Y as sr,Z as wn,y as gt,Q as rr,j as Sn,t as et,s as kn,_ as ar,F as _e,d as ze,e as ir,u as or,$ as ne,i as lr,w as In,p as En,v as Bt,a0 as cr,a1 as dr,a2 as ur,E as mr,A as vt,G as pr,U as fr,q as bt,n as Ut,m as hr,R as gr,a3 as Wt,b as Vt}from"./UnfoldMore.ea196e44.js";import{I as vr,R as br,P as Dn,S as yr,a as xr,D as wr,b as Sr,C as kr,c as Ir,d as yt,F as Pn,e as Nn,f as Er,g as Dr,G as Pr,h as Nr,i as Cr,A as Fr,B as Mr,j as xt,U as Ar,k as Lr,V as Rr,l as Tr,m as _r}from"./Info.85b22dea.js";import{B as wt,a as je,E as zr,C as $r}from"./Edit.da0e054a.js";class Or extends Ss{constructor(n,s){super(n,s)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(n,s){super.setOptions({...n,behavior:Tt()},s)}getOptimisticResult(n){return n.behavior=Tt(),super.getOptimisticResult(n)}fetchNextPage({pageParam:n,...s}={}){return this.fetch({...s,meta:{fetchMore:{direction:"forward",pageParam:n}}})}fetchPreviousPage({pageParam:n,...s}={}){return this.fetch({...s,meta:{fetchMore:{direction:"backward",pageParam:n}}})}createResult(n,s){var r,a,i,o,l,c;const{state:u}=n,g=super.createResult(n,s),{isFetching:p,isRefetching:b}=g,y=p&&((r=u.fetchMeta)==null||(a=r.fetchMore)==null?void 0:a.direction)==="forward",S=p&&((i=u.fetchMeta)==null||(o=i.fetchMore)==null?void 0:o.direction)==="backward";return{...g,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:ks(s,(l=u.data)==null?void 0:l.pages),hasPreviousPage:Is(s,(c=u.data)==null?void 0:c.pages),isFetchingNextPage:y,isFetchingPreviousPage:S,isRefetching:b&&!y&&!S}}}function Cn(e,n,s){const r=Es(e,n,s);return Ds(r,Or)}const _={fetchEntries:e=>{const n=["drive-entries"];return e&&n.push(e),n},fetchUserFolders(e){const n=["user-folders"];return e&&n.push(e),n},fetchShareableLink:e=>{const n=["shareable-link"];return e&&n.push(e),n},fetchFolderPath(e,n){const s=["folder-path"];return e&&s.push(e),n&&s.push(n),s},fetchEntryShareableLink:e=>["file-entries",e,"shareable-link"],fetchFileEntry:e=>{const n=["drive/file-entries/model"];return e&&n.push(e),n},fetchStorageSummary:["storage-summary"]};function U(){return Promise.all([A.invalidateQueries(_.fetchEntries()),A.invalidateQueries(_.fetchFolderPath()),A.invalidateQueries(_.fetchUserFolders()),A.invalidateQueries(_.fetchFileEntry())])}const V=en()(tn(e=>({password:null,viewMode:Be("drive.viewMode"),activeSort:{orderBy:"updated_at",orderDir:"desc"},setPassword:n=>{e(s=>{s.password=n})},isPasswordProtected:!1,setIsPasswordProtected:n=>{e(s=>{s.isPasswordProtected=n})},setViewMode:n=>{e(s=>{s.viewMode=n,rt("drive.viewMode",n)})},setActiveSort:n=>{e(s=>{s.activeSort=n})}})));function fe(){return V.getState()}function Br({hash:e,page:n=1,order:s,password:r}){return P.get(`shareable-links/${e}`,{params:{withEntries:!0,page:n,order:s,password:r}}).then(a=>a.data)}function se(){var l,c;const{hash:e}=it(),{orderBy:n,orderDir:s}=V(u=>u.activeSort),r=`${n}:${s}`,a=V(u=>u.isPasswordProtected),i=V(u=>u.password),o=Cn(_.fetchShareableLink({hash:e,sort:r}),({pageParam:u=1})=>Br({hash:e,page:u,order:r,password:i}),{getNextPageParam:u=>{if(!u.folderChildren)return;const g=u.folderChildren.current_page,p=u.folderChildren.last_page;if(!(g>=p))return g+1},enabled:!!e&&!a||i!=null,keepPreviousData:!0,retry:(u,g)=>Kt(g)?!1:u<=2,onError:u=>{if(Kt(u))return fe().setIsPasswordProtected(!0)}});return{...o,link:(l=o.data)==null?void 0:l.pages[0].link,entries:(c=o.data)==null?void 0:c.pages.flatMap(u=>{var g;return(g=u.folderChildren)==null?void 0:g.data})}}function Kt(e){var n,s;return nn.isAxiosError(e)&&((s=(n=e.response)==null?void 0:n.data)==null?void 0:s.passwordInvalid)}function Ur({password:e,linkHash:n}){return P.post(`shareable-links/${n}/check-password`,{password:e}).then(s=>s.data)}function Wr(){return M(e=>Ur(e),{onSuccess:(e,n)=>{e.matches&&fe().setPassword(n.password)},onError:e=>z(e,f("Could not create link"))})}function Vr({linkId:e,password:n}){return P.post(`shareable-links/${e}/import`,{password:n}).then(s=>s.data)}function Kr(){const e=V(n=>n.password);return M(n=>Vr({...n,password:e}),{onSuccess:()=>{F(f("Item imported into your drive")),A.invalidateQueries(_.fetchShareableLink())},onError:n=>z(n,f("Could not create link"))})}function Fn(){var o;const{link:e}=se(),{user:n,isLoggedIn:s}=K(),{downloadUrl:r}=hn(e==null?void 0:e.entry),a=Kr(),i=(o=e==null?void 0:e.entry)==null?void 0:o.users.find(l=>l.id===(n==null?void 0:n.id));return e!=null&&e.entry?m("div",{children:[e.allow_download&&t(Qr,{downloadUrl:r}),!i&&s&&e.allow_edit&&m(oe,{onItemSelected:l=>{l==="import"?a.mutate({linkId:e.id}):l==="download"&&r&&Ke(r)},children:[t(L,{className:"ml-6",disabled:a.isLoading,children:t(sn,{})}),m(le,{children:[t(T,{value:"download",startIcon:t(Qe,{}),children:t(d,{message:"Download"})}),t(T,{value:"import",startIcon:t(vr,{}),children:t(d,{message:"Save a copy to your own drive"})})]})]})]}):null}function Qr({downloadUrl:e}){return Ie()?t(ie,{label:t(d,{message:"Download"}),children:t(L,{onClick:()=>{e&&Ke(e)},children:t(Qe,{})})}):t(C,{size:"sm",variant:"flat",color:"chip",startIcon:t(Qe,{}),onClick:()=>{e&&Ke(e)},children:t(d,{message:"Download"})})}function Mn(){const{link:e}=se(),n=Ie();return t(Ps,{size:"md",color:"bg",className:"flex-shrink-0",rightChildren:(e==null?void 0:e.entry)&&t(Fn,{}),menuPosition:"shareable-link-page",hideLogo:n,children:(e==null?void 0:e.entry)&&e.entry.type!=="folder"&&m("div",{className:"flex items-center gap-10",children:[t(Ee,{className:"flex-shrink-0",type:e.entry.type}),t("div",{className:"font-medium whitespace-nowrap overflow-hidden overflow-ellipsis flex-auto",children:e.entry.name})]})})}function jr(){const{trans:e}=W(),{hash:n}=it(),s=e({message:"Password"}),[r,a]=h.exports.useState(""),i=Wr(),o=n?n.split(":")[0]:null,l=i.data&&!i.data.matches;return m("div",{className:"bg-alt h-screen flex flex-col",children:[t(Mn,{}),t("div",{className:"px-10 md:px-20 mx-auto my-80",children:m("div",{className:"flex flex-col md:flex-row gap-40 md:gap-14 bg items-center max-w-[560px] border rounded p-24",children:[t("div",{className:"h-132",children:t(De,{src:Ns})}),m("form",{onSubmit:c=>{c.preventDefault(),i.mutate({linkHash:o,password:r})},children:[t("span",{className:"text-sm",children:t(d,{message:"The link you are trying to access is password protected."})}),t(He,{autoFocus:!0,placeholder:s,"aria-label":s,className:"mt-10 mb-20",type:"password",value:r,required:!0,errorMessage:l&&t(d,{message:"Password is not valid"}),onChange:c=>{a(c.target.value)}}),t("div",{className:"text-right",children:t(C,{variant:"flat",color:"primary",type:"submit",className:"w-full md:w-auto",disabled:i.isLoading,children:t(d,{message:"Enter"})})})]})]})})]})}const An=Cs.forwardRef(({entry:e,className:n,isSelected:s,isMobileMode:r,footerAdornment:a,...i},o)=>m("div",{...i,ref:o,className:N("shadow rounded border aspect-square flex flex-col grid-item transition-shadow-opacity select-none overflow-hidden outline-none dark:bg-alt",s&&"border-primary",n),children:[t("div",{className:"flex-auto relative min-h-0",children:t(mt,{className:"h-full w-full",iconClassName:"block w-70 h-70 absolute m-auto inset-0",file:e})}),t(qr,{entry:e,isSelected:s,isMobile:r,adornment:a})]}));function qr({entry:e,isSelected:n,isMobile:s,adornment:r}){return m("div",{className:N("text-sm h-48 flex-shrink-0 flex items-center",s?"justify-between gap-10 pl-18 pr-2":"justify-center px-16",n&&"bg-primary-light/20"),children:[t("div",{className:"min-w-0 whitespace-nowrap overflow-hidden overflow-ellipsis",children:e.name}),r]})}function Hr({entries:e,onEntrySelected:n}){return t("div",{className:"file-grid",children:e.map((s,r)=>t(An,{tabIndex:-1,className:"hover:shadow-md cursor-pointer bg",entry:s,onContextMenu:a=>{a.preventDefault()},onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&n(s,r)},onClick:()=>{n(s,r)}},s.id))})}const Yr=[];Fs();var Xt,Jt;const Qt={uploadQueueIsOpen:!1,contextMenuData:null,selectedEntries:new Set,entriesBeingDragged:[],activeActionDialog:null,sidebarExpandedKeys:[],viewMode:Be("drive.viewMode",((Jt=(Xt=rn().settings)==null?void 0:Xt.drive)==null?void 0:Jt.default_view)||"grid"),sortDescriptor:{orderBy:"updated_at",orderDir:"desc"}},k=en()(tn((e,n)=>({...Qt,setUploadQueueIsOpen:s=>{e(r=>{r.uploadQueueIsOpen=s})},setContextMenuData:s=>{e(r=>{r.contextMenuData=s})},setSortDescriptor:s=>{e(r=>{var i;const a=(i=n().activePage)==null?void 0:i.id;a&&rt("selectedSorting",{...Be("selectedSorting"),[a]:s}),r.sortDescriptor=s})},setActivePage:s=>{e(r=>{var i;r.activePage=s;const a=(i=Be("selectedSorting"))==null?void 0:i[s.id];r.sortDescriptor=a||s.sortDescriptor})},setEntriesBeingDragged:s=>{e(r=>{r.entriesBeingDragged=s})},setActiveActionDialog:(s,r=Yr)=>{e(a=>{const i=n().activeActionDialog;((i==null?void 0:i.name)!==s||i.entries!==r)&&(a.activeActionDialog=s?{name:s,entries:r}:null)})},setViewMode:s=>{e(r=>{r.viewMode=s,rt("drive.viewMode",s)})},setSidebarExpandedKeys:s=>e(r=>{r.sidebarExpandedKeys=s}),expandSidebarItem:s=>e(r=>{r.sidebarExpandedKeys.includes(s)||r.sidebarExpandedKeys.push(s)}),collapseSidebarItem:s=>e(r=>{const a=r.sidebarExpandedKeys.indexOf(s);a>-1&&r.sidebarExpandedKeys.splice(a,1)}),toggleSidebarItem:s=>e(r=>{r.sidebarExpandedKeys.includes(s)?r.expandSidebarItem(s):r.collapseSidebarItem(s)}),selectEntries:(s,r)=>{e(a=>{r||a.selectedEntries.clear(),s.forEach(i=>i&&a.selectedEntries.add(i))})},deselectEntries:s=>{e(r=>{!r.selectedEntries.size||(s==="all"?r.selectedEntries=new Set:s.forEach(a=>r.selectedEntries.delete(a)))})},reset:()=>{e(Qt)}})));function v(){return k.getState()}function Gr(){const e=k(n=>n.activeActionDialog);return e==null?void 0:e.entries[0]}function Zr(e){return e?P.post(`file-entries/${e}/shareable-link`).then(n=>n.data):Promise.reject(new Error("Invalid entry id"))}function Ln(){return M(({entryId:e})=>Zr(e),{onSuccess:(e,{entryId:n})=>{A.setQueryData(_.fetchEntryShareableLink(n),e)},onError:e=>z(e,f("Could not create link"))})}function Xr({entryIds:e}){return P.post("file-entries/star",{entryIds:e}).then(n=>n.data)}function Jr(){return M(e=>Xr(e),{onSuccess:(e,{entryIds:n})=>{U(),F(f("Starred [one 1 item|other :count items]",{values:{count:n.length}}))},onError:e=>z(e,f("Could not star items"))})}function ea({entryIds:e}){return P.post("file-entries/unstar",{entryIds:e}).then(n=>n.data)}function ta(){return M(e=>ea(e),{onSuccess:(e,{entryIds:n})=>{U(),F(f("Removed star from [one 1 item|other :count items]",{values:{count:n.length}}))},onError:e=>z(e,f("Could not remove star"))})}function na(e){return P.post("file-entries/duplicate",e).then(n=>n.data)}function sa(){return M(e=>(F.loading(f("Duplicating [one 1 item|other :count items]...",{values:{count:e.entryIds.length}}),{disableExitAnimation:!0}),na(e)),{onSuccess:(e,n)=>{U(),A.invalidateQueries(_.fetchStorageSummary),F(f("Duplicated [one 1 item|other :count items]",{values:{count:n.entryIds.length}}),{disableEnterAnimation:!0})},onError:e=>z(e,f("Could not duplicate items"),null,{disableEnterAnimation:!0})})}const ra=""+new URL("add-files.107c40dd.svg",import.meta.url).href,aa=""+new URL("time-management.5219b76e.svg",import.meta.url).href,jt=""+new URL("file-searching.49556098.svg",import.meta.url).href,ia=""+new URL("throw-away.389510cc.svg",import.meta.url).href,oa=""+new URL("loving-it.585c130e.svg",import.meta.url).href,Rn=""+new URL("share.70babf29.svg",import.meta.url).href,Me={orderBy:"updated_at",orderDir:"desc"};function St(e){return{...Tn(e.hash),canUpload:e.permissions["files.create"]||e.permissions["files.update"],label:e.name,folder:e}}function Tn(e){return{id:e,label:"",path:tt(e),hasActions:!0,canUpload:!1,sortDescriptor:Me,isFolderPage:!0,noContentMessage:()=>({title:f("Drop files or folders here"),description:f('Or use the "Upload" button'),image:ra})}}function tt(e){return e==="0"?"/drive":`/drive/folders/${e}`}const la=rn().rootFolder,$=St(la),ca={id:"recent",label:f("Recent"),path:"/drive/recent",disableSort:!0,sortDescriptor:{orderBy:"created_at",orderDir:"desc"},queryParams:{recentOnly:!0},noContentMessage:()=>({title:f("No recent entries"),description:f("You have not uploaded any files or folders yet"),image:aa})},H={id:"search",label:f("Search results"),path:"/drive/search",sortDescriptor:Me,noContentMessage:e=>e?{title:f("No matching results"),description:f("Try changing your search query or filters"),image:jt}:{title:f("Begin typing or select a filter to search"),description:f("Search for files, folders and other content"),image:jt}},be={id:"shares",label:f("Shared"),path:"/drive/shares",sortDescriptor:Me,queryParams:{sharedOnly:!0},noContentMessage:()=>({title:f("Shared with me"),description:f("Files and folders other people have shared with you"),image:Rn})},R={id:"trash",label:f("Trash"),path:"/drive/trash",sortDescriptor:Me,hasActions:!0,queryParams:{deletedOnly:!0},noContentMessage:()=>({title:f("Trash is empty"),description:f("There are no files or folders in your trash currently"),image:ia})},da={id:"starred",label:f("Starred"),path:"/drive/starred",sortDescriptor:Me,queryParams:{starredOnly:!0},noContentMessage:()=>({title:f("Nothing is starred"),description:f("Add stars to files and folders that you want to easily find later"),image:oa})},ua=[$,ca,H,be,R,da];function ma(e){return P.post("file-entries/delete",e).then(n=>n.data)}function Ae(){return M(e=>(F.loading(e.emptyTrash?f("Emptying trash..."):f("Moving to trash..."),{disableExitAnimation:!0}),ma(e)),{onSuccess:(e,{entryIds:n,emptyTrash:s,deleteForever:r})=>{U(),A.invalidateQueries(_.fetchStorageSummary),s?F(f("Emptied trash"),{disableEnterAnimation:!0}):r?F(f("Permanently deleted [one 1 item|other :count items]",{values:{count:n.length}}),{disableEnterAnimation:!0}):F(f("Moved [one 1 item|other :count items] to trash",{values:{count:n.length}}),{disableEnterAnimation:!0})},onError:(e,{emptyTrash:n})=>{const s=Ms(e);s?F.danger(s,{disableEnterAnimation:!0}):n?F.danger("could not empty trash",{disableEnterAnimation:!0}):F.danger("Could not delete items",{disableEnterAnimation:!0})}})}function _n(){return M(e=>pa(e),{onSuccess:()=>U()})}function pa({entryIds:e,...n}){return P.post(`file-entries/${e.join(",")}/unshare`,n).then(s=>s.data)}function zn(){return M(e=>fa(e),{onSuccess:(e,n)=>{U(),F(f("Restored [one 1 item|other :count items]",{values:{count:n.entryIds.length}}))},onError:e=>z(e,f("Could not restore items"))})}function fa(e){return P.post("file-entries/restore",e).then(n=>n.data)}function $n(e){const n=On(e),s=kt(e),r=ha(e),a=ga(e),i=va(e),o=ba(e),l=ya(e),c=xa(e),u=wa(e),g=Bn(e),p=Un(e),b=Sa(e);return[n,s,r,a,i,o,l,c,u,g,p,b].filter(y=>!!y)}function On(e){if(!!e.some(n=>n.type!=="folder"))return{label:f("Preview"),icon:br,key:"preview",execute:()=>{v().setActiveActionDialog("preview",e)}}}function kt(e){const n=k(s=>s.activePage);if(!(e.length>1||!e.every(s=>s.permissions["files.update"])||n===R))return{label:f("Share"),icon:Dn,key:"share",execute:()=>{v().setActiveActionDialog("share",e)}}}function ha(e){const n=k(r=>r.activePage),s=Ln();if(!(e.length>1||!e.every(r=>r.permissions["files.update"])||n===R))return{label:f("Get link"),icon:nr,key:"getLink",execute:()=>{s.mutate({entryId:e[0].id}),v().setActiveActionDialog("getLink",e)}}}function ga(e){const n=k(r=>r.activePage),s=Jr();if(!(e.every(r=>{var a;return(a=r.tags)==null?void 0:a.find(i=>i.name==="starred")})||!e.every(r=>r.permissions["files.update"])||n===R))return{label:f("Add to starred"),icon:yr,key:"addToStarred",execute:()=>{s.mutate({entryIds:e.map(r=>r.id)}),v().selectEntries([])}}}function va(e){const n=k(r=>r.activePage),s=ta();if(!(!e.every(r=>{var a;return(a=r.tags)==null?void 0:a.find(i=>i.name==="starred")})||n===R))return{label:f("Remove from starred"),icon:xr,key:"removeFromStarred",execute:()=>{s.mutate({entryIds:e.map(r=>r.id)}),v().selectEntries([])}}}function ba(e){const n=k(s=>s.activePage);if(!(!e.every(s=>s.permissions["files.update"])||n===be||n===R))return{label:f("Move to"),icon:wr,key:"moveTo",execute:()=>{v().setActiveActionDialog("moveTo",e)}}}function ya(e){const n=k(s=>s.activePage);if(!(e.length>1||!e.every(s=>s.permissions["files.update"])||n===R))return{label:f("Rename"),icon:Sr,key:"rename",execute:()=>{v().setActiveActionDialog("rename",e)}}}function xa(e){const n=k(r=>r.activePage),s=sa();if(!(e.length>1||!e.every(r=>r.permissions["files.update"])||n===R))return{label:f("Make a copy"),icon:kr,key:"makeCopy",execute:()=>{s.mutate({entryIds:e.map(r=>r.id)}),v().selectEntries([])}}}function wa(e){const{downloadUrl:n}=hn(e[0],{downloadHashes:e.map(s=>s.hash)});if(!!e.every(s=>s.permissions["files.download"]))return{label:f("Download"),icon:Qe,key:"download",execute:()=>{n&&Ke(n),v().selectEntries([])}}}function Bn(e){const n=Ae(),s=k(r=>r.activePage);if(!(s===be||!e.every(r=>r.permissions["files.delete"])))return{label:s===R?f("Delete forever"):f("Remove"),icon:pt,key:"delete",execute:()=>{s===R?v().setActiveActionDialog("confirmAndDeleteForever",e):(n.mutate({entryIds:e.map(r=>r.id),deleteForever:s===R}),v().selectEntries([]))}}}function Sa(e){const n=zn();if(!(k(r=>r.activePage)!==R||!e.every(r=>r.permissions["files.delete"])))return{label:f("Restore"),icon:Ir,key:"restore",execute:()=>{n.mutate({entryIds:e.map(r=>r.id)}),v().selectEntries([])}}}function Un(e){const n=_n();if(k(r=>r.activePage)===be)return{label:f("Remove"),icon:pt,key:"removeSharedEntry",execute:()=>{n.mutate({entryIds:e.map(r=>r.id),userId:"me"},{onSuccess:(r,a)=>{F(f("Removed [one 1 item|other {count} items]",{values:{count:a.entryIds.length}}))},onError:r=>z(r,f("Could not remove items"))}),v().selectEntries([])}}}function Wn(){return ce(_.fetchStorageSummary,ka,{select:Ia})}function ka(){return P.get("user/space-usage").then(e=>e.data)}function Ia(e){const n=e.available===null?0:e.used*100/e.available;return{usedFormatted:ge(e.used),availableFormatted:ge(e.available),percentage:n,used:e.used,available:e.available}}const Ea=8388608;function Le(){var g;const e=Z(p=>p.uploadMultiple),n=k(p=>p.activePage),{data:s}=Wn(),{workspaceId:r}=j(),a=((g=n==null?void 0:n.folder)==null?void 0:g.id)||null,{uploads:i}=Ye(),o=i.max_size||Ea,l=i.allowed_extensions,c=i.blocked_extensions;return{uploadFiles:h.exports.useCallback((p,b={})=>{if(b.metadata||(b.metadata={}),b.metadata.workspaceId=r,b.metadata.parentId||(b.metadata.parentId=a),p=[...p].map(y=>y instanceof _t?y:new _t(y)),s){const y=p.reduce((w,I)=>w+I.size,0),S=s.used,x=s.available;if(y+S>x){F.danger(f("You have exhausted your allowed space of :space. Delete some files or upgrade your plan.",{values:{space:s.availableFormatted}}),{action:{action:"/pricing",label:f("Upgrade")}});return}}e(p,{...b,restrictions:{maxFileSize:o,allowedFileTypes:l,blockedFileTypes:c},onSuccess:(y,S)=>{var x;(x=b==null?void 0:b.onSuccess)==null||x.call(b,y,S),U(),A.invalidateQueries(_.fetchStorageSummary)}}),v().setUploadQueueIsOpen(!0)},[e,a,r,l,c,o,s])}}function Vn(e){const n=Da(e),s=Pa(e),r=Na(e),a=Ca();return[n,s,r,a].filter(i=>!!i)}function Da(e){if(!(!e.folder||!e.folder.permissions["files.update"]))return{label:f("New folder"),icon:yt,key:"newFolder",execute:()=>{e.folder&&v().setActiveActionDialog("newFolder",[e.folder])}}}function Pa(e){const{uploadFiles:n}=Le();if(!(!e.folder||!e.folder.permissions["files.update"]))return{label:f("Upload files"),icon:Pn,key:"uploadFiles",execute:async()=>{n(await Ue({multiple:!0}))}}}function Na(e){const{uploadFiles:n}=Le();if(!(!e.folder||!e.folder.permissions["files.update"]))return{label:f("Upload folder"),icon:Nn,key:"uploadFolder",execute:async()=>{n(await Ue({directory:!0}))}}}function Ca(e){const n=Ae();if(k(r=>r.activePage)===R)return{label:f("Empty trash"),icon:Er,key:"emptyTrash",execute:()=>{n.mutate({entryIds:[],emptyTrash:!0}),v().selectEntries([])}}}function nt({children:e,entries:n,page:s}){return(s==null?void 0:s.id)===$.id?t(Ht,{page:$,children:e}):s===R?t(Ht,{page:R,children:e}):s!=null&&s.folder?t(qt,{entries:[s.folder],children:e}):n!=null&&n.length?t(qt,{entries:n,children:e}):null}function qt({entries:e,children:n}){const s=$n(e);return t(Kn,{actions:s,children:n})}function Ht({page:e,children:n}){const s=Vn(e);return t(Kn,{actions:s,children:n})}function Kn({actions:e,children:n}){return m(oe,{children:[n,t(le,{children:e.map(s=>t(T,{onSelected:()=>{s.execute()},value:s.key,startIcon:h.exports.createElement(s.icon),children:t(d,{...s.label})},s.key))})]})}const Qn=As(e=>ge(e)),It=[{key:"name",allowsSorting:!0,header:()=>t(d,{message:"Name"}),visibleInMode:"all",width:"flex-3 min-w-200",body:e=>t(Fa,{entry:e})},{key:"updated_at",allowsSorting:!0,maxWidth:"max-w-184",header:()=>t(d,{message:"Last modified"}),body:e=>t(We,{date:e.updated_at})},{key:"file_size",allowsSorting:!0,header:()=>t(d,{message:"Size"}),maxWidth:"max-w-144",body:e=>{var n;return(n=Qn(e.file_size))!=null?n:"-"}},{key:"actions",hideHeader:!0,header:()=>t(d,{message:"Actions"}),align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:e=>t(Ma,{entry:e})}];function Fa({entry:e}){const{isCollapsedMode:n}=h.exports.useContext(ft),s=n?"w-30 h-30":"w-24 h-24";return m("div",{className:"flex items-center gap-14",children:[t(mt,{className:N("rounded",s),iconClassName:s,file:e}),m("div",{className:"min-w-0",children:[t("div",{className:"overflow-hidden overflow-ellipsis",children:e.name}),n&&m("div",{className:"text-muted text-xs flex items-center mt-4",children:[t(We,{date:e.updated_at}),t("div",{children:"\xB7"}),t("div",{children:Qn(e.file_size)})]})]})]})}function Ma({entry:e}){const{selectedRows:n}=h.exports.useContext(ft);return n.length?t(an,{className:"block mr-8",checked:n.includes(e.id)}):t(nt,{entries:[e],children:t(L,{className:"text-muted",children:t(ht,{})})})}const Aa=It.filter(e=>e.key!=="updated_at");function La({entries:e,onEntrySelected:n}){const s=V(a=>a.activeSort),r=Ie();return t(gn,{columns:r?Aa:It,data:e,sortDescriptor:s,onSortChange:a=>{fe().setActiveSort(a)},onAction:(a,i)=>{n(a,i)},enableSelection:!1})}function Ra(e,n){var r;let s=e.hash;return n&&((r=e.entry)==null?void 0:r.hash)!==n&&(s=`${s}:${n}`),s}function jn(){const{link:e}=se(),n=Ls();return s=>{!e||n(`/drive/s/${Ra(e,s)}`)}}function Ta({className:e}){const{pathname:n}=on(),s=jn(),[r,a]=h.exports.useState(),i=V(x=>x.viewMode),o=h.exports.useRef(null),{link:l,entries:c,isFetchingNextPage:u,hasNextPage:g,fetchNextPage:p,isPreviousData:b}=se();if(h.exports.useEffect(()=>{a(void 0)},[n]),h.exports.useEffect(()=>{const x=o.current;if(!x)return;const w=new IntersectionObserver(([I])=>{I.isIntersecting&&g&&p()});return w.observe(x),()=>{w.unobserve(x)}},[g,p]),!l||b)return t("div",{className:N("flex justify-center",e),children:t(ve,{isIndeterminate:!0})});const y=(x,w)=>{x.type==="folder"?s(x.hash):a(w)},S=c||[];return m(h.exports.Fragment,{children:[t(ot,{slot:"file-preview",className:"mb-40"}),m("div",{className:N("px-14 pb-14 md:px-24 md:pb-24 flex-auto overflow-auto file-grid-container",e),children:[i==="grid"?t(Hr,{entries:S,onEntrySelected:y}):t(La,{entries:S,onEntrySelected:y}),t("span",{ref:o,"aria-hidden":!0}),t(q,{children:u&&t(B.div,{className:"flex justify-center mt-24 w-full",...lt,children:t(ve,{isIndeterminate:!0,"aria-label":"loading"})})})]}),t(de,{type:"modal",isOpen:r!=null,onClose:()=>a(void 0),children:t(vn,{entries:S,defaultActiveIndex:r,allowDownload:l.allow_download})})]})}function qn({children:e,className:n}){return t("div",{className:N(n,"dashboard-grid-header"),children:e})}function Hn({hash:e,params:n,isEnabled:s=!0}){return ce(_.fetchFolderPath(e,n),()=>_a(e,n),{enabled:!!e&&s})}function _a(e,n){return P.get(`folders/${e}/path`,{params:n}).then(s=>s.data)}function za({className:e,folder:n,link:s}){const r=jn(),a=V(l=>l.password),i=Hn({hash:n==null?void 0:n.hash,params:{shareable_link:s.id,password:a}});let o;if(i.isLoading)o=null;else{const l=[];i.data&&i.data.path.forEach(c=>{l.push({folder:c,label:t(ct,{children:c.name})})}),o=t(wt,{size:"lg",isNavigation:!0,children:l.map(c=>t(je,{onSelected:()=>{r(c.folder.hash)},children:c.label},c.folder.hash))})}return t("div",{className:N("h-36 flex-shrink-0",e),children:o})}const Yt=[{id:"file_size",label:f("Size")},{id:"name",label:f("Name")},{id:"updated_at",label:f("Last modified")},{id:"created_at",label:f("Upload date")},{id:"type",label:f("Type")},{id:"extension",label:f("Extension")}];function Yn({descriptor:e,onChange:n,isDisabled:s=!1}){const r=e.orderBy,a=e.orderDir,i=Yt.find(o=>o.id===r);return m(oe,{showCheckmark:!0,selectionMode:"multiple",selectedValue:[a||"desc",r||""],onItemSelected:o=>{n(o==="asc"||o==="desc"?{orderBy:r,orderDir:o}:{orderBy:o,orderDir:a})},children:[t(C,{className:"text-muted",variant:"text",size:"sm",startIcon:t(Dr,{}),disabled:s,children:i?t(d,{...i.label}):null}),m(le,{children:[m(zt,{label:t(d,{message:"Direction"}),children:[t(T,{value:"asc",children:t(d,{message:"Ascending"})}),t(T,{value:"desc",children:t(d,{message:"Descending"})})]}),t(zt,{label:t(d,{message:"Sort By"}),children:Yt.map(o=>t(T,{value:o.id,children:t(d,{...o.label})},o.id))})]})]})}function $a(){const e=V(a=>a.activeSort),{link:n,isFetching:s}=se(),r=n&&n.entry;return m("div",{className:"md:flex-row flex flex-col md:items-center gap-14 justify-between p-14 md:p-24 md:h-90",children:[r&&t(za,{link:n,folder:n.entry,className:"flex-auto"}),r&&m("div",{className:"flex items-center justify-between md:justify-start text-muted",children:[t(Yn,{isDisabled:s,descriptor:e,onChange:a=>{fe().setActiveSort(a)}}),t("div",{className:"md:border-l md:pl-10 ml-10",children:t(L,{onClick:()=>{fe().setViewMode(fe().viewMode==="grid"?"list":"grid")},children:t(Pr,{})})})]})]})}function Oa(){const{entries:e,isFetched:n}=se(),s=n&&!(e!=null&&e.length);return m(bn,{name:"folder-preview",children:[t(yn,{hideToggleButton:!0,rightChildren:t(Fn,{}),color:"bg"}),t(qn,{children:t($a,{})}),t(ln,{children:t(xn,{children:s?t(Ba,{}):t(Ta,{})})})]})}function Ba({className:e}){return t(Ge,{className:N(e,"mt-80"),image:t(De,{src:Rn}),title:t(d,{message:"Folder is empty"}),description:t(d,{message:"No files have been uploaded to this folder yet"})})}function Ua(){const{link:e}=se();return e!=null&&e.entry?m("div",{className:"flex flex-col h-screen bg-alt",children:[t(Mn,{}),t(ot,{slot:"file-preview",className:"mt-24"}),t(sr,{entries:[e.entry],showHeader:!1,allowDownload:e.allow_download})]}):null}function Wa(){var o;const{status:e,link:n}=se(),{trans:s}=W(),r=V(l=>l.isPasswordProtected),a=V(l=>l.password);let i;if(e==="loading")i=t("div",{className:"flex-auto flex items-center justify-center h-screen",children:t(ve,{"aria-label":s({message:"Loading link"}),isIndeterminate:!0})});else{if(!n&&!r)return t(cn,{});r&&!a?i=t(jr,{}):((o=n==null?void 0:n.entry)==null?void 0:o.type)==="folder"?i=t(Oa,{}):i=t(Ua,{})}return t(wn.Provider,{value:{shareable_link:n==null?void 0:n.id,password:a},children:i})}function Va(e){return t(Rs,{...e,role:"meter progressbar"})}function Ka(){const{isLoading:e,data:n}=Wn(),s=t("span",{className:N("whitespace-nowrap",e&&"invisible"),children:t(d,{message:":used of :available used",values:{used:n==null?void 0:n.usedFormatted,available:n==null?void 0:n.availableFormatted}})});return m("div",{className:"pl-24 pt-24 mt-24 border-t flex items-start gap-16",children:[t(Nr,{className:"icon-md -mt-4"}),t(Va,{className:"flex-auto max-w-144",size:"xs",value:n==null?void 0:n.percentage,label:s,showValueLabel:!1,labelPosition:"bottom"})]})}function Qa(e){return M(n=>ja(n),{onSuccess:()=>{F(f("Created workspace")),A.invalidateQueries(Q.fetchUserWorkspaces)},onError:n=>Pe(n,e)})}function ja(e){return P.post("workspace",e).then(n=>n.data)}function qa(){const e=Ne(),{formId:n,close:s}=X(),r=Qa(e);return m(J,{children:[t(ee,{children:t(d,{message:"Create workspace"})}),t(Y,{children:t(Ce,{form:e,id:n,onSubmit:()=>{r.mutate(e.getValues(),{onSuccess:a=>{s(a.workspace.id)}})},children:t(Fe,{name:"name",autoFocus:!0,label:t(d,{message:"Workspace name"}),minLength:3,required:!0})})}),m(ye,{children:[t(C,{variant:"text",onClick:s,children:t(d,{message:"Cancel"})}),t(C,{variant:"flat",color:"primary",type:"submit",form:n,disabled:r.isLoading,children:t(d,{message:"Create"})})]})]})}function Ha(e){return P.get(`workspace/${e}`).then(n=>n.data)}function Ya(e){return ce(Q.workspaceWithMembers(e),()=>Ha(e))}function Ga({workspaceId:e,...n}){return P.post(`workspace/${e}/invite`,n).then(s=>s.data)}function Za(){return M(e=>Ga(e),{onSuccess:(e,n)=>{A.invalidateQueries(Q.workspaceWithMembers(n.workspaceId))},onError:e=>z(e)})}function Xa({workspaceId:e,inviteId:n,...s}){return P.post(`workspace/${e}/${n}/resend`,s).then(r=>r.data)}function Ja(){return M(e=>Xa(e),{onSuccess:()=>{F("Invite sent")},onError:e=>z(e)})}const ei=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function Gn(e){return!e||e.length>320?!1:ei.test(e)}function ti({workspaceId:e,member:n,...s}){const r=n.model_type,a=n.model_type==="invite"?n.id:n.member_id;return P.post(`workspace/${e}/${r}/${a}/change-role`,s).then(i=>i.data)}function ni(){return M(e=>ti(e),{onSuccess:(e,n)=>{F(f("Role changed")),A.invalidateQueries(Q.workspaceWithMembers(n.workspaceId))},onError:e=>z(e)})}function si({workspaceId:e,memberId:n,memberType:s}){const r=s==="invite"?`workspace/invite/${n}`:`workspace/${e}/member/${n}`;return P.delete(r).then(a=>a.data)}function Zn(){const{workspaceId:e,setWorkspaceId:n}=j(),{user:s}=K();return M(r=>si(r),{onSuccess:(r,a)=>{A.invalidateQueries(Q.fetchUserWorkspaces),A.invalidateQueries(Q.workspaceWithMembers(a.workspaceId)),a.memberId===(s==null?void 0:s.id)&&e===a.workspaceId&&n(dt.id)},onError:r=>z(r)})}function Xn(){return t(xe,{isDanger:!0,title:t(d,{message:"Leave workspace"}),body:m("div",{children:[t(d,{message:"Are you sure you want to leave this workspace?"}),t("div",{className:"font-semibold mt-8",children:t(d,{message:"All resources you've created in the workspace will be transferred to workspace owner."})})]}),confirm:t(d,{message:"Leave"})})}function ri({workspace:e}){const{data:n,isLoading:s}=Ya(e.id);return m(J,{size:"lg",children:[t(ee,{children:t(d,{message:"Manage workspace members"})}),t(Y,{children:s?t("div",{className:"flex items-center justify-center min-h-[238px]",children:t(ve,{isIndeterminate:!0,"aria-label":"Loading workspace..."})}):t(ai,{workspace:n.workspace})})]})}function ai({workspace:e}){const n=Et(e),s=[...e.members||[],...e.invites||[]];return m("div",{children:[n.invite&&t(li,{workspace:e}),m("div",{className:"flex items-center gap-10 mb-14 text-base",children:[t(Cr,{className:"icon-sm"}),t(d,{message:"Members of `:workspace`",values:{workspace:e.name}})]}),t(q,{initial:!1,children:s.map(r=>t(ii,{workspace:e,member:r},`${r.model_type}.${r.id}`))})]})}function ii({workspace:e,member:n}){return m(B.div,{initial:{x:"-100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"tween",duration:.125},className:"flex items-start text-sm gap-14 mb-20",children:[t("img",{className:"w-36 h-36 rounded flex-shrink-0",src:n.avatar,alt:""}),m("div",{className:"md:flex flex-auto items-center justify-between gap-14 min-w-0",children:[m("div",{className:"overflow-hidden mb-10 md:mb-0 md:mr-10",children:[m("div",{className:"flex items-center justify-start gap-6",children:[t("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:n.display_name}),t(ui,{workspace:e,member:n})]}),t("div",{className:"text-muted",children:n.email})]}),t(oi,{workspace:e,member:n})]})]},`${n.model_type}.${n.id}`)}function Et(e){var i;const{user:n}=K(),s={update:!1,invite:!1,delete:!1},r=["update","invite","delete"],a=(i=e.members)==null?void 0:i.find(o=>o.id===(n==null?void 0:n.id));return a&&r.forEach(o=>{var l;s[o]=a.is_owner||!!((l=a.permissions)!=null&&l.find(c=>c.name===`workspace_members.${o}`))}),s}function oi({workspace:e,member:n}){const[s,r]=h.exports.useState(n.role_id),a=ni(),{user:i}=K(),o=Et(e),l=n.model_type==="member"&&n.is_owner,c=n.model_type==="member"&&(i==null?void 0:i.id)===n.id,u=!o.update||l||c?t("div",{className:"text-muted ml-auto first:capitalize",children:t(d,{message:n.role_name})}):t(Jn,{className:"ml-auto flex-shrink-0",size:"xs",value:s,isDisabled:a.isLoading,onChange:g=>{r(g),a.mutate({roleId:g,workspaceId:e.id,member:n})}});return m(ct,{children:[u,!l&&(c||o.delete)&&t(ci,{type:c?"leave":"remove",member:n,workspace:e})]})}function li({workspace:e}){const{trans:n}=W(),[s,r]=h.exports.useState([]),a=s.every(g=>!g.invalid),i=g=>g.description||g.name,[o,l]=h.exports.useState(),c=Za(),{data:u}=dn(["workspaceRoles"]);return h.exports.useEffect(()=>{var g;!o&&((g=u==null?void 0:u.workspaceRoles)==null?void 0:g.length)&&l(u.workspaceRoles[0].id)},[u,o]),m("div",{className:"mb-30",children:[t(gt,{value:s,onChange:r,displayWith:i,validateWith:g=>{const p=!Gn(g.description);return{...g,invalid:p,errorMessage:p?n({message:"Not a valid email"}):void 0}},placeholder:n({message:"Enter email addresses"}),label:t(d,{message:"Invite people"})}),m("div",{className:"flex items-center gap-14 justify-between mt-14",children:[t(Jn,{onChange:l,value:o}),s.length&&o?t(C,{variant:"flat",color:"primary",size:"sm",disabled:c.isLoading||!a,onClick:()=>{c.mutate({emails:s.map(g=>i(g)),roleId:o,workspaceId:e.id},{onSuccess:()=>{r([])}})},children:t(d,{message:"Invite"})}):null]})]})}function ci({member:e,workspace:n,type:s}){const r=Zn(),{close:a}=X();return m(de,{type:"modal",onClose:i=>{i&&(r.mutate({workspaceId:n.id,memberId:e.id,memberType:e.model_type}),s==="leave"&&(a(),F(f("Left workspace"))))},children:[t(L,{size:"md",className:"text-muted flex-shrink-0",disabled:r.isLoading,children:s==="leave"?t(un,{}):t(we,{})}),s==="leave"?t(Xn,{}):t(di,{member:e})]})}function di({member:e}){return t(xe,{isDanger:!0,title:t(d,{message:"Remove member"}),body:m("div",{children:[t(d,{message:"Are you sure you want to remove `:name`?",values:{name:e.display_name}}),t("div",{className:"font-semibold mt-8",children:t(d,{message:"All workspace resources created by `:name` will be transferred to workspace owner.",values:{name:e.display_name}})})]}),confirm:t(d,{message:"Remove"})})}function Jn({value:e,onChange:n,size:s="xs",className:r,isDisabled:a}){var l;const{data:i}=dn(["workspaceRoles"]),o=(l=i==null?void 0:i.workspaceRoles)==null?void 0:l.find(c=>c.id===e);return!e||!o||!(i!=null&&i.workspaceRoles)?null:m(oe,{selectionMode:"single",selectedValue:e,onSelectionChange:c=>{n(c)},children:[t(C,{className:r,size:s,variant:"flat",color:"chip",disabled:a,endIcon:t(ut,{}),children:t(d,{message:o.name})}),t(le,{children:i.workspaceRoles.map(c=>t(T,{value:c.id,description:c.description,children:t(d,{message:c.name})},c.id))})]})}function ui({member:e,workspace:n}){const{user:s}=K(),r=Et(n);return(s==null?void 0:s.id)===e.id?m("div",{className:"font-medium",children:["(",t(d,{message:"You"}),")"]}):e.model_type==="invite"?m("div",{className:"flex items-center gap-4",children:[t("div",{children:"\xB7"}),t("div",{className:"font-medium",children:t(d,{message:"Invited"})}),r.invite?m(ct,{children:[t("div",{children:"\xB7"}),t(mi,{member:e,workspace:n})]}):null]}):null}function mi({member:e,workspace:n}){const s=Ja();return m(de,{type:"modal",onClose:r=>{r&&s.mutate({workspaceId:n.id,inviteId:e.id})},children:[t(C,{variant:"link",size:"sm",color:"primary",disabled:s.isLoading,children:t(d,{message:"Resend invite"})}),t(xe,{title:t(d,{message:"Resend invite"}),body:t(d,{message:"Are you sure you want to send this invite again?"}),confirm:t(d,{message:"Send"})})]})}function pi({id:e,...n}){return P.put(`workspace/${e}`,n).then(s=>s.data)}function fi(e){const{close:n}=X();return M(s=>pi(s),{onSuccess:s=>{n(),F(f("Updated workspace")),A.invalidateQueries(Q.fetchUserWorkspaces),A.invalidateQueries(Q.workspaceWithMembers(s.workspace.id))},onError:s=>Pe(s,e)})}function hi({workspace:e}){const n=Ne({defaultValues:{id:e.id,name:e.name}}),{formId:s,close:r}=X(),a=fi(n);return m(J,{children:[t(ee,{children:t(d,{message:"Rename workspace"})}),t(Y,{children:t(Ce,{form:n,id:s,onSubmit:()=>{a.mutate(n.getValues())},children:t(Fe,{name:"name",autoFocus:!0,label:t(d,{message:"Name"}),minLength:3,required:!0})})}),m(ye,{children:[t(C,{variant:"text",onClick:r,children:t(d,{message:"Cancel"})}),t(C,{variant:"flat",color:"primary",type:"submit",form:s,disabled:a.isLoading,children:t(d,{message:"Rename"})})]})]})}function gi({id:e}){return P.delete(`workspace/${e}`).then(n=>n.data)}function vi(){const{workspaceId:e,setWorkspaceId:n}=j();return M(s=>gi(s),{onSuccess:(s,r)=>{F(f("Deleted workspace")),A.invalidateQueries(Q.fetchUserWorkspaces),A.invalidateQueries(Q.workspaceWithMembers(r.id)),e===r.id&&n(dt.id)},onError:s=>z(s)})}function bi({onChange:e,className:n,trigger:s}){const{data:r,isFetched:a,isFetching:i}=Ts(),{workspaceId:o,setWorkspaceId:l}=j(),c=r==null?void 0:r.find(w=>w.id===o),[u,g]=h.exports.useState(null),[p,b]=h.exports.useState(!1),{hasPermission:y}=K();if(h.exports.useEffect(()=>{a&&!i&&!c&&l(dt.id)},[c,r,l,a,i]),!c||!y("workspaces.create"))return null;const S=m(mn,{className:N("flex items-center gap-10 hover:bg-hover rounded ring-inset focus-visible:ring-2",n),children:[m("span",{className:"block flex-auto mr-auto text-left overflow-hidden",children:[t("span",{className:"block text-sm text-main font-medium overflow-hidden overflow-ellipsis",children:c.default?t(d,{message:c.name}):c.name}),t("span",{className:"block text-muted text-xs",children:c.default?t(d,{message:"Personal workspace"}):t(d,{message:":count members",values:{count:c.members_count}})})]}),t(rr,{className:"icon-md shrink-0"})]}),x=s||S;return m(h.exports.Fragment,{children:[m(de,{type:"popover",isOpen:p,onClose:()=>{b(!1)},children:[h.exports.cloneElement(x,{onClick:()=>b(!p)}),t(J,{size:"min-w-320",children:m(Y,{padding:"p-10",children:[t("div",{className:"mb-16 pb-10 border-b",children:r.map(w=>t(yi,{workspace:w,setDialog:g,setSelectorIsOpen:b,onChange:e},w.id))}),t("div",{className:"text-center mb-4 px-4",children:t(C,{onClick:w=>{w.preventDefault(),w.stopPropagation(),g({name:"newWorkspace"}),b(!1)},variant:"outline",startIcon:t(Sn,{}),color:"primary",className:"w-full h-40",children:t(d,{message:"Create new workspace"})})})]})})]}),t(xi,{dialog:u,setDialog:g,onChange:e})]})}function yi({workspace:e,onChange:n,setSelectorIsOpen:s,setDialog:r}){const{workspaceId:a,setWorkspaceId:i}=j(),o=a===e.id;return m("div",{onClick:()=>{i(e.id),n==null||n(e.id),s(!1)},className:N("p-10 mb-4 text-left flex items-center gap-12 rounded-lg cursor-pointer",o&&"bg-primary/5",!o&&"hover:bg-hover"),children:[t(_s,{size:"sm",className:N("flex-shrink-0 text-primary",!o&&"invisible")}),m("div",{className:"flex-auto",children:[t("div",{className:N("text-sm",o&&"font-semibold"),children:e.name}),t("div",{className:"text-muted text-sm",children:e.default?t(d,{message:"Personal workspace"}):t(d,{message:":count members",values:{count:e.members_count}})})]}),e.id!==0&&t(Si,{setSelectorIsOpen:s,workspace:e,setDialog:r})]})}function xi({dialog:e,setDialog:n,onChange:s}){const r=vi(),a=Zn(),{user:i}=K(),{setWorkspaceId:o}=j();return m(de,{type:"modal",isOpen:!!(e!=null&&e.name),onClose:l=>{(e==null?void 0:e.name)==="deleteWorkspace"&&l&&r.mutate({id:e.workspace.id}),(e==null?void 0:e.name)==="leaveWorkspace"&&l&&(i==null?void 0:i.id)&&a.mutate({workspaceId:e.workspace.id,memberId:i.id,memberType:"member"}),(e==null?void 0:e.name)==="newWorkspace"&&l&&(o(l),s==null||s(l)),n(null)},children:[(e==null?void 0:e.name)==="newWorkspace"&&t(qa,{}),(e==null?void 0:e.name)==="updateWorkspace"&&t(hi,{workspace:e.workspace}),(e==null?void 0:e.name)==="workspaceMembers"&&t(ri,{workspace:e.workspace}),(e==null?void 0:e.name)==="deleteWorkspace"&&t(wi,{workspace:e.workspace}),(e==null?void 0:e.name)==="leaveWorkspace"&&t(Xn,{})]})}function wi({workspace:e}){return t(xe,{isDanger:!0,title:t(d,{message:"Delete workspace"}),body:t(d,{message:"Are you sure you want to delete \u201C:name\u201C?",values:{name:e.name}}),confirm:t(d,{message:"Delete"})})}function Si({setSelectorIsOpen:e,setDialog:n,workspace:s}){const{user:r}=K();return m(oe,{onItemSelected:a=>{e(!1),n({name:a,workspace:s})},children:[t(C,{onClick:a=>{a.preventDefault(),a.stopPropagation()},color:"primary",size:"xs",variant:"outline",endIcon:t(sn,{}),children:t(d,{message:"Manage"})}),m(le,{children:[t(T,{onClick:a=>a.stopPropagation(),value:"workspaceMembers",startIcon:t(Dn,{}),children:t(d,{message:"Members"})}),s.owner_id===(r==null?void 0:r.id)&&t(T,{onClick:a=>a.stopPropagation(),value:"updateWorkspace",startIcon:t(zr,{}),children:t(d,{message:"Rename"})}),s.owner_id!==(r==null?void 0:r.id)&&t(T,{onClick:a=>a.stopPropagation(),value:"leaveWorkspace",startIcon:t(un,{}),children:t(d,{message:"Leave"})}),s.owner_id===(r==null?void 0:r.id)&&t(T,{onClick:a=>a.stopPropagation(),value:"deleteWorkspace",startIcon:t(pt,{}),children:t(d,{message:"Delete"})})]})]})}var es=(e=>(e.DriveSidebar="drive-sidebar",e))(es||{}),ts={};(function(e){var n=$t&&$t.__assign||function(){return(n=Object.assign||function(o){for(var l,c=1,u=arguments.length;c<u;c++)for(var g in l=arguments[c])Object.prototype.hasOwnProperty.call(l,g)&&(o[g]=l[g]);return o}).apply(this,arguments)},s=(Object.defineProperty(e,"__esModule",{value:!0}),{id:"id",parentId:"parentId",dataField:"data",childrenField:"children",throwIfOrphans:!1,rootParentIds:{"":!(e.countNodes=e.arrayToTree=void 0)},nestedIds:!0,assign:!1});function r(o,l){l===void 0&&(l={});for(var c,u=n(n({},s),l),g=[],p={},b=u.throwIfOrphans?new Set:null,y=0,S=o;y<S.length;y++){var x=S[y],w=u.nestedIds?i(x,u.id):x[u.id],I=u.nestedIds?i(x,u.parentId):x[u.parentId];if(u.rootParentIds[w])throw new Error("The item array contains a node whose parentId both exists in another node and is in "+'`rootParentIds` (`itemId`: "'.concat(w,'", `rootParentIds`: ').concat(Object.keys(u.rootParentIds).map(function(O){return'"'.concat(O,'"')}).join(", "),")."));Object.prototype.hasOwnProperty.call(p,w)||(p[w]=((c={})[u.childrenField]=[],c)),b&&b.delete(w),u.dataField?p[w][u.dataField]=x:u.assign?p[w]=Object.assign(x,((c={})[u.childrenField]=p[w][u.childrenField],c)):p[w]=n(n({},x),((x={})[u.childrenField]=p[w][u.childrenField],x)),x=p[w],I==null||u.rootParentIds[I]?g.push(x):(Object.prototype.hasOwnProperty.call(p,I)||(p[I]=((w={})[u.childrenField]=[],w),b&&b.add(I)),p[I][u.childrenField].push(x))}if(b!=null&&b.size)throw new Error("The items array contains orphans that point to the following parentIds: "+"[".concat(Array.from(b),"]. These parentIds do not exist in the items array. Hint: prevent orphans to result ")+"in an error by passing the following option: { throwIfOrphans: false }");if(u.throwIfOrphans&&a(g,u.childrenField)<Object.keys(p).length)throw new Error("The items array contains nodes with a circular parent/child relationship.");return g}function a(o,l){return o.reduce(function(c,u){return c+1+(u[l]&&a(u[l],l))},0)}function i(o,l){return l.split(".").reduce(function(c,u){return c&&c[u]},o)}e.arrayToTree=r,e.countNodes=a})(ts);function ki(e){return P.get(`users/${e.userId}/folders`,{params:e}).then(n=>n.data)}function Dt(){const{user:e}=K(),{workspaceId:n}=j(),s={userId:e.id,workspaceId:n};return ce(_.fetchUserFolders(s),()=>ki(s),{enabled:!!e})}function ns(){return M(e=>(F.loading(f("Moving [one 1 item|other :count items]...",{values:{count:e.entryIds.length}}),{disableExitAnimation:!0}),Ii(e)),{onSuccess:(e,n)=>{U(),F(f('Moved [one 1 item|other :count items] to ":destination"',{values:{count:n.entryIds.length,destination:(e.destination||$.folder).name}}),{disableEnterAnimation:!0})},onError:e=>z(e,f("Could not move items"),null,{disableEnterAnimation:!0})})}function Ii(e){return e.destinationId=e.destinationId?e.destinationId:null,P.post("file-entries/move",e).then(n=>n.data)}function Pt(e,n){return n.type!=="folder"?!1:e.every(s=>!s||n.id===s.parent_id||!s.parent_id&&n.id===0?!1:!Ei(n,s))}function Ei(e,n){const s=(e.path||"").split("/");return(n.path||"").split("/").every((a,i)=>s[i]===a)}function ss(e){const n=ns(),{uploadFiles:s}=Le();return{onDrop:async a=>{if(e.type==="folder"){if(a.type==="nativeFile")s(await a.getData(),{metadata:{parentId:e.id}});else if(a.type==="fileEntry"){const i=a.getData();(i==null?void 0:i.length)&&Pt(i,e)&&(n.mutate({destinationId:e.id,entryIds:i.map(o=>o.id)}),v().deselectEntries("all"))}}}}}function at(e,n){if(e.type==="fileEntry"){const s=e.getData();return Pt(s,n)}return!0}function Nt(e){return`${e.id}-tree`}function Di(e){return`${e}`.endsWith("-tree")}function Pi({folder:e,ref:n}){const[s,r]=h.exports.useState(!1),{onDrop:a}=ss(e);return{...et({id:Nt(e),ref:n,types:["fileEntry","nativeFile"],acceptsDrop:o=>at(o,e),onDragEnter:o=>{at(o,e)&&r(!0)},onDragLeave:()=>{r(!1)},onDropActivate:()=>{v().sidebarExpandedKeys.includes(e.id)||v().setSidebarExpandedKeys([...v().sidebarExpandedKeys,e.id])},onDrop:a}),isDragOver:s}}const Ct=h.exports.createContext(null);function rs({nodes:e,itemRenderer:n,parentNode:s,level:r}){return e.map((a,i)=>h.exports.cloneElement(n(a),{level:r==null?0:r+1,index:i,node:a,parentNode:s,key:a.id,itemRenderer:n}))}const as=h.exports.forwardRef(({icon:e,label:n,level:s=0,node:r,className:a,...i},o)=>{const{expandedKeys:l,setExpandedKeys:c,selectedKeys:u,setSelectedKeys:g}=h.exports.useContext(Ct),p=l.includes(r.id),b=u.includes(r.id),y=S=>{S.stopPropagation();const x=l.indexOf(r.id),w=[...l];x>-1?w.splice(x,1):w.push(r.id),c(w)};return m("div",{...i,ref:o,onClick:S=>{S.stopPropagation(),g([r.id])},className:N("flex flex-nowrap whitespace-nowrap items-center gap-4 py-6 rounded header cursor-pointer overflow-hidden text-ellipsis tree-label",a,b&&"bg-primary/selected text-primary font-bold",!b&&"hover:bg-hover"),children:[s>0&&t("div",{className:"flex",children:Array.from({length:s}).map((S,x)=>t("div",{className:"w-24 h-24"},x))}),t("div",{onClick:y,children:t(Fr,{className:N("icon-sm cursor-default transition-transform",p&&"rotate-90")})}),e,t("div",{className:"overflow-hidden text-ellipsis pr-6",children:n})]})});as.displayName="TreeLabel";function Ni({label:e,icon:n,node:s,level:r,index:a,itemRenderer:i,labelRef:o,labelClassName:l,className:c,parentNode:u,...g}){const p=zs(),{expandedKeys:b,selectedKeys:y,focusedNode:S,setFocusedNode:x,setExpandedKeys:w,setSelectedKeys:I}=h.exports.useContext(Ct);if(h.exports.useEffect(()=>()=>{S===(s==null?void 0:s.id)&&x(void 0)},[S,s==null?void 0:s.id,x]),!s||!i)return null;const O=s.children.length,E=O&&b.includes(s.id),ue=y.includes(s.id),Re=r===0&&a===0,Te=S==null?Re:S===s.id;return m("li",{role:"treeitem","aria-expanded":E?"true":"false","aria-selected":ue,tabIndex:Te?0:-1,onKeyDown:Ve(D=>{var Se,Rt;if(S!=null)switch(D.key){case"Enter":case" ":D.stopPropagation(),D.preventDefault(),I([S]);break;case"ArrowRight":if(D.stopPropagation(),D.preventDefault(),!O)return;E?p.focusNext():w([...b,S]);break;case"ArrowLeft":if(D.stopPropagation(),D.preventDefault(),E){const G=b.indexOf(S),me=[...b];me.splice(G,1),w(me)}else if(u){const G=(Rt=(Se=document.activeElement)==null?void 0:Se.parentElement)==null?void 0:Rt.closest("[tabindex]");G&&G.focus()}break;case"ArrowDown":D.stopPropagation(),D.preventDefault(),p.focusNext();break;case"ArrowUp":D.stopPropagation(),D.preventDefault(),p.focusPrevious();break;case"Home":D.stopPropagation(),D.preventDefault(),p.focusFirst();break;case"End":D.stopPropagation(),D.preventDefault(),p.focusLast();break;case"*":if(D.stopPropagation(),D.preventDefault(),u!=null&&u.children){const G=[...b];u.children.forEach(me=>{me.children.length&&!b.includes(me.id)&&G.push(me.id)}),G.length!==b.length&&w(G)}break}}),onFocus:D=>{D.stopPropagation(),x(s.id)},onBlur:D=>{D.stopPropagation(),D.currentTarget.contains(D.relatedTarget)||x(void 0)},className:N("outline-none","[&>.tree-label]:focus-visible:ring [&>.tree-label]:focus-visible:ring-2 [&>.tree-label]:focus-visible:ring-inset",c),children:[t(as,{ref:o,className:l,node:s,level:r,label:e,icon:n,...g}),t(q,{initial:!1,children:E?t(B.ul,{role:"group",initial:"closed",animate:"open",exit:"closed",variants:{open:{opacity:1,height:"auto"},closed:{opacity:0,height:0,overflow:"hidden"}},children:rs({nodes:s.children,parentNode:s,itemRenderer:i,level:r})},`${s.id}-group`):null})]})}function Ci({children:e,nodes:n,...s}){const[r,a]=Ot(s.expandedKeys,s.defaultSelectedKeys,s.onExpandedKeysChange),[i,o]=Ot(s.selectedKeys,s.defaultSelectedKeys,s.onSelectedKeysChange),[l,c]=h.exports.useState(),u={expandedKeys:r,setExpandedKeys:a,selectedKeys:i,setSelectedKeys:o,focusedNode:l,setFocusedNode:c};return t(Ct.Provider,{value:u,children:t($s,{children:t(Fi,{nodes:n,itemRenderer:e})})})}function Fi(e){return t("ul",{className:"overflow-hidden text-sm",role:"tree",children:rs(e)})}function Mi(){const e=te(),{data:n}=Dt(),s=k(o=>o.sidebarExpandedKeys),r=k(o=>o.activePage);let a=[];r!=null&&r.isFolderPage&&(a=r.folder?[r.folder.id]:[]);const i=h.exports.useMemo(()=>{const o=ts.arrayToTree((n==null?void 0:n.folders)||[],{parentId:"parent_id",dataField:null});return[{...$.folder,children:o}]},[n==null?void 0:n.folders]);return t(Ci,{nodes:i,expandedKeys:s,onExpandedKeysChange:o=>{v().setSidebarExpandedKeys(o)},selectedKeys:a,onSelectedKeysChange:([o])=>{const l=is(o,i);e(l?tt(l):$.path)},children:()=>t(Ai,{})})}function Ai(e){const{node:n}=e,s=h.exports.useRef(null),r=n.id===0,a=k(c=>c.entriesBeingDragged.includes(n.id)),{draggableProps:i}=kn({type:"fileEntry",id:Nt(n),ref:s,disabled:r,hidePreview:!0,onDragStart:(c,u)=>{const g=u;v().setEntriesBeingDragged(g.getData().map(p=>p.id)),v().selectEntries([])},onDragEnd:()=>{v().setEntriesBeingDragged([])},getData:()=>[n]}),{droppableProps:o,isDragOver:l}=Pi({folder:n,ref:s});return t(Ni,{...Ze(i,o,e),onContextMenu:c=>{c.preventDefault(),c.stopPropagation(),v().deselectEntries("all"),v().setContextMenuData({x:c.clientX,y:c.clientY,entry:n})},labelRef:s,className:r?"focus-visible:ring-2":void 0,labelClassName:N(l&&"bg-primary/selected ring ring-2 ring-inset ring-primary",a&&"opacity-30",r&&"h-40"),icon:r?t(Mr,{size:"md",className:"mr-6"}):t(xt,{size:"sm",className:"mr-4"}),label:n.name})}const is=(e,n)=>{for(const s of n){if(s.id===e)return s.hash;if(s.children){const r=is(e,s.children);if(r)return r}}};function Li(){return j(),m("div",{className:"text-muted mt-26 px-12",children:[t(Mi,{}),t(Bs,{menu:es.DriveSidebar,orientation:"vertical",gap:"gap-0",children:e=>e.action==="/drive/trash"?t(Ri,{item:e},e.id):t(os,{item:e},e.id)})]})}const os=h.exports.forwardRef(({item:e,className:n,...s},r)=>t(Os,{className:({isActive:a})=>N(n,"h-40 w-full my-4 px-24 rounded",a?"text-primary font-bold bg-primary/selected cursor-default":"hover:bg-hover"),item:e,ref:r,...s}));function Ri({item:e}){const n=Ae(),[s,r]=h.exports.useState(!1),a=h.exports.useRef(null),{droppableProps:i}=et({id:"trash",types:["fileEntry"],ref:a,onDragEnter:()=>{r(!0)},onDragLeave:()=>{r(!1)},onDrop:o=>{const l=o.getData().map(c=>c.id);n.mutate({entryIds:l,deleteForever:!1})}});return t(os,{className:N(s&&"bg-primary/selected"),ref:a,...i,item:e})}function ls({isCompact:e,className:n}){const s=k(i=>i.activePage),{uploadFiles:r}=Le(),a=e?t(L,{size:"md",children:t(Sn,{})}):t(C,{className:"min-w-160",color:"primary",variant:"flat",size:"sm",startIcon:t(Pn,{}),disabled:!(s!=null&&s.canUpload),children:t(d,{message:"Upload"})});return t("div",{className:n,children:m(oe,{onItemSelected:async i=>{var o;if(i==="uploadFiles")r(await Ue({multiple:!0}));else if(i==="uploadFolder")r(await Ue({directory:!0}));else if(i==="newFolder"){const l=(o=v().activePage)==null?void 0:o.folder;v().setActiveActionDialog("newFolder",l?[l]:[])}},children:[a,m(le,{children:[t(T,{value:"uploadFiles",startIcon:t(Ar,{}),children:t(d,{message:"Upload files"})}),t(T,{value:"uploadFolder",startIcon:t(Nn,{}),children:t(d,{message:"Upload folder"})}),t(T,{value:"newFolder",startIcon:t(yt,{}),children:t(d,{message:"Create folder"})})]})]})})}function Ti({className:e}){const{isSubscribed:n}=K(),{billing:s}=Ye();return m("div",{className:N(e,"text-sm text-muted font-medium bg-alt border-r flex flex-col gap-20"),children:[m("div",{className:"flex-auto",children:[t(ls,{className:"text-center px-12 pt-28"}),t(Li,{}),t(Ka,{}),s.enable&&t("div",{className:"pl-60 mt-14",children:t(C,{elementType:pn,to:n?"/billing/change-plan":"/pricing",variant:"outline",color:"primary",size:"xs",children:t(d,{message:"Upgrade"})})})]}),t(_i,{})]})}function _i(){const e=te();return t(bi,{onChange:()=>{e($.path)},className:"w-full px-24 py-18 border-t flex-shrink-0 mt-auto"})}function zi(e){return P.get("drive/file-entries",{params:e}).then(n=>n.data)}const $i=e=>{var a;const s=e.pages[0].folder,r=v().activePage;return s&&r&&r.id===s.hash&&(!r.folder||!Us(s.permissions,(a=r.folder)==null?void 0:a.permissions))&&v().setActivePage(St(s)),e};function cs(){const e=k(l=>l.activePage),n=k(l=>l.sortDescriptor),[s]=Xe(),{workspaceId:r}=j(),a={pageId:e==null?void 0:e.id,...e==null?void 0:e.queryParams,...Object.fromEntries(s),folderId:e!=null&&e.isFolderPage?e.id:null,workspaceId:r,...n},i=e===H&&!a.query&&!a.filters,o=Cn(_.fetchEntries(a),({pageParam:l=1})=>zi({...a,page:l}),{getNextPageParam:l=>{const c=l.current_page,u=l.last_page;if(!(c>=u))return c+1},enabled:e!=null&&!i});return h.exports.useEffect(()=>{var l;(l=o.data)!=null&&l.pages[0].folder&&$i(o.data)},[o.data]),o}function Oi(){return A.getQueriesData(_.fetchEntries()).reduce((n,s)=>{const r=s[1]?s[1].pages.flatMap(a=>a.data):[];return[...n,...r]},[])}const ds=[ar,{key:"owner_id",label:f("Owner"),description:f("User file was uploaded by"),defaultOperator:_e.eq,control:{type:ze.Select,defaultValue:"02",options:[{key:"01",label:f("anyone"),value:{value:null,operator:"!="}},{key:"02",label:f("me"),value:"{authId}"},{key:"03",label:f("not me"),value:{value:"{authId}",operator:"!="}}]}},ir({description:f("Date file was uploaded")}),or({description:f("Date file was last changed")}),{key:"deleted_at",label:f("In trash"),description:f("Only show files that are in the trash"),defaultOperator:_e.ne,control:{type:ze.BooleanToggle,defaultValue:null}},{key:"shareableLink",label:f("Has shareable link"),description:f("Only show files that have a shareable link"),defaultOperator:_e.has,control:{type:ze.BooleanToggle,defaultValue:"*"}},{control:{type:ze.BooleanToggle,defaultValue:!0},key:"sharedByMe",label:f("Shared by me"),description:f("Only show files that are shared with someone"),defaultOperator:_e.eq}],Bi=ds.map(e=>e.key);function Ui(){const e=k(l=>l.activePage),{isMobileMode:n}=h.exports.useContext(ne),{trans:s}=W(),r=te(),[a]=Xe(),[i,o]=h.exports.useState(a.get("query")||"");return e!==H?null:m("div",{className:"mt-10 mb-30 px-10 md:px-26",children:[n&&t("form",{className:"contents",onSubmit:l=>{var c;l.preventDefault(),((c=document.activeElement)==null?void 0:c.tagName)==="INPUT"&&document.activeElement.blur(),r({pathname:H.path,search:`?query=${i}`},{replace:!0})},children:t(He,{autoFocus:!0,className:"mb-20",startAdornment:t(L,{type:"submit",radius:"rounded",children:t(Je,{})}),placeholder:s(f("Type to search")),value:i,onChange:l=>o(l.target.value)})}),t(lr,{filters:ds,pinnedFilters:Bi})]})}function Wi(e,n){const s={...e};s.left=Math.max(0,s.left);const r=s.left-e.left;r>0&&(s.width-=r),s.top=Math.max(0,s.top);const a=s.top-e.top;return a>0&&(s.height-=a),s.width=Math.min(s.width,n.width-s.left),s.height=Math.min(s.height,n.height-s.top),s}const ke=new Map;function Vi(e){const{id:n,ref:s}=e,r=h.exports.useRef(e);r.current=e,h.exports.useLayoutEffect(()=>{if(!!s.current)return ke.set(n,{...ke.get(n),id:n,ref:s,onSelected:()=>{var a,i;(i=(a=r.current).onSelected)==null||i.call(a)},onDeselected:()=>{var a,i;return(i=(a=r.current).onDeselected)==null?void 0:i.call(a)}}),()=>{In.delete(n)}},[n,r,s])}function Ki(e,n){return!e||!n?!1:e.left<=n.left+n.width&&e.left+e.width>=n.left&&e.top<=n.top+n.height&&e.top+e.height>=n.top}function Qi({onPointerDown:e,...n}={}){const s=h.exports.useRef(null),r=n.containerRef||s,a=h.exports.useRef(null);let i=h.exports.useRef({}).current;const o=()=>{var I,O,E,ue,Re,Te,st;if(i.rafId&&cancelAnimationFrame(i.rafId),!i.startPoint||!i.endPoint||!i.boundaryRect)return;const c=i.startPoint,u=i.endPoint,g=c.scrollTop||0,p=((I=r.current)==null?void 0:I.scrollTop)||0,b={left:Math.min(c.x,u.x),top:Math.min(c.y,u.y),width:Math.abs(c.x-u.x),height:Math.abs(c.y-u.y)};b.left-=i.boundaryRect.left,b.top-=i.boundaryRect.top,b.top+=g;const y=p-g,S=Math.abs(y);y<0&&(b.top-=S),b.height+=S;const x=i.boundaryRect?Wi(b,i.boundaryRect):{...b};a.current&&(i.rafId=requestAnimationFrame(()=>{a.current&&(a.current.style.display="block",a.current.style.transform=`translate(${x.left}px, ${x.top}px)`,a.current.style.width=`${x.width}px`,a.current.style.height=`${x.height}px`),i.rafId=void 0}));const w={...x,left:x.left+i.boundaryRect.left,top:x.top+i.boundaryRect.top-p};for(const[,D]of ke){const Se=Ki(D.rect,w);Se&&!((O=i.selectedIds)!=null&&O.has(D.id))?((E=i.selectedIds)==null||E.add(D.id),(ue=D.onSelected)==null||ue.call(D)):!Se&&((Re=i.selectedIds)==null?void 0:Re.has(D.id))&&((Te=i.selectedIds)==null||Te.delete(D.id),(st=D.onDeselected)==null||st.call(D))}};return{containerProps:{...En({minimumMovement:4,onPointerDown:e,onMoveStart:c=>{if(cr)return!1;Bt(ke),i={selectedIds:new Set};const u=r.current;if(i.startPoint={x:c.clientX,y:c.clientY,scrollTop:(u==null?void 0:u.scrollTop)||0},i.scrollListener=g=>{var p;!i.startPoint||(Bt(ke),(p=i.boundaryRect)!=null&&p.height&&(i.boundaryRect.height=g.target.scrollHeight),o())},u){const g=u.getBoundingClientRect();u.addEventListener("scroll",i.scrollListener),i.boundaryRect={top:g.top,left:g.left,height:u.scrollHeight,heightWithoutScroll:g.height,width:u.scrollWidth}}},onMove:c=>{if(i.endPoint={x:c.clientX,y:c.clientY},i.boundaryRect&&r.current){const u=c.clientY+20>i.boundaryRect.heightWithoutScroll+i.boundaryRect.top,g=c.clientY-20<i.boundaryRect.top;u?r.current.scrollBy({top:10}):g&&r.current.scrollBy({top:-10})}o()},onMoveEnd:()=>{i.rafId&&cancelAnimationFrame(i.rafId),r.current&&i.scrollListener&&r.current.removeEventListener("scroll",i.scrollListener),a.current&&(a.current.style.display="none",a.current.style.transform="",a.current.style.width="",a.current.style.height=""),i={}}}).domProps,ref:r},boxProps:{ref:a}}}function Ft(){const e=cs();return e.data?e.data.pages.flatMap(n=>n.data):[]}function Mt(){const e=k(s=>s.selectedEntries),n=Ft();return Array.from(e).map(s=>n.find(r=>r.id===s)).filter(s=>!!s)}function us(){return Mt()[0]}function ji(){const e=us(),{data:n}=Dt();if(!(!e||!n))return n.folders.find(s=>s.id===e.parent_id)}function At(){const e=Array.from(v().selectedEntries),n=Oi();return e.map(s=>n.find(r=>r.id===s)).filter(s=>!!s)}function ms({className:e}){const n=Mt();return n.length?t("div",{className:e,children:t(qi,{entries:n})}):null}function qi({entries:e}){const n=On(e),s=kt(e),r=Bn(e),a=Un(e),i=[n,s,r,a].filter(o=>!!o);return m("div",{className:"entry-action-list",children:[i.map(o=>t(ie,{label:t(d,{...o.label}),children:t(L,{size:"sm",onClick:()=>{o.execute()},children:h.exports.createElement(o.icon)})},o.key)),t(nt,{entries:e,children:t(ie,{label:t(d,{message:"More actions"}),children:t(L,{children:t(ht,{})})})})]})}function Hi(){var a;const e=Mt(),n=k(i=>i.activePage),s=k(i=>i.contextMenuData),r=s!=null&&s.entry?[s.entry]:e;return((a=s==null?void 0:s.entry)==null?void 0:a.id)===0?t(Gt,{position:s,page:$}):s&&r.length?t(Yi,{entries:r,position:s}):s&&n?t(Gt,{position:s,page:n}):null}function Yi({entries:e,position:n}){const s=$n(e);return t(ps,{position:n,actions:s})}function Gt({page:e,position:n}){const s=Vn(e);return t(ps,{position:n,actions:s})}function ps({position:e,actions:n}){return t(Ws,{position:e,onOpenChange:s=>{s||v().setContextMenuData(null)},children:n.map(s=>t(T,{value:s.key,onSelected:s.execute,startIcon:h.exports.createElement(s.icon),children:t(d,{...s.label})},s.key))})}function Gi(){return Vs("((pointer: coarse))")}function fs(e){const n=Gi(),s=h.exports.useRef(null),{onDrop:r}=ss(e),[a,i]=h.exports.useState(!1),o=k(p=>p.entriesBeingDragged.includes(e.id)),l=k(p=>p.activePage),{draggableProps:c}=kn({disabled:!!n||l===R,id:e.id,type:"fileEntry",ref:s,hidePreview:!0,onDragStart:(p,b)=>{v().selectedEntries.has(e.id)||v().selectEntries([e.id]),v().setEntriesBeingDragged(b.getData().map(y=>y.id))},onDragEnd:()=>{v().setEntriesBeingDragged([])},getData:()=>At()}),{droppableProps:u}=et({id:e.id,disabled:n||e.type!=="folder",ref:s,types:["fileEntry","nativeFile"],acceptsDrop:p=>at(p,e),onDragEnter:()=>i(!0),onDragLeave:()=>i(!1),onDrop:r});Vi({id:e.id,ref:s,onSelected:()=>{v().selectEntries([e.id],!0)},onDeselected:()=>{v().deselectEntries([e.id])}});const g=N(o&&"opacity-20",a&&"ring ring-offset-4 ring-primary bg-primary-light/10 rounded");return{draggableProps:c,droppableProps:u,isDragOver:a,isDragging:o,itemClassName:g,ref:s}}function Zi({item:e,children:n,className:s,...r}){const{isCollapsedMode:a}=h.exports.useContext(ft),{draggableProps:i,droppableProps:o,itemClassName:l,ref:c}=fs(e);return t("div",{className:N(s,l),ref:c,...Ze(i,o,r,{onContextMenu:u=>{u.preventDefault(),u.stopPropagation(),a||(v().selectedEntries.has(e.id)||v().selectEntries([e.id]),v().setContextMenuData({x:u.clientX,y:u.clientY}))}}),children:n})}function hs(){const e=te();return{performViewItemAction:h.exports.useCallback(s=>{if(s&&s.type==="folder")v().activePage===R?v().setActiveActionDialog("trashFolderBlock",[s]):e(tt(s.hash));else{const r=At();v().setActiveActionDialog("preview",r.length?r:[s])}},[e])}}function Xi({entries:e}){const{performViewItemAction:n}=hs(),s=k(i=>i.selectedEntries),r=k(i=>i.sortDescriptor),a=h.exports.useMemo(()=>[...s],[s]);return t(gn,{columns:It,data:e,sortDescriptor:r,onSortChange:i=>{v().setSortDescriptor(i)},onAction:n,selectedRows:a,selectionStyle:"highlight",renderRowAs:Zi,onSelectionChange:i=>{v().selectEntries(i)}})}function Ji({entry:e}){const n=k(y=>y.selectedEntries.has(e.id)),{performViewItemAction:s}=hs(),{isMobileMode:r}=h.exports.useContext(ne),{draggableProps:a,droppableProps:i,itemClassName:o,ref:l}=fs(e),c=()=>{n?v().deselectEntries([e.id]):v().selectEntries([e.id],!0)},u=(y,S)=>{r?v().selectedEntries.size?c():s(e):dr(y)?c():v().selectEntries([e.id])},{domProps:g}=En({onLongPress:r?()=>c():void 0,onPress:u}),p=y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),y.stopPropagation(),s(e))},b=y=>{y.preventDefault(),y.stopPropagation(),r||(v().selectedEntries.has(e.id)||v().selectEntries([e.id]),v().setContextMenuData({x:y.clientX,y:y.clientY}))};return t(An,{...Ze(a,i,g,{onKeyDown:Ve(p)}),ref:l,entry:e,isSelected:n,isMobileMode:!!r,tabIndex:-1,onDoubleClick:y=>{y.preventDefault(),y.stopPropagation(),r||s(e)},footerAdornment:r&&t(eo,{entry:e,isSelected:n}),onContextMenu:Ve(b),className:o})}function eo({entry:e,isSelected:n}){return k(r=>r.selectedEntries.size)?t(an,{className:"block mr-8",checked:n}):t(nt,{entries:[e],children:t(L,{className:"text-muted",onPointerDown:r=>{r.stopPropagation()},children:t(ht,{})})})}function to({entries:e}){return t("div",{className:"file-grid-container",children:t("div",{className:"file-grid",children:e.map(n=>t(Ji,{entry:n},n.id))})})}function gs({isDisabled:e}){const n=k(s=>s.sortDescriptor);return t(Yn,{isDisabled:e,descriptor:n,onChange:s=>{v().setSortDescriptor(s)}})}function vs({className:e}){const{isMobileMode:n}=h.exports.useContext(ne),s=te(),r=k(g=>g.activePage),a=r==null?void 0:r.folder,i=Hn({hash:a==null?void 0:a.hash,isEnabled:(a==null?void 0:a.hash)!==$.folder.hash}),o=fn(),l=no(),c=!r||!o||r.isFolderPage&&!a||i.fetchStatus!=="idle";let u;if(c)u=null;else{const g=l?[l]:[];i.data&&i.data.path.forEach(p=>{g.push({page:St(p),label:p.name})}),u=t(wt,{className:e,size:n?"md":"lg",currentIsClickable:!0,children:g.map((p,b)=>b===g.length-1?t(je,{children:({isMenuItem:S})=>S||!p.page.folder&&p.page!==R?t(Oe,{value:p.label}):t(nt,{page:p.page,children:m(mn,{className:"flex items-center gap-2 rounded focus-visible:ring-offset-4",children:[t(Oe,{value:p.label}),t(ut,{className:"icon-md text-muted"})]})})},p.page.id):t(je,{onSelected:()=>{s(p.page.path)},children:t(Oe,{value:p.label})},p.page.id))})}return u}function no(){var r,a;const e=k(i=>i.activePage),n=fn(),{user:s}=K();if(!e)return null;if(n&&!n.default&&(e==null?void 0:e.isFolderPage)&&((e==null?void 0:e.id)===$.id||((r=e.folder)==null?void 0:r.workspace_id)===n.id))return{label:n.name,page:$};if(e!=null&&e.isFolderPage){const i=(a=e.folder)==null?void 0:a.users.find(o=>o.owns_entry);return(i==null?void 0:i.id)!==(s==null?void 0:s.id)?{label:be.label,page:be}:{label:$.label,page:$}}return{label:e.label,page:e}}function so({query:{isInitialLoading:e,fetchNextPage:n,isFetchingNextPage:s,hasNextPage:r},children:a,loaderMarginTop:i="mt-24",style:o,className:l,variant:c="infiniteScroll",loadMoreExtraContent:u,size:g="md"}){const p=h.exports.useRef(null),b=s||e,[y,S]=h.exports.useState(0),x=c==="loadMore"&&y<3?"loadMore":"infiniteScroll";h.exports.useEffect(()=>{const I=p.current;if(!I||x==="loadMore")return;const O=new IntersectionObserver(([E])=>{E.isIntersecting&&r&&!b&&n()});return O.observe(I),()=>{O.unobserve(I)}},[n,r,b,x]);let w;return a?w=s?a:null:x==="loadMore"?w=!e&&r&&m("div",{className:N("flex items-center gap-8",i),children:[u,t(C,{size:g==="md"?"sm":"xs",className:N(g==="sm"?"min-h-24 min-w-96":"min-h-36 min-w-112"),variant:"outline",color:"primary",onClick:()=>{n(),S(y+1)},disabled:b,children:y>=2&&!s?t(d,{message:"Load all"}):t(d,{message:"Show more"})})]}):w=t(q,{children:s&&t(B.div,{className:N("flex justify-center w-full",i),...lt,children:t(ve,{size:g,isIndeterminate:!0,"aria-label":"loading"})})}),m("div",{style:o,className:N("w-full",l,r&&"min-h-36"),role:"presentation",children:[t("div",{ref:p,"aria-hidden":!0}),w]})}function ro({isVisible:e}){const n=t(B.div,{...lt,transition:{duration:.3},className:"absolute inset-0 w-full min-h-full bg-primary-light/30 border-2 border-dashed border-primary pointer-events-none",children:t(B.div,{initial:{y:"100%",opacity:0},animate:{y:"-10px",opacity:1},exit:{y:"100%",opacity:0},className:"p-10 bg-primary text-on-primary fixed bottom-0 left-0 right-0 max-w-max mx-auto rounded",children:t(d,{message:"Drop files to upload them to this folder."})})},"dragTargetMask");return t(q,{children:e?n:null})}function ao({className:e}){const[n]=Xe(),s=!!n.get("query")||!!n.get("filters"),r=h.exports.useRef(null),a=cs(),i=Ft(),{uploadFiles:o}=Le(),l=Ae(),c=k(E=>E.activePage),[u,g]=h.exports.useState(!1),p=k(E=>E.viewMode),{isMobileMode:b}=h.exports.useContext(ne),{containerProps:y,boxProps:S}=Qi({containerRef:r,onPointerDown:E=>{E.target.closest(".entry-action-list")||v().deselectEntries("all")}}),{droppableProps:x}=et({id:"driveRoot",ref:r,types:["nativeFile"],disabled:!(c!=null&&c.canUpload),onDragEnter:()=>{g(!0)},onDragLeave:()=>{g(!1)},onDrop:async E=>{E.type==="nativeFile"&&o(await E.getData())}});if(!c)return null;let w;if(!i.length&&(!a.isLoading||a.fetchStatus==="idle")){const E=c.noContentMessage(s);w=t(Ge,{className:"mt-40",image:t(De,{src:E.image}),title:t(d,{...E.title}),description:t(d,{...E.description})})}else a.isLoading||(w=p==="list"?t(Xi,{entries:i}):t(to,{entries:i}));const I=E=>{E.preventDefault(),E.stopPropagation(),v().deselectEntries("all"),v().setContextMenuData({x:E.clientX,y:E.clientY})},O=E=>{E.key==="a"&&ur(E)&&(E.preventDefault(),E.stopPropagation(),v().selectEntries(i.map(ue=>ue.id))),E.key==="Delete"&&(E.preventDefault(),E.stopPropagation(),v().selectedEntries.size&&!l.isLoading&&(c===R?v().setActiveActionDialog("confirmAndDeleteForever",At()):(l.mutate({entryIds:[...v().selectedEntries],deleteForever:c===R}),v().selectEntries([]))))};return t("div",{className:N("relative outline-none",e),tabIndex:-1,...Ze(y,x,{onKeyDown:Ve(O)}),onContextMenu:I,children:m("div",{className:"flex flex-col relative pt-10 min-h-full",children:[b?t(vs,{className:"px-14 mb-10"}):t(io,{}),t(Ui,{}),m("div",{className:"px-18 md:px-24 pb-18 flex-auto relative",children:[t(ot,{slot:"drive",className:"mb-24"}),w,t(so,{query:a})]}),t("div",{...S,className:"absolute bg-primary-light/20 border border-primary-light z-10 pointer-events-none shadow-md left-0 top-0 hidden"}),t(Hi,{}),t(ro,{isVisible:u})]})})}function io(){const e=k(n=>n.activePage);return m("div",{className:"px-10 md:px-18 my-10 flex items-center gap-40 justify-between text-muted min-h-42",children:[t(gs,{isDisabled:e==null?void 0:e.disableSort}),t(ms,{className:"text-muted"})]})}const oo=h.exports.memo(({file:e,style:n})=>m("div",{className:"p-10 flex items-center gap-14 w-full absolute top-0 left-0",style:n,children:[t("div",{className:"shrink-0 border rounded p-8",children:t(Ee,{className:"w-22 h-22",mime:e.mime})}),m("div",{className:"flex-auto min-w-0 pr-10",children:[t("div",{className:"mb-2 flex items-center min-w-0 gap-10",children:t("div",{className:"flex-auto font-medium whitespace-nowrap min-w-0 overflow-hidden overflow-ellipsis",children:e.name})}),t(lo,{file:e})]}),t("div",{className:"mr-10",children:t(co,{file:e})})]}));function lo({file:e}){const n=Z(o=>o.fileUploads.get(e.id)),s=(n==null?void 0:n.bytesUploaded)||0,r=h.exports.useMemo(()=>ge(e.size),[e]),a=h.exports.useMemo(()=>ge(s),[s]);let i;return(n==null?void 0:n.status)==="completed"?i=t(d,{message:"Upload complete"}):(n==null?void 0:n.status)==="aborted"?i=t(d,{message:"Upload cancelled"}):(n==null?void 0:n.status)==="failed"?i=t(d,{message:"Upload failed"}):i=t(d,{message:":bytesUploaded of :totalBytes",values:{bytesUploaded:a,totalBytes:r}}),t("div",{className:"text-muted text-xs",children:i})}function co({file:e}){const n=Z(p=>p.fileUploads.get(e.id)),s=Z(p=>p.abortUpload),r=(n==null?void 0:n.percentage)||0,a=n==null?void 0:n.status,i=n==null?void 0:n.errorMessage,[o,l]=h.exports.useState(!1),c=t(L,{size:"sm",onClick:()=>{s(e.id)},children:t(we,{})}),u=t(ve,{"aria-label":"Upload progress",size:"sm",value:r});let g;if(a==="failed"){const p=i||f("This file could not be uploaded");g=t($e,{children:t(ie,{variant:"danger",label:t(Oe,{value:p}),children:t(Ks,{className:"text-danger",size:"md"})})})}else a==="aborted"?g=t($e,{children:t(Qs,{className:"text-warning",size:"md"})}):a==="completed"?g=t($e,{children:t(js,{size:"md",className:"text-positive"})}):g=t($e,{onPointerEnter:p=>{p.pointerType==="mouse"&&l(!0)},onPointerLeave:p=>{p.pointerType==="mouse"&&l(!1)},children:o?c:u});return t(q,{children:g})}function $e({children:e,...n}){return t(B.div,{...n,initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},children:e})}function uo(){const e=k(n=>n.uploadQueueIsOpen);return t(q,{children:e&&m(B.div,{className:"shadow-xl rounded fixed bottom-16 right-16 bg z-modal border w-375 text-sm",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},children:[t(mo,{}),t(po,{})]},"upload-queue")})}function mo(){const e=Z(a=>a.activeUploadsCount),n=Z(a=>a.completedUploadsCount),s=Z(a=>a.clearInactive);let r;return e?r=t(d,{message:"Uploading :count files",values:{count:e}}):n?r=t(d,{message:"Uploaded :count files",values:{count:n}}):r=t(d,{message:"No active uploads"}),m("div",{className:"px-10 py-4 bg-alt flex items-center gap-10 justify-between border-b min-h-[45px]",children:[r,e===0?t(L,{size:"sm",onClick:()=>{v().setUploadQueueIsOpen(!1),setTimeout(()=>{s()},200)},children:t(we,{})}):void 0]})}function po(){const e=Z(a=>a.fileUploads),n=[...e.values()],s=h.exports.useRef(null),r=mr({count:e.size,getScrollElement:()=>s.current,estimateSize:()=>60,overscan:4});return t("div",{className:"max-h-320 overflow-y-auto",ref:s,children:t("div",{className:"relative w-full",style:{height:`${r.getTotalSize()}px`},children:r.getVirtualItems().map(a=>{const i=n[a.index];return t(oo,{style:{height:`${a.size}px`,transform:`translateY(${a.start}px)`},file:i.file},i.file.id)})})})}const fo=""+new URL("detailed-examination.33c85772.svg",import.meta.url).href;function bs({entryType:e,entryName:n}){const{setRightSidenavStatus:s}=h.exports.useContext(ne);return m("div",{className:"flex items-center gap-16 text-text-main mb-38",children:[t(Ee,{className:"w-24 h-24",type:e}),t("div",{className:"text-xl font-normal text-ellipsis flex-auto mr-auto min-w-0 break-words",children:n}),t(L,{size:"md",className:"flex-shrink-0",onClick:()=>{s("closed")},children:t(we,{})})]})}function Lt({children:e,margin:n="mb-20"}){return t("div",{className:N("text-base text-main",n),children:e})}function ho(){return M(e=>go(e),{onSuccess:()=>{U()},onError:e=>z(e,f("Failed to save tags."))})}function go({entry:e,tags:n}){return P.post(`file-entries/${e.id}/sync-tags`,{tags:n.map(s=>s.name)}).then(s=>s.data)}function vo(e){return ce(["file-entry-tags",e],()=>bo(e),{keepPreviousData:!0})}async function bo(e){return P.get("file-entry-tags",{params:{query:e}}).then(n=>n.data)}function yo({entry:e}){return m("div",{className:"mt-20 border-t pt-20",children:[t(Lt,{margin:"mb-10",children:t(d,{message:"Tags"})}),t(xo,{entry:e},e.id)]})}function xo({entry:e}){const{trans:n}=W(),s=te(),r=ho(),[a,i]=h.exports.useState(""),[o,l]=h.exports.useState(e.tags||[]),{data:c,isLoading:u}=vo(a),g=p=>{l(p),r.isLoading||r.mutate({tags:p,entry:e})};return t(gt,{isAsync:!0,inputValue:a,onInputValueChange:i,suggestions:c==null?void 0:c.results,placeholder:n(f("+Add tag")),isLoading:u,chipSize:"sm",value:o,onChange:g,onChipClick:p=>{s(`/drive/search?query=${p.name}`)},children:c==null?void 0:c.results.map(p=>t(T,{value:p,children:p.name},p.id))})}function wo({entry:e}){return m("div",{children:[t(bs,{entryType:e.type,entryName:e.name}),e.type==="image"&&t(mt,{className:"mb-20",file:e}),m("div",{children:[t(Lt,{children:t(d,{message:"Who has access"})}),m("div",{className:"flex items-center gap-14",children:[e.workspace_id?t("div",{className:"rounded-full border w-32 h-32 flex items-center justify-center",children:t(Lr,{className:"icon-md"})}):null,e.users.map(n=>t(ie,{label:n.display_name,children:t(vt,{src:n.avatar,size:"md",circle:!0})},n.id))]}),e.permissions["files.update"]&&t(C,{className:"block mt-20",variant:"link",color:"primary",onClick:()=>{v().setActiveActionDialog("share",[e])},children:t(d,{message:"Manage Access"})})]}),t(So,{entry:e}),t(yo,{entry:e})]})}function So({entry:e}){const n=ji(),s=te(),r=e.users.find(i=>i.owns_entry),a=h.exports.useMemo(()=>ge(e.file_size),[e.file_size]);return m("div",{className:"mt-20 border-t pt-20",children:[t(Lt,{children:t(d,{message:"Properties"})}),t(pe,{label:t(d,{message:"Type"}),value:t("span",{className:"capitalize",children:t(d,{message:e.type})})}),t(pe,{label:t(d,{message:"Size"}),value:e.file_size?a:"-"}),t(pe,{label:t(d,{message:"Location"}),value:t(C,{variant:"link",startIcon:t(xt,{}),onClick:()=>{s(n?tt(n.hash):$.path)},children:n?n.name:t(d,{message:"Root"})})}),r&&t(pe,{label:t(d,{message:"Owner"}),value:r.display_name}),t(pe,{label:t(d,{message:"Modified"}),value:t(We,{date:e.updated_at})}),t(pe,{label:t(d,{message:"Created"}),value:t(We,{date:e.updated_at})})]})}function pe({label:e,value:n}){return m("div",{className:"flex items-center mb-14",children:[t("div",{className:"w-1/3 text-xs text-muted",children:e}),t("div",{className:"w-2/3 text-sm text-main",children:n})]})}function ko({className:e}){const n=us();return t("div",{className:N(e,"bg p-18 text-sm text-muted border-l h-full overflow-y-auto"),children:n?t(wo,{entry:n}):t(Io,{})})}function Io(){return m(h.exports.Fragment,{children:[t(bs,{entryType:"folder",entryName:t(d,{message:"All files"})}),t(Ge,{image:t(De,{src:fo}),description:t(d,{message:"Select file or folder to see details here"})})]})}function Eo(e){return M(n=>Do(n),{onSuccess:(n,s)=>{U(),F(f(":oldName renamed to :newName",{values:{oldName:s.initialName,newName:n.fileEntry.name}}))},onError:n=>Pe(n,e)})}function Do({entryId:e,...n}){return P.put(`file-entries/${e}`,n).then(s=>s.data)}function Po({entries:e}){var l;const{close:n,formId:s}=X(),r=(l=e[0])==null?void 0:l.name,a=Ne({defaultValues:{name:r}}),i=Eo(a);return m(J,{children:[t(ee,{children:t(d,{message:"Rename"})}),t(Y,{children:t(Ce,{onSubmit:c=>{i.mutate({entryId:e[0].id,name:c.name,initialName:r},{onSuccess:n})},form:a,id:s,children:t(Fe,{placeholder:"Enter a name...","aria-label":"Entry name",autoFocus:!0,name:"name",required:!0,minLength:3,maxLength:200})})}),m(ye,{children:[t(C,{variant:"flat",onClick:()=>n(),children:t(d,{message:"Cancel"})}),t(C,{form:s,type:"submit",variant:"flat",color:"primary",disabled:i.isLoading||!a.formState.isDirty,children:t(d,{message:"Save"})})]})]})}function No({name:e,parentId:n}){return P.post("folders",{name:e,parentId:n===0?null:n}).then(s=>s.data)}function Co(e){return M(({name:n,parentId:s})=>No({name:n,parentId:s}),{onSuccess:()=>U(),onError:n=>Pe(n,e)})}function ys({parentId:e}){const{close:n,formId:s}=X(),{trans:r}=W(),a=Ne({defaultValues:{name:r({message:"Untitled Folder"})}}),i=Co(a);return m(J,{children:[t(ee,{children:t(d,{message:"New Folder"})}),t(Y,{children:t(Ce,{onSubmit:l=>{i.mutate({...l,parentId:e},{onSuccess:c=>{n(c.folder),F(f("Folder created"))}})},form:a,id:s,children:t(Fe,{placeholder:r({message:"Enter a name..."}),"aria-label":"Entry name",autoFocus:!0,autoSelectText:!0,name:"name",required:!0,minLength:3,maxLength:200})})}),m(ye,{children:[t(C,{variant:"flat",onClick:()=>n(),children:t(d,{message:"Cancel"})}),t(C,{form:s,type:"submit",variant:"flat",color:"primary",disabled:i.isLoading,children:t(d,{message:"Create"})})]})]})}function Fo({selectedEntry:e}){const n=Ft().filter(i=>i.type!=="folder"),s=n.findIndex(i=>i.id===(e==null?void 0:e.id)),[r,a]=h.exports.useState(s);return t(vn,{allowDownload:e.permissions["files.download"],headerActionsLeft:t(Mo,{activeIndex:r,entries:n}),activeIndex:r,onActiveIndexChange:a,entries:n})}function Mo({activeIndex:e,entries:n}){const s=n[e],r=kt([s]),a=Ie();return!s||!r?null:a?t(L,{onClick:()=>{r.execute()},children:h.exports.createElement(r.icon)}):t(C,{variant:"text",startIcon:h.exports.createElement(r.icon),onClick:()=>{r.execute()},children:t(d,{...r.label})})}function Ao({entryId:e,...n}){return P.post(`file-entries/${e}/share`,n).then(s=>s.data)}function Lo(){return M(e=>Ao(e),{onSuccess:()=>{U()},onError:e=>{var n,s;if(nn.isAxiosError(e)&&e.response){const r=e.response.data;(n=r.errors)!=null&&n.emails?F.danger((s=r.errors)==null?void 0:s.emails[0]):z(e)}}})}const Ro={edit:!0,view:!0,download:!0},he=[{key:"view",value:{view:!0},label:f("Can view")},{key:"download",value:{view:!0,download:!0},label:f("Can Download")},{key:"edit",value:Ro,label:f("Can edit")}];function xs({value:e,onChange:n}){return m(oe,{selectedValue:e.key,selectionMode:"single",onSelectionChange:s=>{s!==e.key&&n(he.find(r=>r.key===s))},children:[t(C,{variant:"flat",color:"chip",size:"xs",endIcon:t(ut,{}),children:t(d,{...e.label})}),t(le,{children:he.map(s=>t(T,{value:s.key,children:t(d,{...s.label})},s.key))})]})}function To(e){const{download:n,edit:s}=e.entry_permissions;return s?he.find(r=>r.key==="edit"):n?he.find(r=>r.key==="download"):he.find(r=>r.key==="view")}function _o(){return M(e=>zo(e),{onSuccess:()=>{U(),F(f("Updated user permissions"))},onError:e=>z(e,f("Could not update permissions"))})}function zo({entryId:e,...n}){return P.put(`file-entries/${e}/change-permissions`,n).then(s=>s.data)}function $o({user:e,...n}){var r;const{auth:s}=h.exports.useContext(qs);return t(vt,{...n,label:e==null?void 0:e.display_name,src:e==null?void 0:e.avatar,link:(e==null?void 0:e.id)&&((r=s.getUserProfileLink)==null?void 0:r.call(s,e))})}function Oo({className:e,entry:n}){if(!n)return null;const s=n.users;return m("div",{className:N(e,"overflow-hidden"),children:[t("div",{className:"mb-14 text-sm",children:t(d,{message:"Who has access"})}),t(q,{initial:!1,children:s.map(r=>t(Bo,{user:r,entry:n},r.id))})]})}function Bo({user:e,entry:n}){return m(B.div,{initial:{x:"-100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"tween",duration:.125},className:"flex items-center text-sm gap-14 mb-20",children:[t($o,{user:e,circle:!0,size:"w-44 h-44"}),m("div",{children:[t("div",{children:e.display_name}),t("div",{className:"text-muted",children:e.email})]}),t("div",{className:"ml-auto",children:e.owns_entry?t("span",{className:"text-muted",children:t(d,{message:"Owner"})}):t(Uo,{user:e,entry:n})})]},e.id)}function Uo({user:e,entry:n}){const s=_o(),r=_n(),[a,i]=h.exports.useState(()=>To(e));return m("div",{className:"flex items-center gap-10",children:[t(xs,{onChange:o=>{s.mutate({userId:e.id,permissions:o.value,entryId:n.id}),i(o)},value:a}),t(L,{onClick:()=>{r.mutate({userId:e.id,entryIds:[n.id]},{onSuccess:()=>{F(f("Member removed"))},onError:o=>z(o,f("Could not remove member"))})},children:t(we,{})})]})}function Wo({className:e,entry:n}){var w;const{trans:s}=W(),{share:r}=Ye(),a=Lo(),[i,o]=h.exports.useState([]),[l,c]=h.exports.useState(!1),[u,g]=h.exports.useState(he[0]),p=i.every(I=>!I.invalid),[b,y]=h.exports.useState(""),S=pr(fr,{perPage:7,query:b},{enabled:r.suggest_emails}),x=I=>I.description||I.name;return m("div",{className:e,children:[t(gt,{value:i,onChange:o,isAsync:!0,isLoading:S.fetchStatus==="fetching",inputValue:b,onInputValueChange:y,suggestions:(w=S.data)==null?void 0:w.results,displayWith:x,validateWith:I=>{const O=!Gn(I.description);return{...I,invalid:O,errorMessage:O?s({message:"Not a valid email"}):void 0}},placeholder:s({message:"Enter email addresses"}),label:t(d,{message:"Invite people"}),children:I=>t(T,{value:I.id,startIcon:t(vt,{circle:!0,src:I.image,alt:""}),description:I.description,children:I.name})}),m("div",{className:"flex items-center gap-14 justify-between mt-14",children:[t(xs,{onChange:g,value:u}),i.length?t(C,{variant:"flat",color:"primary",size:"sm",disabled:l||!p,onClick:()=>{c(!0),a.mutate({emails:i.map(I=>x(I)),permissions:u.value,entryId:n.id},{onSuccess:()=>{o([])},onSettled:()=>{c(!1)}})},children:t(d,{message:"Share"})}):null]}),t(Oo,{className:"mt-30",entry:n})]})}function ws(e){return ce(_.fetchEntryShareableLink(e),()=>Vo(e),{enabled:!!e})}function Vo(e){return P.get(`file-entries/${e}/shareable-link`).then(n=>n.data)}function Ko({entryId:e}){return P.delete(`file-entries/${e}/shareable-link`).then(n=>n.data)}function Qo(){return M(({entryId:e})=>Ko({entryId:e}),{onSuccess:(e,{entryId:n})=>{A.setQueryData(_.fetchEntryShareableLink(n),{...e,link:null})},onError:e=>z(e,f("Could not delete link"))})}function jo(e=36){let n="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let r=0;r<e;r+=1)n+=s.charAt(Math.floor(Math.random()*s.length));return n}function qo({setActivePanel:e,entry:n,focusInput:s}){var c,u;const r=ws(n.id),a=!!((c=r.data)!=null&&c.link),i=Ln(),o=Qo(),l=r.isLoading||i.isLoading||o.isLoading;return m("div",{children:[t("div",{className:"mb-10",children:t(d,{message:"Share link"})}),m("div",{className:"flex items-center gap-14 justify-between pb-4 px-2",children:[t(bt,{checked:a,disabled:l,onChange:()=>{a?o.mutate({entryId:n.id}):i.mutate({entryId:n.id})},children:a?t(d,{message:"Shareable link is created"}):t(d,{message:"Create shareable link"})}),a&&t(C,{variant:"link",color:"primary",onClick:()=>{e("linkSettings")},children:t(d,{message:"Link settings"})})]}),t(Ho,{autoFocus:s,link:(u=r.data)==null?void 0:u.link})]})}function Ho({link:e,autoFocus:n}){const{base_url:s}=Ye(),{trans:r}=W(),a=Gr(),i=(e==null?void 0:e.hash)||(a==null?void 0:a.hash)||jo(),o=`${s}/drive/s/${i}`,[l,c]=Hs(o,{successDuration:1e3});return t(He,{autoFocus:n,disabled:!e,className:"mt-10",readOnly:!0,value:o,"aria-label":r({message:"Shareable link"}),onFocus:u=>{u.target.select()},endAppend:t(C,{className:"min-w-100",variant:"flat",color:"primary",onClick:c,children:l?t(d,{message:"Copied!"}):t(d,{message:"Copy"})})})}function Yo({entryId:e,...n}){return P.put(`file-entries/${e}/shareable-link`,n).then(s=>s.data)}function Go(e){return M(n=>Yo(n),{onSuccess:(n,{entryId:s})=>{A.setQueryData(_.fetchEntryShareableLink(s),n)},onError:n=>Pe(n,e)})}function Zo({className:e,setActivePanel:n,entry:s}){const{formId:r}=X(),{data:a}=ws(s.id),i=a==null?void 0:a.link,o=Ne({defaultValues:{allowDownload:i==null?void 0:i.allow_download,allowEdit:i==null?void 0:i.allow_edit,expiresAt:i==null?void 0:i.expires_at,entryId:s.id}}),l=Go(o);return m(h.exports.Fragment,{children:[t(ee,{onDismiss:()=>{n("main")},children:t(d,{message:"Shareable Link Settings"})}),t(Y,{children:t(B.div,{className:"min-h-[335px]",animate:{opacity:1,y:0},initial:{opacity:0,y:20},exit:{opacity:0,y:-20},transition:{duration:.1},children:m(Ce,{id:r,className:e,form:o,onSubmit:c=>{l.mutate(c,{onSuccess:()=>{n("main"),F(f("Link settings saved"))}})},children:[t(Jo,{showField:!!(i!=null&&i.expires_at)}),t(el,{showField:!!(i!=null&&i.password)}),m(qe,{children:[t(d,{message:"Allow download"}),t(Ut,{name:"allowDownload",children:t(d,{message:"Users with link can download this item"})})]}),m(qe,{showBorder:!1,children:[t(d,{message:"Allow import"}),t(Ut,{name:"allowEdit",children:t(d,{message:"Users with link can import this item into their own drive"})})]})]})},"link-settings-content")}),m(ye,{children:[t(C,{type:"button",onClick:()=>{n("main")},children:t(d,{message:"Cancel"})}),t(C,{type:"submit",form:r,variant:"flat",color:"primary",disabled:l.isLoading,children:t(d,{message:"Save"})})]})]})}const Xo=Ys(Gs());function Jo({showField:e}){const{trans:n}=W(),[s,r]=h.exports.useState(e);return m(qe,{children:[t(d,{message:"Link expiration"}),m("div",{children:[t(bt,{checked:s,onChange:a=>{r(a.target.checked)},children:t(d,{message:"Link is valid until"})}),s&&t(hr,{min:Xo,name:"expiresAt",granularity:"minute",className:"mt-20","aria-label":n({message:"Link expiration date and time"})})]})]})}function el({showField:e}){const{trans:n}=W(),[s,r]=h.exports.useState(e);return m(qe,{children:[t(d,{message:"Password protect"}),m("div",{children:[t(bt,{checked:s,onChange:a=>{r(a.target.checked)},children:t(d,{message:"Users will need to enter password in order to view this link"})}),s&&t(Fe,{type:"password",autoFocus:!0,name:"password",className:"mt-20","aria-label":n({message:"Link password"}),description:t(d,{message:"Password will not be requested when viewing the link as file owner."}),placeholder:n({message:"Enter new password..."})})]})]})}function qe({children:e,showBorder:n=!0}){const[s,r]=e;return m("div",{className:N(n&&"border-b mb-20 pb-20"),children:[t("div",{className:"text-sm font-medium mb-8",children:s}),r]})}function Zt({entry:e,focusLinkInput:n}){const{data:{fileEntry:s}}=ce(_.fetchFileEntry(e.id),()=>P.get(`drive/file-entries/${e.id}/model`).then(i=>i.data),{initialData:{fileEntry:e}}),[r,a]=h.exports.useState("main");return t(J,{size:"lg",children:t(q,{initial:!1,mode:"wait",children:r==="linkSettings"?t(Zo,{setActivePanel:a,entry:s},"one"):t(tl,{setActivePanel:a,entry:s,focusLinkInput:n},"two")})})}function tl({setActivePanel:e,entry:n,focusLinkInput:s}){return m(h.exports.Fragment,{children:[t(ee,{children:t(d,{message:"Share \u2018:name\u2019",values:{name:n.name}})}),t(Y,{className:"relative",children:m(B.div,{animate:{opacity:1,y:0},initial:{opacity:0,y:20},exit:{opacity:0,y:-20},transition:{duration:.1},children:[t(Wo,{className:"border-b pb-30 mb-30",entry:n}),t(qo,{setActivePanel:e,entry:n,focusInput:!!s})]},"share-content")})]})}function nl({allFolders:e,onFolderSelected:n}){const{trans:s}=W(),r=s({message:"Search folders"});return t(Zs,{size:"sm",maxItems:10,placeholder:r,"aria-label":r,className:"pt-20",endAdornmentIcon:t(Je,{}),items:e,clearInputOnItemSelection:!0,onItemSelected:a=>{const i=parseInt(a),o=e.find(l=>l.id===i);o&&n(o)},children:a=>t(T,{value:a.id,children:a.name},a.id)})}function sl({selectedFolder:e,allFolders:n,rootFolder:s,onFolderSelected:r}){const a=e.path.split("/").map(l=>{const c=parseInt(l);return n.find(u=>c===u.id)}).filter(l=>!!l),i=[s,...a],o=a[a.length-2];return m("div",{className:"flex items-center border-b pb-10 gap-6",children:[t(L,{className:"flex-shrink-0",variant:"outline",size:"xs",radius:"rounded",disabled:!o&&!e.id,onClick:()=>{r(o||s)},children:t(gr,{})}),t(wt,{size:"sm",className:"flex-auto",children:i.map(l=>m(je,{onSelected:()=>{r(l)},className:"flex items-center gap-8",children:[!l.id&&t(xt,{className:"icon-sm"}),l.name]},l.id||"root"))})]})}const rl=""+new URL("my-files.88476671.svg",import.meta.url).href;function al(e){const{onFolderSelected:n,selectedFolder:s,allFolders:r}=e,a=h.exports.useMemo(()=>{const i=s.id||null;return r.filter(o=>o.parent_id===i)},[s.id,r]);return a.length?t(Xs,{className:"h-288 overflow-y-auto",children:a.map(i=>t(Js,{className:"border-b min-h-48",onSelected:()=>{n(i)},startIcon:t(Ee,{type:"folder"}),endIcon:t($r,{size:"md"}),children:i.name},i.id))}):t(Ge,{size:"xs",className:"pt-64 pb-20 min-h-288",image:t(De,{src:rl}),title:t(d,{message:'There are no subfolders in ":folder"',values:{folder:s.name}})})}function il({entries:e}){const{data:n}=Dt(),s=(n==null?void 0:n.folders)||[],r=k(o=>o.activePage),[a,i]=h.exports.useState((r==null?void 0:r.folder)||$.folder);return m(J,{size:"lg",children:[t(ee,{children:t(d,{message:"Move [one \u2018:name\u2018|other :count items]",values:{count:e.length,name:e[0].name}})}),m(Y,{children:[t("div",{className:"text-sm",children:t(d,{message:"Select a destination folder."})}),t(nl,{allFolders:s,onFolderSelected:i}),m("div",{className:"mt-40 mb-20",children:[t(sl,{selectedFolder:a,allFolders:s,rootFolder:$.folder,onFolderSelected:i}),t(al,{selectedFolder:a,allFolders:s,onFolderSelected:i})]})]}),t(ol,{selectedFolder:a,setSelectedFolder:i,entries:e})]})}function ol({selectedFolder:e,setSelectedFolder:n,entries:s}){const{close:r}=X(),a=Ie(),i=ns();return m(ye,{className:"border-t",startAction:m(de,{type:"modal",onClose:o=>{o&&n(o)},children:[t(C,{startIcon:t(yt,{}),variant:"text",children:t(d,{message:"New Folder"})}),t(ys,{parentId:e.id})]}),children:[!a&&t(C,{variant:"flat",onClick:()=>r(),children:t(d,{message:"Cancel"})}),t(C,{type:"submit",variant:"flat",color:"primary",disabled:!Pt(s,e)||i.isLoading,onClick:()=>{i.mutate({destinationId:e.id,entryIds:s.map(o=>o.id)},{onSuccess:r})},children:t(d,{message:"Move here"})})]})}function ll({entries:e}){const n=Ae(),s=e.length===1?t(d,{message:"\u2018:name\u2018 will be deleted forever and you won't be able to restore it.",values:{name:e[0].name}}):t(d,{message:":count items will be deleted forever and you won't be able to restore them.",values:{count:e.length}});return t(xe,{isDanger:!0,title:t(d,{message:"Delete forever?"}),body:s,confirm:t(d,{message:"Delete forever"}),onConfirm:()=>{n.mutate({entryIds:e.map(r=>r.id),deleteForever:!0}),v().selectEntries([])}})}function cl({entries:e}){const n=zn();return t(xe,{title:t(d,{message:"This folder is in your trash"}),body:t(d,{message:"To view this folder, restore it from the trash."}),confirm:t(d,{message:"Restore"}),onConfirm:()=>{n.mutate({entryIds:e.map(s=>s.id)}),v().selectEntries([])}})}function dl(){const e=k(s=>s.activeActionDialog),n=ul(e);return t(de,{type:"modal",isOpen:!!n,onClose:()=>{v().setActiveActionDialog(null)},children:n})}function ul(e){var n;switch(e==null?void 0:e.name){case"rename":return t(Po,{entries:e.entries});case"newFolder":return t(ys,{parentId:(n=e.entries[0])==null?void 0:n.id});case"preview":return t(Fo,{selectedEntry:e.entries[0]});case"share":return t(Zt,{entry:e.entries[0]});case"getLink":return t(Zt,{entry:e.entries[0],focusLinkInput:!0});case"moveTo":return t(il,{entries:e.entries});case"confirmAndDeleteForever":return t(ll,{entries:e.entries});case"trashFolderBlock":return t(cl,{entries:e.entries});default:return null}}function ml(){const{trans:e}=W(),n=te(),s=k(o=>o.activePage),[r]=Xe(),[a,i]=h.exports.useState(r.get("query")||"");return t("form",{className:"flex-auto max-w-620",onSubmit:o=>{o.preventDefault(),n({pathname:H.path,search:`?query=${a}`},{replace:!0})},children:t(He,{size:"sm",background:"bg-paper",value:a,onChange:o=>i(o.target.value),onFocus:()=>{s!==H&&n(H.path)},startAdornment:t(L,{type:"submit",radius:"rounded",children:t(Je,{})}),className:"flex-auto max-w-620",placeholder:e({message:"Search"}),"aria-label":e({message:"Search files and folders"})})})}function pl(e){const n=h.exports.useRef(e),s=h.exports.useId();h.exports.useEffect(()=>(Wt.set(s,n.current),()=>{Wt.delete(s)}),[s])}function fl(){const e=h.exports.useRef(null),[n,s]=h.exports.useState(),[r,a]=h.exports.useState({});pl({type:"fileEntry",onDragStart:(o,l)=>{const c=l;c&&(a({entries:c.getData(),e:o,draggingTreeItem:Di(c.id)}),s({start:o}))},onDragMove:o=>{a(l=>({...l,e:o})),s(l=>({...l,end:o}))},onDragEnd:(o,l,c)=>{a({status:c})}});let i=null;return r.entries&&r.e&&(i=t("div",{ref:e,style:r.e?{transform:`translate(${r.e.x}px, ${r.e.y}px)`,width:`${r.e.rect.width}px`}:void 0,className:"fixed isolate left-0 top-0 pointer-events-none",children:r.entries.map((o,l)=>t(hl,{index:l,entry:o,points:n,state:r},o.id))})),t(q,{custom:r.status,children:i})}const hl=h.exports.memo(({entry:e,points:n,index:s,state:r})=>{var g,p,b,y;const a=k(S=>S.viewMode),i=r.draggingTreeItem?Nt(e):e.id,o=In.get(i);if(!(o!=null&&o.rect)||!(n!=null&&n.start))return null;const l=o.rect,c=((g=r.entries)==null?void 0:g.length)||0,u=S=>{var x,w,I;return S==="dropSuccess"?{x:0,y:0,opacity:0,transition:{duration:.1,delay:0}}:{x:l.left-(((x=n.end)==null?void 0:x.x)||0),y:l.top-(((w=n.end)==null?void 0:w.y)||0),width:`${(I=r.e)==null?void 0:I.rect.width}px`}};return m(B.div,{transition:{delay:.01*s,bounce:0,duration:.2},initial:{x:l.left-n.start.x,y:l.top-n.start.y,width:`${(p=r.e)==null?void 0:p.rect.width}px`},animate:{x:0,y:0,width:a==="list"?288:void 0},exit:u,style:{width:a==="grid"?`${(b=r.e)==null?void 0:b.rect.width}px`:void 0,height:`${(y=r.e)==null?void 0:y.rect.height}px`},className:N("absolute bg-paper whitespace-nowrap rounded border border-primary-light max-h-48",s<2&&"shadow",s===0&&"z-10 top-0 left-0",s>0&&"top-6 left-6"),children:[c>1&&s===0&&t(gl,{count:c}),m("div",{className:"text-sm h-full flex justify-center items-center px-16 gap-10 bg-primary-light/20 overflow-hidden",children:[t(Ee,{type:e.type}),t("div",{className:"flex-auto text-ellipsis overflow-hidden",children:e.name})]})]},e.id)}),gl=h.exports.memo(({count:e})=>t(B.div,{initial:{opacity:0},animate:{opacity:1,transition:{delay:.1}},exit:{opacity:0},transition:{duration:.1},className:"absolute -top-6 shadow-lg -right-6 z-30 rounded-full bg-danger text-white w-20 h-20 flex items-center justify-center text-sm font-bold z-10",children:e},"entryCount"));function vl(){const{isMobileMode:e}=h.exports.useContext(ne),n=k(s=>s.activePage);return m(qn,{className:"px-8 md:px-26 py-4 flex items-center gap-20 border-b h-60",children:[e?t(gs,{isDisabled:n==null?void 0:n.disableSort}):t(vs,{}),m("div",{className:"text-muted ml-auto flex-shrink-0",children:[t(bl,{}),t(yl,{})]})]})}function bl(){const e=k(s=>s.viewMode);return t(ie,{label:e==="grid"?t(d,{message:"List view"}):t(d,{message:"Grid view"}),children:t(L,{size:"md",onClick:()=>{v().setViewMode(v().viewMode==="list"?"grid":"list")},children:e==="list"?t(Rr,{}):t(Tr,{})})})}function yl(){const{rightSidenavStatus:e,setRightSidenavStatus:n}=h.exports.useContext(ne);return t(ie,{label:e?t(d,{message:"Hide details"}):t(d,{message:"Show details"}),children:t(L,{size:"md",color:e==="open"?"primary":null,onClick:()=>{n(e==="open"?"closed":"open")},children:t(_r,{})})})}function ae(){const{pathname:e}=on(),{hash:n}=it(),{workspaceId:s}=j(),r=k(i=>i.activePage);h.exports.useEffect(()=>{v().setActivePage(ua.find(i=>i.path===e)||Tn(n))},[e,n]);const a=h.exports.useMemo(()=>({workspaceId:s}),[s]);return h.exports.useEffect(()=>()=>{v().reset()},[]),m(h.exports.Fragment,{children:[(r==null?void 0:r.label)&&t(er,{children:r.label}),m(ln,{children:[t(wn.Provider,{value:a,children:m(bn,{name:"drive",onDragOver:i=>{i.preventDefault(),i.stopPropagation(),i.dataTransfer.dropEffect="none"},onDrop:i=>{i.preventDefault()},children:[t(xl,{}),t(Vt,{position:"left",size:"md",children:t(Ti,{})}),t(vl,{}),t(xn,{children:t(ao,{})}),t(uo,{}),t(dl,{}),t(Vt,{position:"right",size:"lg",children:t(ko,{})})]})}),t(fl,{})]})]})}function xl(){const{isMobileMode:e}=h.exports.useContext(ne),n=k(i=>i.activePage),s=e?null:t(ml,{}),r=t(L,{elementType:pn,to:H.path,children:t(Je,{})}),a=m(h.exports.Fragment,{children:[n!==H&&r,t(ls,{isCompact:!0})]});return m(h.exports.Fragment,{children:[t(yn,{rightChildren:e&&a,menuPosition:"drive-navbar",children:s}),e&&t(wl,{})]})}function wl(){const e=k(n=>n.selectedEntries.size);return e?m("div",{className:"fixed bg-primary w-full h-54 text-on-primary shadow-xl z-10 rounded top-0 right-0 flex items-center justify-center gap-10 px-6",children:[t(L,{onClick:()=>{v().selectEntries([])},children:t(we,{})}),t(d,{message:":count selected",values:{count:e}}),t(ms,{className:"ml-auto"})]}):null}const Sl=[{path:"/",element:t(re,{children:t(ae,{})})},{path:"/folders/:hash",element:t(re,{children:t(ae,{})})},{path:"/shares",element:t(re,{children:t(ae,{})})},{path:"/recent",element:t(re,{children:t(ae,{})})},{path:"/starred",element:t(re,{children:t(ae,{})})},{path:"/trash",element:t(re,{children:t(ae,{})})},{path:"/search",element:t(re,{children:t(ae,{})})},{path:"s/:hash",element:t(Wa,{})},{path:"*",element:t(cn,{})}];function Pl(){return tr(Sl)}export{Pl as default};
//# sourceMappingURL=drive-routes.3b0a5926.js.map
